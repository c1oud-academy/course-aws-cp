WEBVTT

00:00:00.000 --> 00:00:03.000
Добрый день, уважаемые студенты!

00:00:03.000 --> 00:00:06.000
Я рад вас всех видеть на очередной лекции.

00:00:06.000 --> 00:00:11.000
Тема сегодняшней лекции это компьютер, то есть вычисления в облаке.

00:00:11.000 --> 00:00:16.000
Эта тема достаточно важная и хотелось бы ее максимально подробно с вами разобрать.

00:00:16.000 --> 00:00:22.000
Поэтому мы эту тему поделили на две недели и сегодня у нас первая часть.

00:00:22.000 --> 00:00:24.000
Итак, давайте начнем.

00:00:24.000 --> 00:00:29.000
Сегодняшняя сессия поделена на три части.

00:00:29.000 --> 00:00:38.000
В первой части мы с вами поговорим про существующие сервисы AWS, которые предоставляют нам вычислительные ресурсы.

00:00:38.000 --> 00:00:40.000
Далее вторая и третья часть.

00:00:40.000 --> 00:00:45.000
Она посвящена сервису EC2, то есть Elastic Compute Cloud.

00:00:45.000 --> 00:00:54.000
Сервис EC2 является одним из самых основных и важных для понимания с точки зрения подготовки к экзамену AWS,

00:00:54.000 --> 00:01:07.000
а также к вашей будущей работе, так как очень большая вероятность того, что вы будете использовать этот сервис при построении своей IT-инфраструктуры в облаке.

00:01:09.000 --> 00:01:14.000
Первая секция. Обзор существующих сервисов вычислений.

00:01:14.000 --> 00:01:22.000
На этом слайде вы видите основной список сервисов, предоставляющих нам вычислительные ресурсы,

00:01:22.000 --> 00:01:30.000
и выделены те сервисы, которые мы более-менее, что-то более подробно, что-то менее подробно, насмотрим на нашем курсе.

00:01:30.000 --> 00:01:33.000
Самый первый и основной – это EC2.

00:01:33.000 --> 00:01:37.000
Это тот сервис, который предоставляет нам виртуальные машины.

00:01:37.000 --> 00:01:40.000
Далее есть так называемый EC2 Auto Scaling.

00:01:40.000 --> 00:01:47.000
Это тот сервис, который помогает настроить авто скейлинг для наших EC2-инстансов.

00:01:47.000 --> 00:01:55.000
Следующие три – это Amazon Elastic Container Registry, далее Elastic Container Service,

00:01:55.000 --> 00:02:04.000
и третий – это Elastic Kubernetes Service, то есть аббревиатуры ECR, ECS и EKS.

00:02:04.000 --> 00:02:07.000
Чем они между собой отличаются?

00:02:07.000 --> 00:02:14.000
Первый – ECR – это хранилище Docker images, образов.

00:02:14.000 --> 00:02:20.000
Далее ECS – это сервис, который нам помогает работать с Docker-образами.

00:02:20.000 --> 00:02:27.000
Следующий – это EKS, который позволяет нам работать с Kubernetes.

00:02:27.000 --> 00:02:39.000
Kubernetes – это абстрактное приложение поверх для более удобной продвинутой оркестрации Docker images.

00:02:39.000 --> 00:02:47.000
То есть если вы используете Docker и в какой-то момент количество этих образов, с которыми вам приходится работать,

00:02:47.000 --> 00:02:57.000
оно растет или достаточно большое, то обычно переходят на использование Kubernetes, то есть K8S.

00:02:57.000 --> 00:03:08.000
И также связанный сервис – это AWS Fargate, тоже сервис, который работает с контейнерами и который является менеджед сервисом.

00:03:08.000 --> 00:03:18.000
Идея в том, что большую часть административной работы AWS берет на себя, при этом основные моменты,

00:03:18.000 --> 00:03:28.000
определенные входные данные для работы с контейнерами предоставляем мы как владельца эти инфраструктуры в облаке.

00:03:28.000 --> 00:03:34.000
Следующие сервисы – это Elastic, Beanstalk и Amazon LightSail.

00:03:34.000 --> 00:03:44.000
Они в каком-то смысле также похожи, я специально рассказываю сервисы в сгруппированном виде для того, чтобы у вас структурированное это запомнилось.

00:03:44.000 --> 00:03:53.000
Elastic, Beanstalk – идея в том, что вы загружаете в этот сервис ваш код, код веб-приложения,

00:03:53.000 --> 00:03:58.000
и этот сервис за вас поднимает инфраструктуру в облаке AWS,

00:03:58.000 --> 00:04:04.000
таким образом забирает на себя большую часть административной работы.

00:04:04.000 --> 00:04:14.000
То же самое относится к LightSail, в этом случае мы говорим, что это сервис, который помогает нам строить приложения либо веб-сайты.

00:04:18.000 --> 00:04:24.000
Следующий сервис – это AWS Lambda, про него мы уже несколько раз проговаривали.

00:04:24.000 --> 00:04:29.000
Теперь на этих лекциях разберем более подробно.

00:04:29.000 --> 00:04:44.000
Это Serverless Compute Service, идея в том, что вы пишете код, все остальное с точки зрения администрирования и обслуживания этого кода, оно происходит на стороне AWS.

00:04:44.000 --> 00:04:54.000
Идеальный сервис для разработчиков, так как максимально уменьшает все то, что связано с администрированием инфраструктуры.

00:04:54.000 --> 00:05:11.000
Также хотелось бы отметить AWS Batch, это тот сервис, который помогает нам проводить batch jobs, то есть некие работы в больших объемах или группами.

00:05:11.000 --> 00:05:29.000
И еще один сервис, который также хотелось бы отметить, это AWS Outposts, это тот сервис, который позволяет нам управлять локальной инфраструктурой через интерфейс AWS.

00:05:29.000 --> 00:05:44.000
Таким образом мы взаимодействуем как будто с AWS, но под капотом используются вычислительные ресурсы, которые у нас в тета-центре.

00:05:47.000 --> 00:05:52.000
Мы можем поделить определенную часть сервисов вычисления на четыре группы.

00:05:52.000 --> 00:06:00.000
Первая группа это сервисы по модели IaaS, infrastructure as a service, в нашем случае это Amazon EC2.

00:06:03.000 --> 00:06:10.000
Атомарной единицей в рамках этого сервиса, то есть ресурсом, с которым мы работаем, является виртуальная машина.

00:06:10.000 --> 00:06:19.000
Так как этот сервис предоставляется по модели infrastructure as a service, у нас абсолютно полный контроль над этими виртуальными машинами.

00:06:19.000 --> 00:06:23.000
Мы можем устанавливать любую операционную систему, любые приложения.

00:06:23.000 --> 00:06:26.000
Единственный момент, нужны специалисты, которые все это проделывают.

00:06:26.000 --> 00:06:34.000
Если есть специалисты и есть определенные уникальные требования к IT инфраструктуре, то EC2 это наш выбор.

00:06:34.000 --> 00:06:39.000
Следующий вариант это серверлесс ресурсы.

00:06:39.000 --> 00:06:43.000
Яркий представитель это AWS Lambda.

00:06:43.000 --> 00:06:54.000
Когда мы пишем код, этот код загружаем в облако и все то, что связано с администрированием, обслуживанием этого кода, оно происходит на стороне AWS.

00:06:54.000 --> 00:07:03.000
Это идеальный выбор в случае, когда есть недостаток специалистов, которые будут обслуживать вашу инфраструктуру.

00:07:06.000 --> 00:07:11.000
Третья группа это сервисы, которые связаны с контейнерами.

00:07:11.000 --> 00:07:15.000
Мы чуть подробнее далее поговорим, что такое контейнеры.

00:07:15.000 --> 00:07:19.000
Здесь есть четыре сервиса, которые работают с контейнерами.

00:07:19.000 --> 00:07:23.000
Это ACS, AQS, ECR и Fargate.

00:07:24.000 --> 00:07:30.000
Четвертая группа это сервис, который предоставляется по модели Platform as a Service.

00:07:30.000 --> 00:07:38.000
И минимальной единице, атомарной единице, ресурсом в этом случае является один веб-аппликашн.

00:07:38.000 --> 00:07:41.000
Сервис это Elastic Beanstalk.

00:07:41.000 --> 00:07:45.000
Идея в том, что мы пишем код, этот код загружаем в облако.

00:07:45.000 --> 00:07:50.000
Дальше Elastic Beanstalk самостоятельно разворачивает необходимую инфраструктуру.

00:07:50.000 --> 00:08:02.000
Естественно, мы передаем дополнительные параметры, которые прописывают некоторые ограничения условия либо мощность этой инфраструктуры.

00:08:02.000 --> 00:08:11.000
Но всю ту работу по поднятию и поддержке осуществляет этот сервис Elastic Beanstalk, так как оно предоставляется по модели Platform as a Service.

00:08:13.000 --> 00:08:29.000
Вы видите, что даже когда мы говорим про вычислительные ресурсы, то AWS предоставляет несколько вариантов сервисов, которые в зависимости от вашей бизнес задачи могут вам идеально подойти.

00:08:29.000 --> 00:08:40.000
Здесь единственный момент, который я бы хотел отметить, это то, что компания всегда находится в различных стадиях развития.

00:08:40.000 --> 00:08:46.000
Таким образом, в начале представим, что вы какой-то маленький стартап, у вас небольшие нагрузки.

00:08:46.000 --> 00:08:53.000
В этом случае, возможно, вам идеально подойдут сервисы, которые сервер-лес, например, Lambda.

00:08:53.000 --> 00:09:11.000
Когда у вас нет штата, у вас нет штатного системного администратора, который этим всем занимается, более того, у вас нет больших нагрузок или постоянных нагрузок на ваш продукт, IT-продукт, в этом случае достаточно использовать Lambda.

00:09:11.000 --> 00:09:29.000
Когда у вас растут нагрузки, у вас растет штат, далее у вас появляются некоторые уникальные требования к IT-инфраструктуре, то вам нужно больше контроля над вашими же IT-ресурсами в облаке.

00:09:29.000 --> 00:09:44.000
В этом случае вы постепенно будете перебираться от моделей, когда вам предоставляется сервис, когда вы лишь малую часть выполняете, а большую часть делает AWS,

00:09:44.000 --> 00:10:00.000
к сервисам, которые дают вам полный контроль над IT-ресурсами, самый максимальный случай, который возможен, это IaaS и, в нашем случае, EC2.

00:10:00.000 --> 00:10:14.000
Мы с вами добрались до второй части нашей сессии, с этого момента мы начнем подробное знакомство с сервисом Amazon EC2. Amazon EC2 расшифруется как Amazon Elastic Compute Cloud.

00:10:14.000 --> 00:10:33.000
Этот сервис, который предоставляет нам виртуальные машины. Эта виртуальная машина ничем не отличается от выделенного сервера, который мы заказываем от локального hosting провайдера, либо который мы настраиваем и заказываем на локальном дата-центре.

00:10:33.000 --> 00:10:50.000
Отличие лишь в том, что предоставляются все преимущества облачных технологий по сравнению с локальным развёртыванием. А именно это то, что вы можете за минуты запросить необходимое количество вычислительных мощностей,

00:10:50.000 --> 00:11:06.000
в любой момент, когда вам эти вычислительные мощности не нужны, вы можете их отозвать и вернуть обратно и оплата будет производиться только за то время и за то количество инстанцев, типов инстанцев, которые вы использовали.

00:11:06.000 --> 00:11:23.000
Уже вы сразу можете видеть, что по сравнению с локальной инфраструктурой и облачной инфраструктурой, абсолютно такой же с использованием EC2 сервиса, мы уже получаем некоторые выгоды.

00:11:23.000 --> 00:11:41.000
Для нас она выходит выгодной, потому как большинство IT-проектов, нагрузка на IT-инфраструктуру, она идет динамическая. Например, если это какой-то веб-сайт по продаже одежды, то обычно люди занимаются покупками либо в выходные,

00:11:41.000 --> 00:12:01.000
либо в так называемые prime hours, то есть часы, когда идет пиковая нагрузка. Это время либо утром в 9 до 9, либо это обеденное время, или это время после 6-7 часов вечера до 10 часов вечера,

00:12:01.000 --> 00:12:16.000
когда люди свободны от работы и у них появляется время делать какие-то покупки. В этом случае, когда у вас есть серверы на локальном дата-центре, то для того, чтобы обслужить все нагрузки, которые приходят,

00:12:16.000 --> 00:12:31.000
максимальное время, чтобы не потерять ни одного клиента, у вас должен быть какой-то запас серверов, которые постоянно там находятся. Потому как быстро в течение минуты получить новый сервер – это нереальная задача,

00:12:31.000 --> 00:12:42.000
когда вы хоститесь локально. Обычно заказ сервера занимает несколько дней, а более реалистичный вариант – это несколько недель. Таким образом, у вас должен быть какой-то запас.

00:12:42.000 --> 00:12:58.000
Другой момент – это то, что те серверы, которые вы уже заказали, вы никуда на временное использование или вернуть обратно быстро не можете. Поэтому, раз вы купили, вы уже понесли основные ваши расходы в большом объеме.

00:12:58.000 --> 00:13:13.000
И в случае, когда у вас нет нагрузки, например, в 4 часа утра, никто не использует ваш веб-сайт, в этом случае все ваши висчлительные мощности простаивают. Фактически, вы теряете ваши деньги.

00:13:13.000 --> 00:13:29.000
Когда мы работаем с сервисами облачными, в этом случае мы можем настроить скейлинг, автоскейлинг, когда, в зависимости от нагрузки на нашу инфраструктуру, мы получаем необходимое количество EC2-инстанцев.

00:13:29.000 --> 00:13:49.000
И это уже позволяет нам экономить, потому как в те часы, когда нагрузки небольшие, мы отдаем большую часть серверов обратно Амазону и за эти часы не оплачиваем. И сохраняем только минимальное количество инстанцев для того, чтобы обслуживать клиентов в эти непопулярные часы.

00:13:49.000 --> 00:14:12.000
Потом, в тот момент, когда у нас происходят часы пика, то есть когда люди в большом количестве посещают ваш сайт, в этом случае, количество инстанцев необходимо запрашивается у облачного провайдера и в течение нескольких минут она доступна и на него можно направлять трафик.

00:14:12.000 --> 00:14:37.000
Все происходит автоматически, так как это некий живой организм в облаке. И это позволяет, даже если нагрузки у вас в 10 раз увеличатся внезапно, то все те новые пользователи, которые к вам пришли поверх, они будут обслужены успешно, потому как вы всего-навсего запросите в 10 раз больше инстанцев.

00:14:37.000 --> 00:14:55.000
Естественно, вы что-то заработаете, это будет для вас очень выгодно и в тот момент, когда пиковые часы пройдут, вы вернете обратно эти инстанцы и у вас не будет случаев, когда ваша инфраструктура простаивает.

00:14:55.000 --> 00:15:24.000
Примерами использования EC2-инстанца могут быть все те примеры, которые могут быть развернуты в локальном сервере, а именно это может быть сервер, обслуживающий приложение, веб-сайт, базы данных, может быть сервер какой-то игры, который обслуживает игру по сети, далее это может быть почтовый сервер, медиа-сервер, когда вы раздаете картинки, может быть аудио либо видео.

00:15:24.000 --> 00:15:29.000
Материалы стримите, например, какое-то видео.

00:15:29.000 --> 00:15:56.000
И другой вариант – это файл-сервер, да, вы загружаете туда файлы и даете возможность эти файлы скачивать и работать с этими файлами, как, например, Troublesbox, это может быть какой-то proxy-сервер и все те примеры, которые применимы на локальный сервер, то есть сервер, который хостится в локальном дата-центре, они также применимы для EC2-инстанцев в облаке.

00:15:56.000 --> 00:16:07.000
� езюмируя, мы говорим, что Amazon EC2 – это сервис, который предоставляет нам виртуальные машины, эти виртуальные машины называются EC2-инстанциями.

00:16:07.000 --> 00:16:11.000
EC2 расшифруется как Elastic Compute Cloud.

00:16:11.000 --> 00:16:35.000
Также хотелось бы отметить, что EC2 поддерживает все популярные операционные системы Windows, Linux, а именно Windows версии 8, 12, 16, 19, Red Hat, SuS, Ubuntu и есть такая операционная система Amazon Linux, которая была создана, поддерживается и постоянно улучшается.

00:16:35.000 --> 00:16:56.000
Самим Amazon называется Amazon Linux. На сегодняшний день существует две версии, то есть Amazon Linux первая версия и Amazon Linux вторая. � екомендуется переходить на следующую версию, так как за ту же цену вы получаете еще большие возможности и преимущества по сравнению с предыдущей версией.

00:16:56.000 --> 00:17:11.000
В целом также рекомендуется использовать операционную систему от Amazon, потому как она максимально интегрирована с AWS, а также все те новинки, которые выходят, они могут выходить только для этой операционной системы.

00:17:11.000 --> 00:17:22.000
Либо если появляется некое обновление для всех операционных систем, то в первую очередь она появляется внутри Amazon Linux.

00:17:22.000 --> 00:17:44.000
Давайте пройдемся по процессу создания EC2 Instance. Оно состоит из 9 различных шагов. Самый первый это выбор AMI. AMI это Amazon Machine Instance либо простыми словами это слепок либо шаблон EC2 Instance.

00:17:44.000 --> 00:17:55.000
В этот шаблон входит операционная система, все возможные настройки, установленные приложения и все то, что вы можете проделать в рамках этого EC2 Instance.

00:17:55.000 --> 00:18:10.000
Вы как будто бы замораживаете в каком-то состоянии, в определенном состоянии этот EC2 Instance со всеми необходимыми, правильно проделанными настройками и это состояние можете наложить на новый EC2 Instance.

00:18:10.000 --> 00:18:34.000
Таким образом вы экономите свое же время, исключаете человеческий фактор и все те новые Instance, которые создаются, они создаются намного быстрее, нежели вам пришлось бы все эти настройки проделывать с нуля для каждого EC2 Instance.

00:18:34.000 --> 00:18:57.000
Существует три источника AMI. Первый это делать самостоятельно, второй это AWS Marketplace. Это то место, где компания подготавливает от своего имени AMI со специфическими настройками, вы можете эти AMI там покупать.

00:18:57.000 --> 00:19:13.000
И третий вариант это Community AMI, это то место, где специалисты со всего мира подготавливают самостоятельные AMI и бесплатно публикуют в общем доступе.

00:19:13.000 --> 00:19:29.000
Так как AWS не проверяет содержимое этих AMI, то использование AMI с Community AMI, она полностью под вашу личную ответственность, то есть на ваш страх и риск.

00:19:29.000 --> 00:19:49.000
Я со своей стороны не рекомендую использовать AMI с Community AMI, в некоторых случаях это является оправданным, если покупать AMI внутри AWS Marketplace, но самым лучшим вариантом является подготовка AMI самостоятельно.

00:19:49.000 --> 00:20:08.000
Здесь вы можете видеть на диаграмме процесс создания нового AMI, то есть вы можете импортировать состояние уже существующей виртуальной машины, либо можете начать с самого начала.

00:20:08.000 --> 00:20:29.000
Следующим шагом это вы получаете немодифицированный инстанс, далее вы производите все необходимые настройки, апгрейды, обновления приложения, патчи безопасности и так далее, и получаете уже модифицированный инстанс, который в таком же состоянии сохраняете как новый AMI.

00:20:29.000 --> 00:20:52.000
Следует помнить, что AMI, оно создается в рамках определенного региона, если ваша инфраструктура развернута в нескольких регионах, то вам необходимо будет скопировать AMI с одного региана на второй, для того чтобы он был доступен уже в другом регионе.

00:20:52.000 --> 00:21:09.000
Его ID будет отличаться, но содержимое будет такое же. Следующий пункт это выбор типа инстанса. Когда мы говорим про тип инстанса, имеется в виду мощность этого виртуального сервера.

00:21:09.000 --> 00:21:29.000
Мощность определяется количеством оперативной памяти, количеством ядер процессора, информация о возможности подключения жестких дисков и объем этих жестких дисков, а также информация по каналу передачи данных по сети.

00:21:29.000 --> 00:21:44.000
На этом слайде представлена информация по характеристикам серверов в зависимости от изменения его размера. Самый маленький размер внутри AWS это nano, дальше micro, small и так далее.

00:21:44.000 --> 00:21:59.000
Также в названии инстанца вы видите как префикс идет, буквы в нашем случае T и цифра 3. Буква это семейство инстанцев, а цифра это поколение.

00:21:59.000 --> 00:22:14.000
Про семейство мы подробнее поговорим на следующем слайде. Когда мы говорим про поколение, это цифра, которая с каждым годом увеличивается на текущий момент. Последними поколениями являются 5 и 6.

00:22:14.000 --> 00:22:32.000
Когда мы говорим про размеры в таблице, вы видите, что с увеличением размера инстанца логично увеличивается количество ядер процессора, а также количество оперативной памяти.

00:22:32.000 --> 00:22:51.000
Здесь вы видите информацию по существующим семействам типов инстанцев. Не нужно запоминать каждую букву, достаточно запомнить самые основные, которые потенциально могут прийти на реальном экзамене AWS.

00:22:51.000 --> 00:23:18.000
Когда мы говорим про семейство общего назначения, это семейство A, M и T. Необходимо запомнить T. Дальше идет compute optimized, то есть для того же размера, например, large, у compute optimized инстанца будет большее количество ядер процессоров.

00:23:18.000 --> 00:23:34.000
По сравнению с large инстанцем семейства general purpose, то есть какой-нибудь T3 large и C3 large. Здесь необходимо запомнить, что это семейство C.

00:23:34.000 --> 00:23:53.000
Дальше идет у нас memory optimized, это R и X. Также есть Z, но чаще всего и самым популярным является семейство R. Здесь также по сравнению с general purpose тот же, например, T3 large и тот же R3 large.

00:23:53.000 --> 00:24:06.000
В этом случае у R3 large будет как минимум в два раза больше оперативной памяти по сравнению с тем же T3 large. При этом количество ядер процессора будет таким же.

00:24:06.000 --> 00:24:24.000
Следующие они достаточно редко используемы в зависимости от вашей бизнес задачи. Есть accelerated computing, когда вы тренируете некоторые модели машинного обучения, искусственный интеллект в этом направлении.

00:24:24.000 --> 00:24:43.000
Есть также типы инстанцев, которые позволяют вам развернуть distributed file systems, то есть распределенные файловые системы, Hadoop и так далее. В этом случае есть семейство DHAI.

00:24:43.000 --> 00:25:12.000
Я вам рекомендую остановить это видео, перейти на страницу pricing сервиса Amazon EC2. Там вы увидите, какие на текущий момент есть семейства типа финстенцев, какие есть размерности, сколько они стоят, а также какое количество оперативной памяти, ядер процессора предоставляется, какие есть возможности в плане storage и networking.

00:25:12.000 --> 00:25:28.000
Вы можете сравнить несколько разных семейств, чтобы получить полное представление. Когда мы говорим про networking, когда учитывать возможности networking.

00:25:28.000 --> 00:25:48.000
В случае, если у вас передается небольшое количество данных внутри вашей инфраструктуры, будь то между EC2 инстанцами, либо между вашими EC2 инстанцами и базой данных, в этом случае не так критично информация по сети.

00:25:48.000 --> 00:26:00.000
Она будет вам предоставлена. В случае, когда вы работаете с большим объемом информации, данные передаются по сети, в этом случае этот момент может быть для вас критичным.

00:26:00.000 --> 00:26:29.000
Поэтому обратите на это внимание и следует также учитывать, что есть специальные выделенные семейства типа финстенцев, которые оптимизированы для работы по сети. То есть у них может быть не такое большое количество оперативной памяти, либо ядер процессора, но канал для передачи данных по сети, он предоставляется больше по сравнению с другими семействами.

00:26:29.000 --> 00:26:47.000
Следующий пункт, третий, это Network Settings, в котором мы указываем всю информацию, где будет расположен наш EC2 инстанц. А именно мы указываем информацию, в каком VPC, в какой availability зоне и в каком сабнете будет находиться новый EC2 инстанц.

00:26:47.000 --> 00:27:09.000
Я здесь не говорю касательно региона, почему? Потому что до того, как вы нажмете в самом начале кнопку Create Instance или Launch Instance, регион уже должен быть выбран нужный, потому как внутри Launch Wizard вы не сможете поменять регион. Это тот момент, который следует учитывать.

00:27:09.000 --> 00:27:21.000
В случае, когда вы делаете эту программу, то скорее всего команда не сработает, если вы не укажете какой-нибудь из регионов.

00:27:21.000 --> 00:27:41.000
Еще один момент, который следует учитывать, это то, что все инстанции, которые создаются в дефолтовом VPC, они получают Public IP-адрес. Мы с вами помним, что это динамический IP-адрес, но благодаря этому адресу ваш инстанц может быть доступен из интернета.

00:27:41.000 --> 00:27:59.000
В случае, когда мы говорим не дефолтовый VPC, то флажок Выставлять, Выдавать публичное IP-адреса, оно убрано и публичные IP-адреса не выдаются.

00:27:59.000 --> 00:28:08.000
Если вам нужно выдать публичный IP-адрес, то вы должны явно это указать в настройках создания вашего VPC либо сабнета.

00:28:08.000 --> 00:28:28.000
Следующий шаг, четвертый, это привязка IAM-роли к EC2-инстанцу. Этот шаг является опциональным. Идея ее в том, что представим, что ваш инстанц, в нем крутится некоторый код, логика, которая использует и обращается к другим AWS-сервисам.

00:28:28.000 --> 00:28:41.000
В этом случае ему необходимо выдать соответствующие доступы, права. AWS предоставляет удобную и безопасную возможность это сделать, а именно создается IAM-роль.

00:28:41.000 --> 00:29:06.000
Дальше создается instance-профайл с этой ролью. В случае, когда вы делаете это все через AWS-менеджмент консоль, то в момент привязки IAM-роли к инстанцу, прозрачно для вас создается instance-профайл с таким же названием, как ваша IAM-роль.

00:29:06.000 --> 00:29:23.000
Фактически instance-профайл это некий контейнер, который содержит в себе эту роль, а instance-профайл вы можете привязать к инстанцу для того, чтобы предоставить ему доступ к другим AWS-сервисам.

00:29:23.000 --> 00:29:35.000
В случае, когда вы создаете роль и пытаетесь привязать к EC2-инстанцу программным путем, то помните, что вам необходимо также создать instance-профайл.

00:29:35.000 --> 00:30:00.000
На слайде проиллюстрирован пример, когда у нас есть роль. � оль предоставляет доступ к S3-бакету, и в тот момент, когда мы привязываем эту роль к инстанцу через instance-профайл, у инстанца, точнее у кода, который работает внутри инстанца, появляется возможность обратиться к S3-бакетам и как-то взаимодействовать с данными, которые там находятся.

00:30:00.000 --> 00:30:11.000
Аналогично будет происходить процесс выдачи прав к инстанцу к любому другому сервису AWS.

00:30:11.000 --> 00:30:29.000
Пятый шаг — это User Data Script. Этот шаг является опциональным. Идея ее в том, что вместе с созданием вашего инстанца вы можете передать некий набор команд, и эти команды запустятся в самый первый запуск вашего инстанца.

00:30:29.000 --> 00:30:50.000
Зачастую вы здесь передаете список команд, которые могут быть выполнены только после создания инстанца. Возможно, это команды, которые обновляют существующие приложения, может быть, это команды, которые привязаны к метадате вашего инстанца.

00:30:50.000 --> 00:30:59.000
Как метадата инстанца мы можем сказать, что есть private IP-адрес, public IP-адрес и другая информация.

00:30:59.000 --> 00:31:20.000
Здесь у вас может возникнуть вопрос, почему нам нужно использовать User Data, если есть уже готовый AMI, в котором мы предварительно установим все необходимые программы, запустим необходимые команды и уже все будет готово.

00:31:20.000 --> 00:31:44.000
Это абсолютно правильный ход мыслей, и так и нужно поступать. То есть все то, что вы можете обернуть и сохранить в шаблоне AMI, это нужно сделать. Все то, что не получится по тем или иным причинам положить внутри AMI, вы можете сделать в User Data.

00:31:44.000 --> 00:32:02.000
User Data доступно не только для Linux-операционных систем, так же для Windows. Следует только учесть, что когда вы запускаете в Windows, набор команд должен быть совместимым либо с Command Prompt, Windows, то есть CMD, либо с Windows PowerShell.

00:32:02.000 --> 00:32:18.000
Другой немаловажный момент, это то, что все команды, которые вы запускаете, будь то Windows, будь то Linux-операционная система, они запускаются под admin-правами, либо root-пользователем.

00:32:18.000 --> 00:32:33.000
Следующий шаг, это шестой, Specify Storage, то есть мы здесь указываем информацию по нашим жестким дискам. Здесь мы указываем основной жесткий диск, то есть root-vlm, в котором мы устанавливаем операционную систему.

00:32:33.000 --> 00:32:48.000
Так же можем указать дополнительные жесткие диски, в которых будем хранить наши данные. Если вы уже настроили ваши жесткие диски внутри AMI, то этот шаг пропускается.

00:32:48.000 --> 00:33:03.000
Когда мы говорим про жесткие диски, мы говорим про три момента. Первый это ее размер, дальше это тип, и третий это информация по шифрованию этих жестких дисков.

00:33:03.000 --> 00:33:18.000
Когда мы говорим про хранилища для EC2-инстанца, то упоминают четыре возможных варианта. Первые два это Elastic Block Store, то есть Amazon EBS, и Amazon EC2 Instance Store. Это фича сервиса Amazon EC2.

00:33:18.000 --> 00:33:34.000
Оба эти варианты являются блочным хранилищем, таким образом, что первый и второй вариант подходят для установки операционной системы и соответственно полноценного запуска нашего виртуального сервера.

00:33:34.000 --> 00:33:58.000
Есть некоторые отличия. Когда-то давно, когда не было сервиса Amazon EBS, использовался вариант только Amazon EC2 Instance Store. Это те жесткие диски, которые в дата-центре физически привязаны, то есть подключены к нашей оперативной памяти и к нашему процессору.

00:33:58.000 --> 00:34:15.000
То есть это одно целое, один сервер. Таким образом, когда что-то происходит не так, ломается, поломка и автоматически заменяется ваш инстанс, то все то, что находится в жестких дисках с этим инстансом, оно для вас более становится недоступным.

00:34:15.000 --> 00:34:35.000
Так как есть такое неудобство, был создан альтернативный вариант, это сервис Elastic Block Store. Идея в том, что жесткие диски, они более не привязаны к инстансам, то есть к вычислительным мощностям и являются чем-то отдельно стоящим.

00:34:35.000 --> 00:35:01.000
Таким образом, вы через Amazon EBS создаете ресурсы, то есть жесткие диски, которые привязываете к вашему инстанцу. В случае, когда происходит какая-то поломка либо с процессором, либо с оперативной памятью в целом, с этим инстанцем физически, то вы можете ваши жесткие диски, которые к нему не относятся, приоттачить, то есть привязать к другому инстанцу.

00:35:01.000 --> 00:35:26.000
И все будет работать, вы никакие данные не потеряете. В этом и есть отличие EBS от Instant Store. Поэтому общая рекомендация как best practice, использовать Amazon EBS там, где это возможно. В некоторых случаях оправданно использование Instant Store, это все зависит от вашей бизнес задачи и нужно детально это рассматривать.

00:35:26.000 --> 00:35:55.000
Следующий вариант это Amazon Elastic File System. Опять же, это файловая система, блочное хранилище. Отличие лишь в том, что вы не можете на нем установить операционную систему, но она отличается тем, я использую в тех случаях, когда вам нужен отдельно стоящий жесткий диск, который доступен для нескольких EC2-инстанций.

00:35:55.000 --> 00:36:09.000
И является некоторым общим жестким диском. Опять же, от вашей бизнес задачи вам может понадобиться хранить в одном месте некоторые данные, для того, чтобы ваши инстанции могли туда добираться и совместно с этими данными работать.

00:36:09.000 --> 00:36:38.000
Также другой вариант для совместной работы с несколькими инстанциями, это сервис уже знакомый нам, Amazon S3, то есть Simple Storage Service. Этот сервис предоставляет не блочное, но объектное хранилище. В случае, когда мы работаем с объектами, мы также можем воспользоваться сервисом S3 для того, чтобы совместно с несколькими инстанциями обращаться и работать с одними и теми же данными.

00:36:38.000 --> 00:36:56.000
Здесь представлен пример наглядной инстанция, которую используют как root volume Amazon EBS, а также инстанция второй, которую используют как root volume, нашей thermal volume, то есть instance store.

00:36:56.000 --> 00:37:14.000
Давайте пройдемся по отличию либо схожести этих двух вариантов в зависимости от действий или состояния, которое происходит с инстанцием. Первое это перезагрузка. В случае, когда мы перезагружаем инстанц, для обоих вариантов данные у нас сохраняются, ничего не теряется.

00:37:14.000 --> 00:37:31.000
Когда мы говорим про остановку, то есть stop инстанца, мы можем инстанц, который работает с EBS остановить. Остановленный инстанц мы не оплачиваем, мы оплачиваем только за наши данные, которые лежат внутри EBS.

00:37:31.000 --> 00:37:51.000
А за EC2, который является намного дороже, мы не оплачиваем. Это может быть удобно, если некоторые наши серверы простаивают и там проще их приостановить либо терминейтнуть для того, чтобы не терять деньги.

00:37:51.000 --> 00:38:08.000
Когда мы говорим про instance store, то функционал остановить инстанц недоступен, вы не можете его остановить. Таким образом, есть вариант либо перезагрузить, либо третий вариант это терминейтнуть, то есть уничтожить сервер.

00:38:08.000 --> 00:38:24.000
Когда мы терминейтим инстанц с EBS жесткими дисками, то терминейтится сам инстанц, а жесткие диски они сохраняются и остаются для нас доступными.

00:38:24.000 --> 00:38:44.000
Для удаления мы также можем указать, есть определенная опция с флажком. Если мы выставляем этот флажок, то наши жесткие диски совместно с EC2 инстанцем удалятся, либо мы можем не выставлять этот флажок и наши жесткие диски сохранятся.

00:38:44.000 --> 00:38:55.000
И эти жесткие диски мы после можем привязать к другому инстанцу, другого типа и все данные, которые были, они в таком же состоянии останутся доступными в таком же виде.

00:38:55.000 --> 00:39:20.000
Когда мы терминейтим инстанц, который работает с Instant Store, то данные, которые находятся в Эфирмал Воллеме, они полностью удаляются, включая операционную систему. Поэтому хранить некоторые данные, которые вы не сможете восстановить, либо важные данные не рекомендуется хранить в Instant Store.

00:39:20.000 --> 00:39:30.000
Там вы можете хранить какие-то данные для кэширования, либо любые другие данные, которые временные или вы в любой момент можете восстановить.

00:39:30.000 --> 00:39:50.000
Следующий шаг это возможность добавить теги. Здесь хотелось бы отметить, что теги это функционал, который доступен для любого ресурса, любого AWS сервиса, поэтому оно не привязано конкретно к EC2 инстанцам.

00:39:50.000 --> 00:39:56.000
Что такое теги? Теги это некий набор пар, ключ и значения.

00:39:56.000 --> 00:40:16.000
Приведу примеры ключей. Самый популярный это name. И когда вы заполняете неким значением, то это значение зачастую отображается внутри AWS Management консоли вместе с ID-шником этого ресурса. Это в большинстве случаев помогает идентифицировать ресурс.

00:40:16.000 --> 00:40:29.000
Другие варианты ключей это environment, то есть среда. Оно может быть тестовой средой для разработчиков, либо боевой средой.

00:40:29.000 --> 00:40:40.000
Соответственно, для ключа key environment будут значения внутри валвы поля, либо def, либо test, либо prod, либо любые другие.

00:40:40.000 --> 00:40:54.000
Другой вариант ключа тега это owner, то есть владелец. И как значение может указываться либо определенный человек, специалист, либо некоторый департамент управления внутри вашей компании.

00:40:54.000 --> 00:41:17.000
Идея тегов это в том, чтобы идентифицировать однозначно этот ресурс и в случае чего получить ответы. Если не получить ответы, то по крайней мере получить некоторую информацию, которая поможет найти нужных людей, нужную группу людей, нужный отдел, структуру вашей организации, которая отвечает за этот ресурс.

00:41:17.000 --> 00:41:34.000
Причины подобных вопросов или поиска людей может быть разные. Может быть такое, что этот ресурс работает долгое время и ежемесячно потребляет очень много денег.

00:41:34.000 --> 00:41:50.000
Уходит, например, тысячу долларов только на один instance, он большой. И люди, которые занимаются оптимизацией расходов внутри AWS, нашли этот ресурс и уже хотят получить ответы, почему он крутится, работает, не работает, нужно, не нужно и так далее.

00:41:50.000 --> 00:42:05.000
Другой вариант может быть такой, что есть некоторые сервисы, под сервисом, естественно, у нас разный набор ресурсов и что-то пошло не так, что-то сломалось, никто восстановить не может, не может найти специалиста, кому можно обратиться.

00:42:05.000 --> 00:42:25.000
И в этом случае нам могут помочь теги для того, чтобы понять, куда задавать вопросы, чтобы уточнить, этот сервис кому-то нужен, что-то серьезное сломалось, либо нет, нужно восстанавливать или не нужно терять на это время, потому что что-то траченное время специалисту это тоже деньги для компании.

00:42:25.000 --> 00:42:45.000
Все теги, что ключ, что значение, они являются case sensitive, это значит, что они чувствительны к регистру. Простыми словами вы можете создать ключ name с большой буквой, заглавной буквой, а также такой же ключ name, только все буквы с прописными маленькими буквами.

00:42:45.000 --> 00:42:56.000
И никакой ошибки в этом случае не будет, потому как внутри в системе эти ключи воспринимаются как отдельные.

00:42:56.000 --> 00:43:05.000
Восьмой шаг – это настройка security group. Мы можем привязать одну либо несколько security group к нашему инстанцу.

00:43:05.000 --> 00:43:17.000
Что такое security группа, мы с вами ранее проговаривали. Вкратце это некий firewall виртуальный, который фильтрует трафик то нашего инстанца.

00:43:17.000 --> 00:43:27.000
Мы указываем в security группе набор рулов, то есть правил, которые разрешают либо входящий, либо исходящий трафик.

00:43:27.000 --> 00:43:38.000
Вы можете видеть на слайде пример предоставления доступа по SSH, то есть это протокол TCP, порт 22 и как source источник вы выбираете пункт myIP.

00:43:38.000 --> 00:43:45.000
Когда вы его выбираете, то копируется ваш текущий адрес и вставляется в соответствующее поле.

00:43:45.000 --> 00:43:55.000
После чего у вас появляется возможность по SSH подключиться ко всем инстанцам, к которым привязана конкретная security группа.

00:43:55.000 --> 00:44:03.000
Для того, чтобы успешно подключиться к инстанцу, дополнительно вам также нужно соответствующие SSH ключи.

00:44:03.000 --> 00:44:11.000
Самый последний шаг во время создания EC2 инстанца это выбрать либо создать новый key pair.

00:44:11.000 --> 00:44:17.000
Key pair это связка public key и private key, то есть публичный ключ и приватный ключ.

00:44:17.000 --> 00:44:25.000
Публичный ключ сохраняется внутри EC2 инстанца, а private key вы загружаете для локального хранения.

00:44:25.000 --> 00:44:35.000
В момент подключения по SSH вы предоставляете ваш private key, и после чего происходит криптографическая операция,

00:44:35.000 --> 00:44:44.000
которая сверяется, действительно ли ваш private key относится к public key, хранящийся внутри EC2 инстанца.

00:44:44.000 --> 00:44:49.000
Если все совпадает, то доступ по SSH вам предоставляется.

00:44:49.000 --> 00:44:59.000
Здесь вы можете видеть пример списка инстанцев внутри вашего AWS аккаунта, то есть это сервис EC2.

00:44:59.000 --> 00:45:08.000
В левом навигационном меню открыта вкладка instances, и на основной странице указывается список всех инстанцев.

00:45:08.000 --> 00:45:14.000
Мы видим, что у нас отфильтрован определенный инстанс, он и выбран.

00:45:14.000 --> 00:45:24.000
В нижней части страницы вы видите несколько вкладок, таких как description, status check, monitoring text и, возможно, любые другие вкладки.

00:45:24.000 --> 00:45:30.000
В этих вкладках предоставляется информация о конкретном выбранном инстансе.

00:45:30.000 --> 00:45:39.000
Мы также с вами можем создавать инстанцы, либо проделывать любые другие действия внутри облака AWS программным путем.

00:45:39.000 --> 00:45:50.000
Для этого существует AWS CLI, то есть Command Line Interface, и второй вариант – это Software Development Kit, то есть SDK.

00:45:50.000 --> 00:45:57.000
Здесь мы видим пример CLI команды, которая создает EC2 instance.

00:45:57.000 --> 00:46:00.000
Обратите внимание, что она состоит из нескольких частей.

00:46:00.000 --> 00:46:05.000
Самое первое – это AWS, говорит о том, что мы обращаемся к AWS CLI.

00:46:05.000 --> 00:46:13.000
Далее название сервиса – это EC2, и внутри EC2 мы указываем, какую операцию нам необходимо произвести.

00:46:13.000 --> 00:46:17.000
В нашем случае это операция run instances.

00:46:17.000 --> 00:46:23.000
После чего в той же строке мы указываем параметры, которые относятся к этой операции.

00:46:23.000 --> 00:46:27.000
Здесь мы видим, что указан Image ID, то есть наш AMI.

00:46:27.000 --> 00:46:33.000
Далее указываем количество инстанцев для создания, тип инстанцев.

00:46:33.000 --> 00:46:46.000
Key name – это название публичного SSH ключа, security группы, а также информацию о AWS регионе, где создаются наши инстанцы.

00:46:46.000 --> 00:46:50.000
Как только запускаем эту команду, мы получаем ответ.

00:46:50.000 --> 00:46:53.000
Ответ может быть успешен либо не успешен.

00:46:53.000 --> 00:47:04.000
В случае ошибки предоставляется информация о коде ошибки, а также ошибка в текстовом формате для того, чтобы получить представление, что же пошло не так.

00:47:04.000 --> 00:47:14.000
В случае, если мы получаем успешный ответ, то в нем как минимум будет указан ID EC2 instance,

00:47:14.000 --> 00:47:19.000
а также другая информация, которая существует и доступна для этой операции.

00:47:19.000 --> 00:47:26.000
На этом слайде представлена информация по жизненному циклу любого EC2 instance.

00:47:26.000 --> 00:47:35.000
В квадратных фигурах указано состояние инстанца, а название стрелок – это то действие, которое мы производим.

00:47:35.000 --> 00:47:37.000
Начнем с самого начала.

00:47:37.000 --> 00:47:39.000
Есть у нас AMI.

00:47:39.000 --> 00:47:44.000
Когда мы запускаем instance, то instance переходит от AMI в состояние в pending.

00:47:44.000 --> 00:47:50.000
Pending состояние означает, что AMI устанавливается на железо внутри дата центра.

00:47:50.000 --> 00:48:00.000
Как только все настройки произведены и instance готов к бою, то есть он может начать принимать трафик, вы можете подключаться по SSH, и в целом он доступен для работы,

00:48:00.000 --> 00:48:07.000
то он переходит от состояния pending в состояние running.

00:48:07.000 --> 00:48:26.000
Мы с вами помним, что операционная система, то есть root volume EC2 instance может быть EBS, back-up, то есть жесткие диски, созданные внутри сервиса Amazon EBS,

00:48:26.000 --> 00:48:41.000
либо используется опция instance store, когда мы работаем с жесткими дисками, напрямую привязанные к нашему железу внутри дата центра.

00:48:41.000 --> 00:48:57.000
И для обоих вариантов у нас доступен вариант reboot, то есть перезагрузить сервер, в этом случае сервер перезагружается, и данные, которые там находятся в обоих случаях, они сохраняются.

00:48:57.000 --> 00:49:14.000
Теперь в случае, когда мы работаем с EBS жесткими дисками, то у нас есть вариант остановить наш instance, она от состояния running, как только мы стартовали действие stop,

00:49:14.000 --> 00:49:18.000
переходит в состояние stopped через состояние stopping.

00:49:18.000 --> 00:49:26.000
В состоянии stopped мы не оплачиваем за instance, она в состоянии гибернации, мы оплачиваем только за EBS.

00:49:26.000 --> 00:49:39.000
Здесь я напомню, что основная часть оплаты, она не за жесткие диски, а именно за instance, таким образом остановив instance, мы экономим наши деньги.

00:49:39.000 --> 00:49:54.000
В тот момент, когда нам необходимо наш instance стартовать еще раз, то мы можем из состояния stopped его запустить, он переходит в состояние pending, и обратно возвращается в состояние running, то есть готов к бою.

00:49:54.000 --> 00:50:06.000
Далее мы можем terminate, то есть уничтожить, либо высвободить ресурсы, высвободить железо, и более не оплачивать.

00:50:06.000 --> 00:50:14.000
Таким образом происходит переход от состояния running в состояние terminated, промежуточное состояние shutting down.

00:50:14.000 --> 00:50:27.000
Как только сервер у нас остановлен, то какое-то время у нас в списке инстенсов наш остановленный, то есть отключенный instance будет отображаться и статус будет terminated.

00:50:27.000 --> 00:50:42.000
Как только удаление, высвобождение этого instance полностью заканчивается, то из списка этот instance полностью пропадает.

00:50:42.000 --> 00:50:47.000
Мы с вами поговорили подробнее про жизненный цикл и ситу инстенса.

00:50:47.000 --> 00:50:54.000
Также в зависимости от состояния ситу инстенса есть некоторые нюансы работы с публичными IP адресами.

00:50:54.000 --> 00:51:06.000
У нас есть два варианта публичного адреса, это public IP адрес, который выдаётся временно для наших инстенцев, и эти инстенсы доступны через интернет.

00:51:06.000 --> 00:51:17.000
Второй вариант это вариант static IP адрес, то есть постоянный IP адрес через сервис Elastic IP адрес, вы можете отдельно его заказать, если вам нужна такая опция.

00:51:17.000 --> 00:51:35.000
Так вот, когда мы говорим про public IP адрес, публичный IP адрес это некоторый pool, то есть некоторый набор IP адресов, не привязанных конкретно к вашему аккаунту, это общий набор IP адресов, которые доступны для Amazon.

00:51:35.000 --> 00:51:47.000
В зависимости от занятости того или иного IP адреса, вам во временное пользование вашим инстенсам выдаётся некоторое значение.

00:51:47.000 --> 00:52:00.000
И здесь важный момент, когда мы terminate им инстенс и создаём новый инстенс, здесь понятно, мы получаем случайный IP адрес публичный, и никак не влияем на её значение.

00:52:00.000 --> 00:52:18.000
В случае, когда мы останавливаем инстенс, также следует запомнить, что публичный IP адрес, он обратно возвращается AWS, для того, чтобы оно могло назначиться EC2 инстанцию в другом AWS аккаунте.

00:52:18.000 --> 00:52:38.000
Поэтому, учитывайте этот момент, и знайте, что когда сервер у нас останавливается и запускается снова, для него выдаётся новый публичный IP адрес, который доступен на тот момент, на момент запуска.

00:52:38.000 --> 00:52:48.000
Если возвращаясь к статическому IP адресу, то это Elastic IP адрес, выделенный сервис, который вам даёт статический IP адрес.

00:52:48.000 --> 00:52:59.000
По умолчанию, внутри AWS аккаунта вам доступны пять IP адресов, если же вам нужно больше, то вы можете сделать соответствующий запрос.

00:52:59.000 --> 00:53:09.000
Этот лимит он soft limit, поэтому может быть увеличен в зависимости от вашей необходимости через обращение в support.

00:53:09.000 --> 00:53:14.000
Как только ваш инстанс запущен, по у этого инстанца появляются некие метаданные.

00:53:14.000 --> 00:53:27.000
Как метаданные выступают публичный IP адрес, приватный IP адрес, информация о том, на каком регионе запущен этот инстанс, какой availability zone относится, какие security группы привязаны к этому инстанцу.

00:53:27.000 --> 00:53:39.000
То есть вся возможная информация о этом инстанце, она доступна в AWS Management Console в соответствующих вкладках в сгруппированном виде.

00:53:39.000 --> 00:53:53.000
А также эта же информация доступна из самого инстанца, если обратиться по IP адресу 169.254.169.254.

00:53:53.000 --> 00:53:59.000
Если мы идем по пути latest metadata, то мы выходим на метаданные по этому конкретному инстанцу.

00:53:59.000 --> 00:54:08.000
Если мы идем по пути latest и user data, то мы открываем список команд, которые запускаются при первом запуске этого инстанца.

00:54:08.000 --> 00:54:12.000
Вы можете использовать эти данные, эта ссылка она постоянная.

00:54:12.000 --> 00:54:26.000
И в случае, если вам нужна какая-то информация либо с user data, либо метадата конкретного инстанца, то вы можете во время настройки обращаться по этому пути.

00:54:26.000 --> 00:54:30.000
Это JSON документ, в JSON документе соответствующие ключи.

00:54:30.000 --> 00:54:38.000
Этот путь внутри JSON файла, он тоже постоянный, и вы можете эти данные использовать для финальной настройки вашего инстанца.

00:54:38.000 --> 00:54:48.000
Также я вам рекомендую запомнить оба URL адреса, так как они бывает приходят на реальный WS экзамене.

00:54:51.000 --> 00:54:57.000
Когда мы говорим про мониторинг нашего ICT-инстанца, то подразумевается сервис Amazon CloudWatch.

00:54:57.000 --> 00:55:09.000
Это тот сервис, который сохраняет метрики, и вы в графическом виде можете отобразить изменения ваших метрик и предпринимать некоторые шаги.

00:55:09.000 --> 00:55:15.000
Либо вручную, либо опять же настроить автоматическое реагирование на соответствующее значение метрик.

00:55:17.000 --> 00:55:19.000
Как метрики могут выступать?

00:55:19.000 --> 00:55:29.000
Нагруженность ваших ядер процессора, нагрузка на ваши жесткие диски, то есть операция записи отдельно, операция чтения отдельно.

00:55:29.000 --> 00:55:34.000
Также информация по загрузке канала сети, то есть Network.

00:55:34.000 --> 00:55:42.000
Здесь важно отметить, что метрика RAM, то есть загрузка оперативной памяти по умолчанию недоступна.

00:55:42.000 --> 00:55:51.000
Для того, чтобы эти метрики тоже передавать, необходимо выполнить некоторые дополнительные действия, и эти метрики также будут для вас доступны.

00:55:51.000 --> 00:55:58.000
Более того, в рамках CloudWatch есть два варианта мониторинга. Это Basic Monitoring и Detailed Monitoring.

00:55:58.000 --> 00:56:03.000
При варианте Basic Monitoring метрики передаются каждые 5 минут.

00:56:05.000 --> 00:56:10.000
И эта опция, она бесплатная, доступная по умолчанию.

00:56:10.000 --> 00:56:18.000
Вторая опция, это если ваши метрики нужно передавать чаще, либо вам нужно видеть большую детализацию.

00:56:18.000 --> 00:56:27.000
В этом случае Detailed Monitoring позволяет вам передавать и хранить метрики по каждой минуте, то есть ежеминутно.

00:56:29.000 --> 00:56:39.000
Следует отметить, что Detailed Monitoring, она оплачивается отдельно, и информацию по оплате, по стоимости вы можете посмотреть на соответствующей странице.

00:56:39.000 --> 00:56:48.000
Мы с вами добрались до конца второй части нашей лекции. Давайте резюмируем и пройдемся по самым основным моментам.

00:56:49.000 --> 00:56:55.000
Во время создания EC2-инстанца, мы можем выбрать операционную систему как Linux, так и Windows.

00:56:56.000 --> 00:57:07.000
Мы создаем EC2-инстанцы от некоторого AMI. AMI это Amazon Machine Instance, который в себя включает помимо операционной системы,

00:57:07.000 --> 00:57:13.000
также дополнительные настройки, установку неких программ и запуск определенных команд.

00:57:14.000 --> 00:57:17.000
То есть выступает как снапшот другого инстанца.

00:57:18.000 --> 00:57:23.000
Также во время создания EC2-инстанца, мы должны указать в каком VPC он будет создан.

00:57:23.000 --> 00:57:36.000
С точки зрения безопасности и best practices security рекомендуется не использовать дефолтный VPC, а создать собственный, новый.

00:57:37.000 --> 00:57:43.000
Для вашего выбора доступны различные типы инстанцев, а также есть целые семейства типов инстанцев,

00:57:43.000 --> 00:57:56.000
чтобы подобрать максимально подходящую конфигурацию с точки зрения количества ядер процессора, размера оперативной памяти, возможности хранилищ и сетей.

00:57:58.000 --> 00:58:03.000
Для того, чтобы контролировать доступ к вашим инстанцам, вы можете использовать security группы.

00:58:04.000 --> 00:58:09.000
Security группы работают на уровне инстанцев и выступают в роли виртуального firewall.

00:58:09.000 --> 00:58:17.000
Вы можете во время создания инстанца также передать список команд, который называется user data,

00:58:17.000 --> 00:58:28.000
для того, чтобы финализировать настройку и запустить те команды, которые могут быть успешно выполнены только после запуска инстанца.

00:58:28.000 --> 00:58:43.000
Операционная система инстанца может быть установлена на жесткие диски от Amazon EBS, либо EC2 Instance Store.

00:58:45.000 --> 00:58:49.000
Те инстанции, которые использует Instance Store не могут быть остановлены.

00:58:50.000 --> 00:58:55.000
Инстанции, которые используют жесткие диски от Amazon EBS могут быть остановлены.

00:58:55.000 --> 00:59:01.000
Более того, в остановленном состоянии оплата за инстанции не производится.

00:59:02.000 --> 00:59:04.000
Таким образом, вы экономите деньги.

00:59:06.000 --> 00:59:15.000
Для того, чтобы мониторить ваши инстанции, вы можете воспользоваться сервисом Amazon CloudWatch и передавать туда соответствующие метрики.

00:59:18.000 --> 00:59:22.000
На этом мы завершаем вторую часть и переходим к следующей части.

00:59:22.000 --> 00:59:26.000
Мы с вами добрались до третьей части сегодняшней нашей лекции.

00:59:27.000 --> 00:59:36.000
Здесь мы с вами подробнее поговорим про вопросы оплаты и оптимизации оплаты за сервис EC2.

00:59:38.000 --> 00:59:43.000
Давайте с вами подробнее разберем, какие модели оплаты существуют за сервис Amazon EC2.

00:59:44.000 --> 00:59:46.000
Самые первые – это on-demand instances.

00:59:46.000 --> 00:59:51.000
Это вариант, когда мы оплачиваем ровно за то, за что мы используем.

00:59:52.000 --> 01:00:02.000
Представим, что мы заказали 10 серверов на 2 часа для того, чтобы произвести некоторые расчеты, после чего эти серверы нам не нужны.

01:00:03.000 --> 01:00:07.000
Это пример расчетов нагрузки, которые непостоянные или бразовые.

01:00:07.000 --> 01:00:21.000
Таким образом on-demand позволит нам уже в конце месяца получить счет на оплату, где будет сидеть 2 часа, умноженное на 10 инстенсов, на 20 часов определенного типа инстенсов, не более.

01:00:22.000 --> 01:00:25.000
Таким образом мы оплатили ровно за то, за что мы использовали.

01:00:25.000 --> 01:00:43.000
Здесь еще важный момент – это то, что в случае, если мы работаем с операционной системой Amazon Linux или Ubuntu, то для нас становится доступны посекундные тарификации.

01:00:44.000 --> 01:00:53.000
Таким образом, если мы запустили инстенс на 1 минуту и 57 секунд, то ровно за это время мы произведем оплату.

01:00:53.000 --> 01:01:00.000
Следующая модель оплаты за Amazon Linux – это Reserved Instances.

01:01:01.000 --> 01:01:06.000
Эта модель оплаты идеально подходит для тех нагрузок, которые постоянны 24 на 7.

01:01:07.000 --> 01:01:19.000
В этом случае мы можем некоторую часть вычислительных мощностей заказать через Reserved Instances и мы получим определенные скидки от AWS.

01:01:19.000 --> 01:01:31.000
Как это работает? Мы говорим, что мы готовы приобрести определенный объем вычислительных мощностей на год либо на 3 года.

01:01:32.000 --> 01:01:40.000
Как только заключается договор, эти инстенсы со скидкой нам передаются в использовании.

01:01:40.000 --> 01:01:49.000
Есть некоторые нюансы касательно оплаты, а именно 3 варианта. От этого зависит размер скидки.

01:01:50.000 --> 01:01:57.000
Самую наименьшую скидку мы получаем в случае, когда договор мы заключаем, при этом мы продолжаем оплачивать ежемесячно.

01:01:58.000 --> 01:02:04.000
Этот вариант называется No-upfront Reserved Instances, наперед ничего не оплачиваем.

01:02:04.000 --> 01:02:13.000
Далее следующий вариант, когда мы 50% периода, год либо 3 года оплачиваем сразу, оставшиеся 50% оплачиваем ежемесячно.

01:02:14.000 --> 01:02:18.000
Это называется Partial Upfront Reserved Instances либо PURI.

01:02:19.000 --> 01:02:27.000
И третий вариант, когда мы получаем максимальную скидку в рамках Reserved Instances, это Auri, то есть All Upfront Reserved Instances.

01:02:27.000 --> 01:02:34.000
И как вы догадались, мы оплачиваем сразу год либо 3 года работы наших инстенсов наперед.

01:02:35.000 --> 01:02:39.000
Таким образом, ежемесячно нам производить оплату не нужно.

01:02:41.000 --> 01:02:51.000
Этот вариант идеально подходит для тех случаев, когда вы как бизнес выросли, у вас есть определенный набор объем нагрузки постоянный 24 на 7 присутствующие.

01:02:51.000 --> 01:03:01.000
В этом случае, зная момент, что у вас есть эти постоянные нагрузки, мы можем хорошую скидку получить от AWS через модель Reserved Instances.

01:03:03.000 --> 01:03:07.000
Следующая модель оплаты за Amazon EC2 – Spot Instances.

01:03:08.000 --> 01:03:10.000
Это достаточно интересная модель.

01:03:10.000 --> 01:03:21.000
Следует запомнить, что Spot Instances дает максимальную прибыль возможную и скидка может достигать до 90%.

01:03:22.000 --> 01:03:31.000
Это говорит о том, что цены за Spot Instances за единицу времени, она может быть в 10 раз меньше, чем цены за On Demand Instances.

01:03:32.000 --> 01:03:38.000
Это очень интересное предложение, которое следует воспользоваться.

01:03:38.000 --> 01:03:40.000
Но есть здесь определенные нюансы.

01:03:41.000 --> 01:03:43.000
Spot Instances, откуда это все появилось?

01:03:44.000 --> 01:03:54.000
Так как дата-центры AWS это достаточно большие помещения, в которых есть достаточно большой объем вычислительных мощностей,

01:03:55.000 --> 01:03:58.000
частенько бывает, что какая-то часть серверов, она не нагружена.

01:03:58.000 --> 01:04:07.000
То есть она не затребована ни каким клиентам, пользователям AWS, поэтому зря простаивают.

01:04:08.000 --> 01:04:12.000
Здесь AWS не растерялся и предложил следующую модель.

01:04:13.000 --> 01:04:19.000
Он готов делать большие скидки за инстанции, которые не затребованы, не требуются для других моделей оплаты,

01:04:20.000 --> 01:04:26.000
для того, чтобы он что-то мог зарабатывать, пусть и меньше, но при этом зря деньги не терял.

01:04:26.000 --> 01:04:33.000
Это хорошо и клиентам, так как дает возможность еще больше сэкономить, используя абсолютно то же железо.

01:04:34.000 --> 01:04:39.000
Момент такой, что Spot Instances по сравнению с On Demand Instances,

01:04:40.000 --> 01:04:45.000
они даются во владение, которое контролируется и решается не нами.

01:04:46.000 --> 01:04:49.000
В случае с On Demand Instances мы заказываем инстанции,

01:04:49.000 --> 01:04:57.000
эти инстанции будут доступны для нас ровно до того момента, пока мы сами не решим от них освободиться.

01:04:58.000 --> 01:05:03.000
То есть terminated для того, чтобы освободить и вернуть AWS, и больше за них не оплачивать.

01:05:04.000 --> 01:05:15.000
В случае со Spot Instances мы используем до того момента, пока эти инстанции не затребуются другой моделью оплаты.

01:05:15.000 --> 01:05:24.000
В этом случае приходит уведомление о том, что этот Spot Instances не может быть дальше обслуживаться по этой модели

01:05:25.000 --> 01:05:28.000
и через какое-то время отключается. Есть такой нюанс.

01:05:29.000 --> 01:05:34.000
Таким образом, если у вас есть постоянные нагрузки, полностью на Spot Instances она существовать не может.

01:05:35.000 --> 01:05:41.000
Spot Instances идеально подходят для тех нагрузок, которые являются асинхронными.

01:05:41.000 --> 01:05:46.000
Представим, что у вас есть какие-то расчеты, эти расчеты могут быть сделаны сейчас,

01:05:47.000 --> 01:05:52.000
могут быть сделаны ночью в 2 часа, могут быть в любой момент прерваны и продолжены с того места,

01:05:53.000 --> 01:05:56.000
потому что у вас где-то каким-то образом сохраняется состояние.

01:05:57.000 --> 01:06:00.000
Для подобных нагрузок Spot Instances идеальный вариант.

01:06:01.000 --> 01:06:08.000
Есть еще вариант такой, когда вы скейлите, через автоскейлинг настраиваете несколько групп.

01:06:08.000 --> 01:06:12.000
Часть группы это On Demand Instances, а часть инстенсов это Spot Instances.

01:06:13.000 --> 01:06:17.000
В тот момент, когда Spot Instances доступны, вы работаете со Spot Instances.

01:06:18.000 --> 01:06:24.000
Если получается так, что Spot Instances недоступны, то AWS соответственно все Spot Instances забирает себе

01:06:25.000 --> 01:06:30.000
и автоматически автоскейлинг срабатывает и поднимает уже On Demand Instances.

01:06:30.000 --> 01:06:38.000
По цене, естественно, дороже, но как минимум благодаря этой архитектуре есть возможность значительные суммы экономить

01:06:39.000 --> 01:06:43.000
путем переброски вычислительных мощностей на Spot Instances.

01:06:44.000 --> 01:06:53.000
Это требует дополнительной настройки, нужен специалист и нужно подходить к задаче с соответствующим расчетом.

01:06:53.000 --> 01:06:59.000
Если выходит так, что выгоднее это настроить, то бизнесу это нужно предложить и это сделать.

01:07:00.000 --> 01:07:05.000
Если же выгода от этого небольшая, то рекомендуется оставаться на On Demand Instances.

01:07:07.000 --> 01:07:11.000
Как происходит ценообразование Spot Instances?

01:07:14.000 --> 01:07:21.000
Оно организовано неким аукционом, то есть вы предлагаете какую-то свою цену, другой пользователь AWS

01:07:21.000 --> 01:07:30.000
также в рамках Spot Instances предлагает свою цену и AWS, естественно, выбирает тот вариант, который максимальный

01:07:31.000 --> 01:07:37.000
для того, чтобы свою прибыль увеличить, но при этом эта цена может быть в несколько раз меньше, чем On Demand Instances.

01:07:39.000 --> 01:07:45.000
Таким образом, все зависит от региона, например, для региона Норс-Вирджиния,

01:07:45.000 --> 01:07:51.000
который является самым популярным, самым насыщенным пользователем AWS-регионом.

01:07:52.000 --> 01:07:57.000
В нем маловероятно, что будет возможность использовать Spot Instances,

01:07:58.000 --> 01:08:03.000
а, например, для регионов, которые менее популярны, Spot Instances может быть отличным вариантом,

01:08:04.000 --> 01:08:09.000
который ввиду того, что очень мало пользователей сидят в этом регионе,

01:08:09.000 --> 01:08:18.000
может получиться так, что ваши постоянные нагрузки большую часть времени отрабатывают по модели Spot Instances,

01:08:19.000 --> 01:08:20.000
при этом вы получаете максимальные скидки.

01:08:23.000 --> 01:08:28.000
Следующие две модели оплаты, они привязаны к железу EC2 Instances,

01:08:29.000 --> 01:08:31.000
называются Dedicated Hosts и Dedicated Instances.

01:08:31.000 --> 01:08:39.000
Чем они отличаются? Dedicated Hosts позволяет вам привязаться к некоторым характеристикам этого железа,

01:08:40.000 --> 01:08:41.000
для того, чтобы применить лицензии.

01:08:42.000 --> 01:08:48.000
Например, лицензии Oracle Баз данных привязываются к количеству ядер на определенном железе.

01:08:49.000 --> 01:08:52.000
В этом случае, чтобы применить эту лицензию, вы можете использовать Dedicated Hosts.

01:08:52.000 --> 01:09:02.000
Dedicated Instances – это тот кейс, когда в облаке вам выделяется отдельный сервер железа,

01:09:03.000 --> 01:09:10.000
в котором нагрузки к других пользователей WS не допускаются.

01:09:11.000 --> 01:09:17.000
Таким образом, вы являетесь не владельцем, арендуете это железо полностью под себя, и никто другой там не будет.

01:09:17.000 --> 01:09:25.000
Эти инстанции бывают нужны для некоторых регуляторных требований.

01:09:26.000 --> 01:09:34.000
Например, требуется, чтобы эти нагрузки, ввиду некоторых специфик данных, либо обработки,

01:09:35.000 --> 01:09:38.000
должны запускаться на отдельном железе.

01:09:39.000 --> 01:09:41.000
В этом случае вам необходимо использовать Dedicated Instances.

01:09:41.000 --> 01:09:47.000
Dedicated Instances, ввиду своей специфики, являются одними из самых дорогих,

01:09:48.000 --> 01:09:54.000
потому что под вас персонально выделяется конкретное железо, и это достаточно дорогостоящая услуга.

01:09:55.000 --> 01:10:02.000
Но также следует отметить, что Dedicated Instances достаточно редко требуются, опять же, ввиду некоторых регуляторных требований.

01:10:02.000 --> 01:10:10.000
Во всех других нормальных случаях on-demand instances будет более чем достаточно.

01:10:11.000 --> 01:10:15.000
И последний вариант оплаты – это Scheduled Reserved Instances.

01:10:16.000 --> 01:10:21.000
Здесь следует сразу отметить, что Scheduled Reserved Instances на текущий момент недоступны.

01:10:21.000 --> 01:10:32.000
Ввиду того, что вопросы внутри реального экзамена AWS обновляются, либо могут обновляться нечасто,

01:10:33.000 --> 01:10:39.000
то вопросы, связанные с Scheduled Reserved Instances в рамках сервиса EC2, могут вам еще приходить.

01:10:40.000 --> 01:10:49.000
Поэтому мы этот момент сейчас разберем, но при этом вы для себя имейте в виду внутри AWS на текущий момент

01:10:49.000 --> 01:10:52.000
этой опции на сегодняшний момент не существует.

01:10:53.000 --> 01:10:54.000
Что же такое Scheduled Reserved Instances?

01:10:55.000 --> 01:11:04.000
Это та опция, которая позволяет вам либо каждый день, либо определенный день недели, еженедельно, ежемесячно,

01:11:05.000 --> 01:11:15.000
по какому-то расписанию определенные часы резервировать под себя на один год.

01:11:15.000 --> 01:11:21.000
Таким образом, вы производите оплату на один год, указываете какое время, какие инстанции должны быть для вас доступны.

01:11:22.000 --> 01:11:24.000
И в этом случае они в этот момент запускаются.

01:11:25.000 --> 01:11:31.000
И вы, опять же, так же как и Reserved Instances, по некоторой скидке производите оплату за эти инстанции.

01:11:36.000 --> 01:11:42.000
Мы на следующих двух слайдах резюмируем все то, что было сказано по моделям оплаты за сервисы EC2.

01:11:42.000 --> 01:11:47.000
Если мы говорим on-demand instances, это тот вариант, который максимально гибкий.

01:11:48.000 --> 01:11:53.000
Spot instances это тот вариант, который удачно подходит для асинхронных нагрузок.

01:11:54.000 --> 01:12:04.000
Reserved instances это хороший вариант модели оплаты, когда у нас есть постоянные нагрузки 24 на 7.

01:12:04.000 --> 01:12:17.000
И мы используем dedicated hosts в том случае, когда по некоторым регуляторным требованиям нам необходимо использовать только самим одно определенное железо.

01:12:18.000 --> 01:12:29.000
Если мы говорим про use cases, on-demand instances используются для кратковременных динамических нагрузок, которые сложно предугадать.

01:12:30.000 --> 01:12:31.000
В этом случае on-demand подходят идеально.

01:12:31.000 --> 01:12:39.000
Другой вариант это мы используем on-demand instances для среды разработки либо тестирования.

01:12:40.000 --> 01:12:44.000
То есть разработка происходит не всегда постоянно, тестирование тоже происходит не всегда постоянно.

01:12:45.000 --> 01:12:55.000
Поэтому после того, как мы провели этап разработки и тестирования, и эти инстанции зря простаивают, мы можем их отключить и при этом не терять зря деньги.

01:12:55.000 --> 01:13:06.000
Spot instances это тот кейс, когда у нас асинхронные нагрузки, мы можем наши расчеты, нагрузки в любой момент остановить и продолжить с того места.

01:13:07.000 --> 01:13:11.000
Оно может отрабатывать ночью, утром, не имеет значения.

01:13:12.000 --> 01:13:23.000
И также один из примеров это когда нам необходимо запустить некоторые расчеты на больших объемах вычислительных мощностей.

01:13:23.000 --> 01:13:28.000
В этом случае spot instances даст некоторую выгоду от объемов.

01:13:31.000 --> 01:13:36.000
Следующий вариант это reserved instances, когда у нас есть постоянные нагрузки 24 на 7.

01:13:37.000 --> 01:13:48.000
Один из вариантов использования это если компания большая, у нее есть возможность оплатить наперед, при этом знать, что он получит хорошие скидки.

01:13:49.000 --> 01:13:51.000
В этом случае можно использовать reserved instances.

01:13:51.000 --> 01:13:54.000
Другой вариант это когда мы настраиваем disaster recovery.

01:13:55.000 --> 01:14:02.000
То есть disaster recovery это когда наша инфраструктура развернута на двух регионах и один основной, другой резервный.

01:14:03.000 --> 01:14:08.000
В случае когда происходит какая-то проблема с целым AWS регионом, что происходит очень редко.

01:14:09.000 --> 01:14:16.000
Но мы говорим, что наши нагрузки, наша инфраструктура должна быть 100% всегда доступна для наших клиентов.

01:14:16.000 --> 01:14:24.000
Потому как потеря клиентов ввиду недоступности на некоторое время может в целом обанкротить всю компанию.

01:14:25.000 --> 01:14:27.000
Поэтому это достаточно критичные нагрузки.

01:14:28.000 --> 01:14:36.000
В этом случае компания разрабатывает и поддерживает DR, то есть disaster recovery.

01:14:36.000 --> 01:14:50.000
И если компании нужно гарантировать, что в основном либо резервном регионе должен быть гарантированный объем вычислительных мощностей наперед, это зная.

01:14:51.000 --> 01:14:57.000
В этом случае мы можем через reserved instances эти вычислительные мощности забронировать.

01:14:58.000 --> 01:15:00.000
И как только они понадобятся их запускать.

01:15:00.000 --> 01:15:05.000
Либо держать в постоянно запущенном состоянии, зная, что мы с какой-то скидкой получили.

01:15:06.000 --> 01:15:12.000
При этом мы 100% уверены, что в момент переключения эти инстанции для нас будут доступны.

01:15:13.000 --> 01:15:16.000
И мы сможем обработать все запросы наших клиентов.

01:15:17.000 --> 01:15:19.000
Последний вариант это dedicated hosts.

01:15:19.000 --> 01:15:32.000
Один из примеров использования, если у нас есть уже купленная лицензия, мы можем опять же в зависимости от ситуации использовать свои лицензии, при этом сэкономить на этом.

01:15:34.000 --> 01:15:39.000
Другой use case это когда нам необходимо следовать некоторым регуляторным требованиям.

01:15:39.000 --> 01:15:48.000
В этом случае работаем на определенном железе, на который не допускаются другие нагрузки, чужие нагрузки.

01:15:53.000 --> 01:16:02.000
Давайте резюмируем все то, что было сказано на нашей лекции касательно оптимизации расходов на сервисе C2.

01:16:02.000 --> 01:16:11.000
Оно состоит из четырех направлений, это write sizing, increase elasticity, optimal pricing model и optimize storage choices.

01:16:12.000 --> 01:16:14.000
Давайте подробнее остановимся на каждой из этих направлений.

01:16:16.000 --> 01:16:18.000
Первое направление это write size.

01:16:19.000 --> 01:16:25.000
Идея в том, что нам необходимо подобрать тот тип инстанций, которые максимально подходят под наши нагрузки.

01:16:25.000 --> 01:16:35.000
Amazon предоставляет более 60 различных типов инстанций и размеров, поэтому определенно мы сможем найти тот вариант, который устраивает нас.

01:16:36.000 --> 01:16:45.000
Понятно, что этот процесс не одноразовый, вы не можете угадать либо по каким-либо факторам определить какой вариант определенно ваш,

01:16:46.000 --> 01:16:48.000
до того как ваши нагрузки начнутся в облаке.

01:16:48.000 --> 01:16:57.000
Происходит это следующим образом, вы выбираете тот вариант типа инстанца, который максимально дешевый и который будет обслуживать ваши нагрузки.

01:16:58.000 --> 01:16:59.000
С этим вы начинаете.

01:17:00.000 --> 01:17:08.000
Далее со временем вы периодически проверяете ваши метрики, то есть вы передаете ваши метрики в сервис Amazon CloudWatch

01:17:09.000 --> 01:17:15.000
и видите какая идет нагрузка на процессор, какая идет нагрузка на оперативную память, хранилище и сеть.

01:17:15.000 --> 01:17:17.000
И делаете выводы.

01:17:18.000 --> 01:17:19.000
Приведу простой пример.

01:17:20.000 --> 01:17:30.000
Представьте, что у вас есть инстант стайп, у которого CPU нагружена на 70%, а оперативная память нагружена на 10%.

01:17:31.000 --> 01:17:39.000
Здесь мы видим явно, что наше приложение больше использует процессорные мощности, нежели оперативную память.

01:17:39.000 --> 01:17:51.000
Таким образом мы можем выбрать тип инстанца, который меньше, но при этом из семейства, который CPU, то есть Type-C.

01:17:52.000 --> 01:18:00.000
В этом случае мы можем сэкономить на размере инстанца, потому что он будет меньше, но при этом у него оперативной памяти будет гораздо меньше.

01:18:00.000 --> 01:18:08.000
Исходя из того, что нагрузки не требует оперативной памяти, этот вариант тип инстанца больше нам подходит.

01:18:09.000 --> 01:18:20.000
Он справляется полностью с нагрузками нашими текущими, при этом мы оплачиваем меньше, нежели мы оплачивали с предыдущим вариантом инстанца.

01:18:21.000 --> 01:18:24.000
Второе направление – increase elasticity.

01:18:24.000 --> 01:18:29.000
Здесь говорится про то, что мы должны правильно настроить наш автоскейлинг.

01:18:30.000 --> 01:18:41.000
Автоскейлинг – это когда наша инфраструктура, это некий живой абстрактный организм, когда в зависимости от нагрузки количество инстанцев, которые обрабатывает ваш трафик, либо увеличивается, либо уменьшается.

01:18:42.000 --> 01:18:49.000
Представим, что вы какой-то интернет-магазин и ваши нагрузки в основном после 6 часов вечера до 10 часов вечера.

01:18:49.000 --> 01:19:05.000
В этом случае система, наблюдая за метриками на ваших инстанциях, определяет, что сейчас нагрузка растет, нагрузка на сервера растет, поэтому нам необходимо после определенного порога запустить дополнительные сервера, чтобы это все работало верно.

01:19:05.000 --> 01:19:19.000
В случае, когда мы опускаемся ниже какого-то другого второго порога, например, если нагрузка на наши сервера меньше 10%, то в этом случае мы видим, что нагрузки как таковой нет.

01:19:20.000 --> 01:19:27.000
Поэтому мы можем лишние инстанции терминировать и вернуть обратно AWS, чтобы за них не платить.

01:19:27.000 --> 01:19:38.000
Таким образом, размер нашей инфраструктуры, оно уменьшается, либо увеличивается в зависимости от нагрузки.

01:19:39.000 --> 01:19:44.000
Таким образом, вы оплачиваете только за те нагрузки, которые реальные.

01:19:44.000 --> 01:19:56.000
И у вас нет состояния, когда некоторые ваши ресурсы, инстанции просто так простаивают, и вы фактически впустую оплачиваете за его использование.

01:19:58.000 --> 01:20:01.000
Третье направление – это optimal pricing model.

01:20:02.000 --> 01:20:07.000
Мы с вами ранее проговорили, какие модели оплаты существуют для сервиса Amazon EC2.

01:20:07.000 --> 01:20:17.000
Таким образом, в зависимости от ваших нагрузок, вы можете подобрать ту модель оплаты, которая будет максимально удобная и эффективная для вас.

01:20:18.000 --> 01:20:21.000
При этом вы несете минимальные расходы на содержание этой инфраструктуры.

01:20:24.000 --> 01:20:29.000
Следующий вариант – это оптимизация нашего storage, то есть хранилища.

01:20:30.000 --> 01:20:33.000
Здесь подразумевается три момента.

01:20:33.000 --> 01:20:39.000
Первый момент – это то, что нам необходимо подбирать размер жестких дисков оптимальными.

01:20:40.000 --> 01:20:52.000
То есть для инстенса, для которого требуется 20 ГБ на основном жестком диске, нет необходимости делать большой запас и создавать жесткий диск в 500 ГБ.

01:20:53.000 --> 01:20:54.000
Вы можете создать с небольшим запасом.

01:20:55.000 --> 01:21:00.000
Также вы вспомните, что у вас есть сервис CloudWatch, куда вы пересылаете ваши метрики.

01:21:00.000 --> 01:21:05.000
Вы видите нагруженность ваших жестких дисков в тот момент, когда достигается некий порог.

01:21:06.000 --> 01:21:08.000
Например, 90% жесткого диска заполнено.

01:21:09.000 --> 01:21:14.000
В этом случае вы можете произвести какое-то действие, чтобы автоматически увеличить размер жестких дисков.

01:21:15.000 --> 01:21:25.000
Либо сообщить по любым каналам, будь то e-mail либо SMS, о том, что жесткий диск переполнен, необходимо предпринять какое-то действие.

01:21:25.000 --> 01:21:33.000
В этом случае вы можете самостоятельно подключиться, либо увеличить, либо посмотреть, почему такое произошло, если это не ожидалось.

01:21:34.000 --> 01:21:38.000
Второй пункт – это тип EBS-волымов.

01:21:39.000 --> 01:21:46.000
На следующих лекциях мы с вами пройдем, какие типы EBS-волымов бывают и в каких случаях какой из типов правильнее выбрать.

01:21:46.000 --> 01:21:54.000
И третий вариант – это то, что у вас есть некоторые снапшоты, то есть бэкапы ваших жестких дисков.

01:21:55.000 --> 01:22:04.000
Это делается, это требуется для того, чтобы в случае возникновения каких-то проблем вы могли легко восстановиться.

01:22:05.000 --> 01:22:06.000
Это нормальная практика – делать бэкапы.

01:22:07.000 --> 01:22:10.000
Но при этом хранить бэкапы пятилетней давности не всегда рационально.

01:22:10.000 --> 01:22:19.000
Достаточно хранить бэкапы, опять же, в зависимости от ваших бизнес требований, недельной давности, месячной давности, может быть, года давности,

01:22:20.000 --> 01:22:24.000
но при этом с некоторыми сдвигами по времени.

01:22:25.000 --> 01:22:30.000
То есть вы храните один бэкап, который год назад был создан, один бэкап, который был создан месяц назад, чтобы туда можно было откатиться,

01:22:31.000 --> 01:22:33.000
и семь бэкапов на последние семь дней.

01:22:34.000 --> 01:22:37.000
Это максимально оптимальный вариант хранения бэкапов.

01:22:37.000 --> 01:22:43.000
Все остальные бэкапы должны быть удалены, потому что за бесполезные бэкапы вы также оплачиваете.

01:22:44.000 --> 01:22:45.000
Это отдельно созданный ресурс внутри AWS.

01:22:46.000 --> 01:22:49.000
Чем меньше лишних ресурсов, тем меньше вы, соответственно, оплачиваете.

01:22:54.000 --> 01:23:00.000
Следует отметить, что процесс оптимизации расходов в облаке – это не разовый процесс.

01:23:00.000 --> 01:23:08.000
Это не связано, опять же, напрямую с облаком. Облако лишь дает возможность видеть все ваши ресурсы как на ладони.

01:23:09.000 --> 01:23:16.000
Но при этом проблема того, что нагрузки меняются, новые ресурсы создаются,

01:23:17.000 --> 01:23:21.000
они существуют как в облаке, так и на локальном дата-центре.

01:23:21.000 --> 01:23:30.000
Поэтому идея в том, чтобы, имея в наличии максимальную видимость на стороне облака,

01:23:31.000 --> 01:23:39.000
у вас есть возможность это все измерить, периодически мониторить и делать некоторые шаги по улучшению.

01:23:40.000 --> 01:23:47.000
После того, как вы проделали это улучшение, все эти шаги циклические повторять,

01:23:47.000 --> 01:23:53.000
потому как инфраструктура постоянно меняется, команд у вас разработки может быть много,

01:23:54.000 --> 01:23:59.000
и вся эта инфраструктура, это как живое организм, она постоянно в динамике, что-то с ней происходит.

01:24:00.000 --> 01:24:07.000
Поэтому правильно измерять, мониторить, отслеживать изменения, видеть текущее состояние и предпринимать какие-то действия,

01:24:08.000 --> 01:24:14.000
при этом все эти шаги периодически повторять – это правильный процесс работы по оптимизации расходов в облаке.

01:24:14.000 --> 01:24:19.000
Все необходимые ресурсы, возможности облака для нас предоставляет.

01:24:20.000 --> 01:24:23.000
Одним из моментов, которые следует отметить – это тегирование.

01:24:24.000 --> 01:24:32.000
Благодаря тегированию вы сможете ваши ресурсы логически подразделять для того, чтобы работать уже с меньшими группами,

01:24:33.000 --> 01:24:35.000
так как с меньшими группами работать легче.

01:24:36.000 --> 01:24:42.000
Приведу пример. Если вы будете тегировать все ваши ресурсы с ID-шником вашего департамента,

01:24:42.000 --> 01:24:50.000
то вы будете знать, какому департаменту относятся те или иные проблемные ресурсы.

01:24:51.000 --> 01:24:55.000
Вы знаете, куда адресно обратиться для того, чтобы эту проблему устранить.

01:24:56.000 --> 01:25:04.000
Более того, помимо тегинга есть ряд интересных сервисов, которые позволяют вам управлять, оптимизировать ваши расходы.

01:25:04.000 --> 01:25:11.000
Вы всегда можете одним запросом Google найти эти ресурсы, почитать про них и начать их использовать.

01:25:14.000 --> 01:25:20.000
Мы с вами добрались до конца нашей третьей части, а также до конца нашей сегодняшней лекционной сессии.

01:25:21.000 --> 01:25:23.000
Давайте пройдемся по самым основным моментам.

01:25:24.000 --> 01:25:28.000
Мы разобрали, какие модели оплаты существуют для сервиса Amazon EC2.

01:25:29.000 --> 01:25:32.000
Это on-demand инстанции, reserved инстанции, spot,

01:25:32.000 --> 01:25:40.000
dedicated instances и dedicated host, а также scheduled reserved instances, которые на текущий момент недоступны.

01:25:41.000 --> 01:25:50.000
Мы также с вами узнали, что spot instances является наиболее выгодным вариантом в случае, если у нас определенный тип нагрузок.

01:25:51.000 --> 01:25:57.400
Spot instances могут быть прерваны с двухминутной нотификацией, то есть уведомлением о том, что через два дня вы можете получить

01:25:57.400 --> 01:26:02.400
скидку с 2 минуты, и этот инстанс будет отключен.

01:26:03.400 --> 01:26:09.400
Соответственно, вам нужно строить архитектуру таким образом, чтобы адекватно реагировать на вот эти отключения.

01:26:10.400 --> 01:26:14.400
При этом вы можете получить до 90% скидки, используя spot instances.

01:26:15.400 --> 01:26:23.400
Далее мы разобрали четыре направления, которые следует рассмотреть для оптимизации ваших затрат в облаке,

01:26:23.400 --> 01:26:31.400
связанных с сервисами Amazon EC2. Это right sizing, дальше это increasing elasticity, то есть использование, правильное,

01:26:32.400 --> 01:26:38.400
правильное использование автоскейлинга. Далее optimal pricing model, то есть выбрать ту модель, которая

01:26:39.400 --> 01:26:46.400
оптимально подходит под наши нагрузки. И четвертое – это оптимизация хранилища, то есть есть некоторые нюансы по работе

01:26:46.400 --> 01:26:55.400
с нашими хранилищами. Про сервисы хранения storage мы разберем и более подробно поговорим с вами

01:26:56.400 --> 01:27:02.400
на следующих наших лекционных занятиях. На этом мы подошли к концу сегодняшнего лекционного занятия.

01:27:03.400 --> 01:27:10.400
Мы подробнее разобрали сервис EC2, а именно посмотрели, какие шаги нужно предпринять для того, чтобы

01:27:10.400 --> 01:27:18.400
создать новый EC2 instance. Далее рассмотрели, какие модели оплаты существуют, а также познакомились с теми

01:27:19.400 --> 01:27:25.400
направлениями работ, которые позволяют нам оптимизировать наши расходы на сервис EC2.

01:27:25.400 --> 01:27:39.400
На этом мы завершаем нашу сегодняшнюю сессию. Спасибо за внимание. Увидимся с вами на следующих наших активностях.