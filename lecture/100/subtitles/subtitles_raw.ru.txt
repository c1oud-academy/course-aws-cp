 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередной лекции. Тема сегодняшней лекции это хранение, то есть storage. Итак, давайте начнем. Сегодняшняя лекция состоит из четырех секций. Мы разберем четыре самые основные сервисы, связанные с хранением. Это Elastic Block Store, то есть жесткий диск, который мы привязываем к EC2 Instance. Далее это сервис S3 для объектного хранения. После чего разберем EFS, Elastic File System, сервис, который предоставляет нам жесткие диски с общим доступом для нескольких EC2 Instance. И самым последним разберем S3 Glacier, это объектное хранение, объектное холодное хранение. Есть определенные use-кейсы, когда нам необходим этот вариант IT ресурса. Итак, мы с вами начинаем с Elastic Block Store. Чаще всего вы будете видеть этот сервис как Amazon EBS в сокращенном варианте. Итак, что же такое Amazon EBS? Это постоянное блочное хранение, то есть жесткие диски, которые вы подключаете к вашим EC2 Instance. Под постоянным имеется в виду при отключении вашего Instance, данные на жестких дисках, они сохраняются. Также жесткие диски EBS это то место, куда устанавливается операционная система на вашем EC2 Instance. Для высокой доступности Amazon EBS реплицирует ваши данные в несколько разных ресурсах, прозрачным для вас в рамках текущей availability зоны. Таким образом, поломка жесткого диска, она для вас прозрачна и Amazon берет на себя поддержку и гарантию того, что ваши EBS volume доступны и с ними ничего не происходит. Также здесь следует отметить, что с EBS вы можете выделить необходимое количество гигабайтов для ваших жестких дисков и по необходимости увеличивать либо уменьшать для того, чтобы оплачивать только за то, что вы используете. Есть два типа хранения. Мы с вами говорим, что EBS это блочное хранилище, а S3, например, это объектное хранилище. Чем же оно отличается? Давайте рассмотрим на примере изменения одного символа в файле с размером 1 гигабайт. То есть вы представляете, какой объем символов внутри этого одного файла и что же происходит, когда вы меняете только один символ. Когда мы говорим про блочное хранилище, вы изменяете конкретное место в этом жестком диске, только необходимую ячейку памяти. Когда мы говорим про объектное хранилище, то для того, чтобы обновить один символ внутри этого большого файла, нам необходимо перезаписать весь этот файл. Таким образом, вы видите, что мы не можем частично менять файлы при объектном хранении, что увеличивает, требует большую пропускную способность, нежели блочное хранение, когда изменение файлов, вне зависимости от его размера, требует внесения изменения только в определенном месте. А вся остальная часть большого файла, она может оставаться нетронутой. И здесь возникают различного рода нюансы. Когда мы говорим про блочное хранилище, то мы работаем с... можем работать с меньшим пропускным каналом в сети. Когда мы говорим про объектное хранилище, то может потребуется более широкий канал. Но с другой стороны, цена за хранение гигабайта данных в блочном хранении может быть на порядок дороже, чем объектное хранилище. Таким образом, в зависимости от вашей бизнес-задачи, вы будете выбирать... принципиально для себя вы работаете с блочным хранилищем, либо с объектом хранилищем. Еще один важный момент, который следует отметить, это то, что при частой перезаписи лишь небольшое части ваших файлов, возможно, говорит о том, что следует использовать блочное хранилище. Когда вы работаете с небольшими маленькими, например, JSON файлами, когда большая часть этого файла меняется, либо размер этих файлов не такой большой, то объектное хранилище может быть для вас лучшим вариантом. Давайте пройдемся по основным преимуществам использования сервиса Amazon EBS. Это то, что этот сервис предоставляет вам возможность индивидуально создавать жесткие диски для ваших EC2-инстанцев. Также мы говорим, что это хранение блочного уровня, и все жесткие диски прозрачно для вас реплицируются внутри той же availability-зоны. Таким образом, поломка физически одного жесткого диска, она для вас прозрачна, так как происходит автоматическое переключение на копию внутри той же availability-зоны, и ваш EC2-инстанц продолжает работать без перебоев. Также есть возможность делать некие снапшоты, то есть образы ваших жестких дисков, которые сохраняются в сервисе Amazon S3. С этих снапшотов вы далее можете восстанавливать ваши жесткие диски и поднимать новые EC2-инстанцы. Существует четыре типа жестких дисков внутри сервиса Amazon EBS. Подразделяются на две категории. Первые это SSD, другие это HDD. SSD мы все знаем быстрее. Внутри SSD делится тоже на два вида. Это general purpose, то есть общего назначения, то есть процентов 90-95 случаев general purpose для вас подходящий вариант. Когда мы говорим provisioned IOPS, это та опция, тот тип жестких дисков, который предоставляет вам больший канал IOPS, то есть операции записи и чтения на ваши жесткие диски. Если ваше приложение активно записывает и читается с жестких дисков, то provisioned IOPS может быть опцией для вас. Здесь следует отметить, что provisioned IOPS намного дороже стоит, чем general purpose, поэтому рекомендуется всегда начинать с general purpose. Если вам нужно больше IOPS, больше производительность жестких дисков, то в этом случае есть смысл рассматривать provisioned IOPS. Когда мы говорим про жесткие диски для установки операционной системы, то это всегда SSD, либо general purpose, либо provisioned IOPS. Таким образом, вторая группа, то есть HDD, жесткие диски предыдущего поколения, они не могут быть использованы для установки операционной системы. Вы можете использовать эти жесткие диски как дополнительное хранилище, дополнительное жесткие диски для хранения, для дешевого хранения некоторых данных. Есть два варианта, это root put optimized и cold. Когда мы говорим root put optimized, это оптимальный вариант в рамках этой группы HDD, то есть hard disk drives, и подходит в большинстве случаев для стандартных нагрузок, опять же для целей хранения. Когда мы говорим про холодное хранение, то есть если у вас приложения нетребовательны к операциям чтения и записи на жесткие диски, то для того, чтобы сократить расходы на конкретный сервис VBS, то рекомендуется рассмотреть опцию cold, которая по производительности чуть хуже, но при этом по стоимости также стоит дешевле. Актуальные цены вы всегда можете посмотреть на официальной странице сервиса во вкладке pricing. Давайте теперь подробнее рассмотрим, какие же есть use cases для каждого типа жестких дисков EBS. Когда мы говорим general purpose, из того, что можно дополнительно отметить, это как использование виртуал десктопс, это когда у вас есть удаленный рабочий стол и ваши сотрудники работают там. Еще один пример, который стоит упомянуть, general purpose также следует применять для ваших development и тестовых сред. То есть обычно, когда это не продакшн среда, то нагрузки там минимальные, обычно эти нагрузки искусственные, поэтому для целей тестирования и разработки дешевый вариант, который мы можем использовать для установки операционной системы, рекомендуется применять этот general purpose. Далее, если мы говорим про Visioned IOPS, это те приложения, которые сильно зависят от операции чтения и записи на ваши жесткие диски. Как пример, может быть, у вас на вашем EC2 установлена база данных, то есть вы решили по тем или иным причинам не использовать Service Managed Database RDS, а решили самостоятельно установить на виртуальный сервер вашу базу данных и там работать. В этом случае база данных – это тот пример, когда операции чтения и записи выше среднего. Таким образом, Provisioned IOPS больше подходит в этом случае. Если мы говорим про следующий третий вид, это throughput optimized, как примеры могут быть работа с Big Data, работа с Data Warehouse, то есть склад данных, обработка логов и так далее. Если мы говорим про cold, это все те опции, когда нам необходимо сократить расходы на хранение, либо у нас достаточно большой объем данных, которые не часто запрашиваются. В этом случае cold – опция, тип жестких дисков наиболее подходит. Давайте отметим еще парочку преимуществ использования сервиса Amazon EBS. Касательно снапшотов. Мы говорили, что снапшот – это некая сохраненная копия вашего жесткого диска и оно привязывается к определенному времени. Можно настроить ежедневные, ежедневные, либо более сложный график создания снапшотов ваших жестких дисков. И когда создается самый первый снапшот, то оно называется baseline snapshot, то есть он сохраняет полностью весь жесткий диск. Так как мы работаем с блочным хранилищем, то у нас есть возможность все следующие снапшоты не хранить всю целую копию жесткого диска, а лишь сохранить изменения с последнего снапшота. Таким образом, размер ваших снапшотов, представим, что у вас есть 10 снапшотов на каждый день за последние 10 дней. И это не говорит о том, что при размере, например, 10 гигабайтов вашего жесткого диска, то все 10 снапшотов будут весить 100 гигабайтов, то есть 10 умноженные на 10. А наоборот, первый будет весить только 10 гигабайтов, а все последующие будут хранить лишь изменения. Если мы говорим о том, что ваш жесткий диск не менялся сильно, то может получиться так, что все оставшиеся ваши снапшоты, все оставшиеся 9 снапшотов могут весить меньше 1 гигабайта. Если мы говорим про шифрование, то оно также доступно. Вы можете подключить сервис KMS для шифрования ваших жестких дисков, и доступно это в рамках сервиса EBS без дополнительной платы. Вы лишь оплачиваете отдельно за сервис KMS за использование и создание ключей шифрования. Если мы говорим про эластичность, то здесь следует отметить, что размер вашего жесткого диска может динамически меняться. И более того, вы можете даже не останавливать ваш инстанс, а динамически увеличить размер вашего жесткого диска. Также есть возможность менять тип жестких дисков динамически. То есть нет необходимости вам заниматься копированием от одного жесткого диска на другой жесткий диск другого типа, а лишь достаточно вызвать соответствующую команду по изменению типа, и все необходимые действия будут произведены на стороне AWS. Из чего складывается оплата за сервис EBS? Оно состоит из четырех составляющих. Первое это объемы. То есть вы оплачиваете за гигабайт ежемесячно суммарно за суммарное количество гигабайтов на всех ваших жестких дисков. Далее это IOPs. То есть если мы говорим про General Purpose SSD, то цена за IOPs она включена в оплату за Volume. Если мы говорим про Magnetic, вы дополнительно оплачиваете за каждый request input output операции. Если мы говорим про Visioned IOPs, то вы оплачиваете дополнительно за объем IOPs, который вы для себя указали. Следующая категория это снапшоты. То есть снапшоты это копия ваших жестких дисков, которая хранится в сервисе Amazon S3. Таким образом вы будете оплачивать по тарифам S3 сумму в зависимости от объемов гигабайтов ваших снапшотов суммарно. Поэтому когда мы говорим про снапшоты, для экономии оплаты за хранение внутри S3 рекомендуется правильно настроить расписание создания снапшотов. То есть как пример вам нет необходимости создавать ежедневные снапшоты и хранить все снапшоты за последний год. А достаточно хранить ежедневные снапшоты за последнюю неделю. Далее от недели до одного месяца можно хранить снапшоты еженедельные. То есть еще три снапшота добавляются. Далее все те снапшоты, которые старше одного месяца до одного года можно хранить ежемесячно. Добавляется еще 11 снапшотов. Таким образом можно сэкономить на хранение ваших снапшотов, но при этом иметь достаточную гибкость в случае если вам нужно восстановить предыдущее состояние ваших снапшотов, ваших жестких дисков. И последнее это data transfer. То есть мы с вами помним, что мы за трансфер данных в рамках одного региона ничего не оплачиваем. Мы не оплачиваем за inbound traffic, то есть когда мы данные загружаем внутри AWS, но при этом если мы копируем наши жесткие EBS volume, жесткие диски с одного региона на другой, то здесь необходимо оплатить стандартную оплату за data transfer между двумя регионами. Далее уже скопированные жесткие диски на втором регионе уже будут оплачиваться по стандартным тарифам того региона. На этом мы подошли к концу первой секции. Давайте пройдемся по самым основным моментам сервиса Amazon EBS. Это сервис, который предоставляет вам блочное хранилище. Простыми словами это жесткие диски, которые вы подключаете к вашим Amazon EC2 Instance. На этих жестких дисках устанавливается операционная система, а также вы можете подключать дополнительные жесткие диски для целей хранения. Выделяют две группы типов жестких дисков, это HDD, которые медленные, но дешевле. И второй вариант это SSD, более продвинутый вариант, работает быстрее, но при этом стоит дороже. Здесь важный момент, вы для установки операционной системы можете выбрать только тип SSD. Все ваши жесткие диски прозрачно для вас реплицируются внутри той же availability зоны. Таким образом физическая поломка конкретного жесткого диска не отражается на работе вашего EC2 Instance, вашего приложения, так как происходит автоматическое переключение на реплику, то есть копию жесткого диска. Можно настроить шифрование, это происходит также прозрачно, нет никаких сложностей, подключается сервис KMS и они работают достаточно нативно совместно. Все ваши волыму, они могут быть динамически увеличены либо уменьшены в размере, а также вы с легкостью можете менять тип ваших жестких дисков. Когда мы говорим про backup ваших жестких дисков, то мы создаем снапшоты. Snapshot это копия ваших жестких дисков, хранящихся внутри сервиса Amazon S3. Мы переходим с вами ко второй части нашей лекции и поговорим про сервис Amazon Simple Storage Service. Чаще вы будете видеть название этого сервиса в сокращенном варианте Amazon S3. Amazon S3 это сервис, который предоставляет объектное хранилище для ваших данных. Мы с вами ранее упоминали, что при изменении даже одного символа внутри файла, для того чтобы обновить этот файл внутри объектного хранилища, необходимо его полностью перезагрузить. В зависимости от вашей бизнес задачи, вам нужно будет использовать либо блочное, либо объектное хранилище. Все ваши данные, которые хранятся в рамках S3, они организованы по бакетам. То есть, вы создаете некий бакет, внутри бакета уже заливаете ваши объекты. Вы можете создавать структуру из папок, оно на стороне AWS Management Console будет отображаться как структура папок, но на самом деле это хранение файлов с ключом, с путем до этого файла, который содержит в себе слеши. Таким образом, внутри под капотом это все происходит не как папки и файлы, а по-другому, но при этом отображение для удобства, для легкости восприятия и удобной работы вы можете видеть и работать как файлы и папки. Давайте пройдемся по основным преимуществам сервиса Amazon S3. Мы с вами говорили, что Amazon S3 это объектное хранилище, это сервис, который предоставляет дюрабилити, то есть надежность хранения ваших данных 99.99, либо по-другому говорят 11.9. То есть практически 100% надежность хранения ваших данных и гарантирует вам, что вы свои данные не потеряете. Как это реализовано? Это реализовано следующим образом, в рамках сервиса S3 происходит прозрачная операция по репликации нескольких копиях всех объектов, которые вы храните внутри этого сервиса. Таким образом, когда происходит техническая поломка железа, которая хранит именно определенный ваш объект, то для последующего работы и в доступном состоянии для вас остаются реплики этого объекта. Далее происходит автоматическое понимание, что на стороне AWS под капотом что-то произошло с этим железом и все объекты, которые хранились в этом жестком диске, они еще раз реплицируются уже в другие жесткие диски. Таким образом, этот процесс автоматизирован на стороне AWS и благодаря вот этому процессу репликации достигается 99.99% надежности хранения ваших данных. Если мы говорим про размер объектов, которые вы можете хранить, то максимальный размер, который вы можете сохранить внутри S3 может достигать 5 ТБ для одного объекта. Таким образом, вы внутри S3 можете хранить снапшоты ваших баз данных как объект. Amazon S3 является managed сервисом. Таким образом, вы не управляете никакой инфраструктурой, не делаете никаких настроек, а лишь вам предоставляется сервис в готовом виде и вы загружаете любое, фактически неограниченное количество объектов внутри этого сервиса. И все те процессы, которые должны быть выполнены для поддержания хранения ваших данных, они обеспечиваются AWS. Если мы говорим про шифрование, то можно настроить для сервиса S3 хранение как в покое, то есть at rest, также и in transit, то есть во время передачи данных. Другой интересный фичей S3 является настройка так называемых event notifications. То есть вы можете для определенных ивентов, связанных с сервисом S3, например это может быть загрузка нового файла, либо удаление файла, по определенному пути навесить на нее триггер и по триггеру либо настроить уведомления через сервис SNS, либо загрузку этого ивента в SQS для последующей обработки. Также вы можете передать это лямде для того, чтобы лямда напрямую получил этот ивент и произвела некоторые действия. Когда мы работаем сервисом S3, мы храним различного рода данные. Это в свою очередь говорит о том, что частота обращения, частота работы с этими данными, они могут сильно различаться. Некоторые данные вы будете запрашивать и возможно изменять, либо только читать каждый день. Некоторые данные вы возможно будете запрашивать раз в несколько месяцев, а некоторые данные, которые за всю жизнь существования этих данных могут быть не запрошены ни один раз. Есть такие данные, есть такие use case, как самый явный пример это по некоторым регуляторным требованиям, определенным положениям в зарегулированных сферах таких как финансовая сфера, медицина, государственный сектор. Это те направления, те сферы, где по некоторым регуляторным требованиям вам необходимо несколько лет, до 5-10 лет необходимо хранить эти данные, так как они могут быть востребованы. Если будут востребованы, то компания обязана предоставить некоторую информацию. Таким образом, ввиду того, что такие кейсы в целях регуляторных могут не возникнуть, то эти данные могут по большей своей части хранятся несколько лет, а потом по истечению необходимого минимального времени хранения могут быть успешно удалены. Давайте пройдемся теперь по типам хранения внутри S3, которые были специально разработаны для того, чтобы лучше подходить под ваши бизнес-задачи и при этом иметь возможность экономить более cost-effective решение сделать с помощью сервиса S3. Самый первый и самый популярный тип хранения, класс хранения это Amazon S3 Standard. Это тот класс хранения, который подходит для 90% плюс случаев и это тот класс, когда вы можете надежно, то есть 11 девяток хранить ваши данные, вы можете в режиме онлайн запрашивать ваши данные и соответственно для того, чтобы это все обеспечить, необходимы те или иные ресурсы, а вот все это оно формирует итоговую цену этого класса. Если мы хотим сделать наши расходы меньше, то мы можем рассмотреть следующий класс хранения, называется Amazon S3 Intelligent Tiering. Идея этого класса в том, что Amazon за вас анализирует, как часто происходит работа, обращение, перезапись каждого объекта внутри всех ваших бакетов, там где вы подключите этот класс и по своей внутренней логике переносит ваши объекты на уровне каждого объекта от одного класса хранения на другой, для того, чтобы сэкономить ваши расходы на сервис S3, при этом никак не меняя эффективность работы сервиса S3. То есть если ваши данные часто запрашиваются, должны быть доступны онлайн по требованию, то соответственно Intelligent Tiering ни в коем случае не переведет эти объекты в класс, который не может сразу извлечь ваши объекты. И обратный случай, когда он видит, что ваши объекты совсем не запрашиваются, то почему бы эти данные не перенести в класс хранения дешевле, но который может быть недоступен сразу или может быть в класс хранения, который менее надежен, но дешевле. Если мы говорим про следующий класс, это Standard Infrequent Access. Этот класс хранения отличается от стандартного тем, что здесь вы можете хранить дешевле ваши объекты, которые вы не часто запрашиваете. И когда мы говорим про стандартный класс, вы оплачиваете только за суммарное количество гигабайтов в месяц. Когда мы говорим Standard Infrequent Access, вы оплачиваете за суммарное количество гигабайтов данных, которых вы храните, при этом тариф за каждый гигабайт он ниже, то есть дешевле, но при этом добавляется еще один компонент, который формирует итоговую цену, это оплата за Retrieval fee, то есть за извлеченное количество гигабайтов, за каждый гигабайт, вы отдельно оплачиваете некоторую сумму. Таким образом, если вы положите ваши часто запрашиваемые данные в Infrequent Access, это будет очень невыгодно, вы будете переплачивать фактически ввиду того, что стоимость извлечения может быть больше стоимости хранения. И обратный случай, если у вас данные, которые вы не часто запрашиваете, то может получиться так, что за счет скидки за хранение и за счет того, что вы не так часто запрашиваете, итоговая сумма Standard Infrequent Access может быть выгоднее, чем Standard. Предыдущий класс хранения это One Zone Infrequent Access. Чем он отличается от предыдущих? Это тем, что ваши данные, они хранятся в рамках одной Availability зоны, тогда как предыдущие классы хранения Standard, Standard Infrequent Access и все другие, они хранятся как минимум в трех Availability зонах. За счет этого достигается надежность 11 девяток. Когда мы говорим про One Zone Infrequent Access, то это одна Availability зона, соответственно там не 11 девяток, а меньше. Этот класс хранения может быть идеальным вариантом, если вы храните данные, которые могут быть легко восстановлены, либо потеря которых некритична для вашего бизнеса. В этом случае вы можете хранить данные в одной Availability зоне, какая-то часть она может потеряться небольшая и при этом вы не так много, то есть намного меньше будете облачивать по сравнению с Standard класс хранения. Осталось еще два класса хранения, это Glacier. Это тот класс хранения, который позволяет вам надежно хранить данные, архивные данные, то есть те данные, которые вы скорее всего не будете запрашивать. Есть вероятность того, что вы эти данные запросите, но в большинстве случаев они так и останутся незапрошенными и вы лишь некоторый период данные должны хранить. S3 Glacier предоставляет самый дешевый тариф за гигабайт хранения данных, при этом вы не можете извлечь ваши данные сразу в режиме онлайн. Есть три опции как вы эти данные можете извлечь, это самый быстрый, который извлекает ваши данные в течение нескольких минут и самый медленный, для извлечения которых требуется несколько часов, но при этом понятно, что тот, который за минуту извлекает по тарифу стоит дороже, а тот, который за несколько часов будет извлекать ваши данные, он стоит дешевле. Но при этом помните, что когда мы работаем с Glacier и вы часто запрашиваете ваши данные, что неприемлемо для этого класса, то оплата за этот класс хранения может выйти дороже, чем стандартный класс хранения. Поэтому нужно знать какие данные, с какими данными вы работаете и соответственно настраивать life cycle policy, про который мы поговорим чуть попозже. И самый последний класс хранения это Glacier Deep Archive. Это те данные, которые вы можете хранить максимально дешево, это те данные, которые по регуляторным требованиям должны храниться несколько лет и обычно сюда относят данные, к которым вы обращаетесь возможно один или два раза в течение года. Эти данные идеально подходят для хранения в Glacier Deep Archive. Если мы говорим про извлечение данных, то данные обычно извлекаются не раньше, чем 12 часов, то есть в течение 12 часов. Это нужно учитывать при работе с классами хранения Glacier и Glacier Deep Archive. Мы с вами двигаемся дальше. Повторю некоторые нюансы по работе с сервисом Amazon S3. Мы с вами сказали, что все наши данные организованы внутри бакетов и внутри бакетов вы создаете некое подобие структуры папок и файлов и храните ваши объекты. Бакеты, они именуются некоторым образом и вот это имя должно быть уникально для всего сервиса S3, глобально. То есть если представим, что в регионе US East One был создан бакет Ельжан Мауленов, то я не могу в другом регионе, например, EU West One, это европейский регион, не могу создать бакет с таким же именем, так как пул названий бакетов должен быть уникальный в рамках всего AWS глобально. Но есть нюанс касательно хранения. Когда мы создаем бакет, мы указываем, в каком регионе, какому региону будет относиться наш бакет. Это тот регион, где будут храниться ваши данные внутри этого бакета. То есть давайте приведу пример. Представим, что я создал бакет Ельжан Мауленов один в регионе Норс-Верженья. В этом случае все объекты, которые я буду туда заливать, они будут храниться на серверах, которые физически находятся в регионе Норс-Верженья. И также создал в AWS Management Console другой бакет, который называется Ельжан Мауленов два, но при этом как регион указал Токио. В этом случае все данные, которые все объекты, которые буду заливать в этот бакет, они будут храниться физически в рамках границ Токио. Здесь на слайде вы можете видеть пример двух вариантов ссылки до ваших объектов. То есть есть вариант bucket path style URL endpoint. Это когда у вас в начале идет стандартная часть, то есть s3.название региона.amazonaws.com. Дальше slash bucket name, slash и путь к вашему файлу. Есть другой вариант, это bucket virtual hosted style URL endpoint второй, когда название bucket name уже сидит в названии сайта. И через slash идет уже путь к вашему объекту. И тот и другой вариант рабочий и в зависимости от того, какой удобнее для вас вы выбираете. Если мы говорим касательно доступа к вашим объектам, то вы можете настроить на уровне бакета, а также на уровне каждого объекта внутри бакета соответствующие bucket policy, которые определяют кто, как может обращаться или какие операции может произведить на бакете либо на определенном объекте. Когда мы говорим про сервис Amazon S3, бакет у нас хранится в рамках одного региона. Также по мере необходимости вы можете загрузить очень маленький файл в один бакет и по необходимости этот бакет может увеличен на несколько терабайтов. Нет никаких ограничений и вы фактически будете оплачивать только за то, что вы используете. Также важный момент это то, что к S3 вы можете обращаться со всех возможных вариантов, а именно через AWS Management Console, через Command Line Interface, то есть Amazon CLI, а также AWS SDK, то есть Software Development Kit. Если мы говорим про use case сервиса Amazon S3, то мы можем использовать S3 для того, чтобы хранить некоторые файлы, media файлы, которые используют ваше приложение. Также мы можем хостить статический веб-сайт внутри S3, есть специальная фича для этого. S3 может выступать как местом хранения ваших бэкапов, снапшотов, также S3 может использоваться для disaster recovery, для хранения определенной части вашей инфраструктуры. Если вы работаете с большими данными, то соответственно S3 тоже может быть тем местом, домом ваших данных, где в связке с другими сервисами вы будете не только хранить эти данные, но и также получите возможность работать, обрабатывать, изменять и проводить некоторый анализ аналитику на основе этих данных. Когда мы говорим про прайсинг в рамках сервиса S3, то мы платим за количество гигабайтов, которые мы храним. Мы платим за data transfer, то есть трансфер данных от одного региона до другого региона, а также мы оплачиваем за количество запросов к сервису S3 для разного вида действий, то есть это может быть пул, копии, пост, лист либо get. Если говорить про то, что мы не оплачиваем, если данные передвигаются в рамках S3, за это оплата не идет. Также если мы передаем из S3 данные в CloudForm либо в наше EC2 инстанции в рамках того же региона, то также мы не должны ничего оплачивать PWS. На этом мы подошли к концу секции 2. Посмотрели подробно сервис Amazon S3, давайте пройдемся по самым основным моментам. Режимируя мы говорим, что Amazon S3 это managed service для объектного хранения данных внутри облака AWS. Мы можем хранить неограниченное количество объектов, объекты наши хранятся внутри бакетов, мы оплачиваем только за то, что мы используем, то есть за тот объем данных, которые мы храним внутри сервиса S3. Мы можем обращаться в любое время с любого места, используя все возможные варианты для обращения, для доступа к нашим объектам внутри бакетов. Также есть достаточно широкий набор настроек безопасности для того, чтобы ваши данные были зашифрованы не только в состоянии хранения, но и в состоянии передачи. Мы с вами переходим к третьей части нашей лекции и к третьему сервису хранения. Это Amazon Elastic File System, либо чаще вы будете его встречать как Amazon EFS. Это тот сервис, который предоставляет вам жесткие диски, которые вы можете расшарить между несколькими EC2-инстанциями. Таким образом будет общий доступ, общее хранилище для пула ваших EC2-инстанций. Для некоторых бизнес задач это очень подходящий сервис. Здесь также мы оплачиваем только за то, что мы используем, то есть в зависимости от объема данных, которые находятся, при увеличении, соответственно, мы оплачиваем больше, при уменьшении наши расходы на сервис EFS уменьшаются. Если же мы говорим про основные фичи сервиса Amazon EFS, то это тот сервис, который предоставляет нам файловое хранилище внутри облака AWS. Это файловое хранилище, файловая система, она может быть масштабирована до размера терабайты, петабайты, при этом предоставлять высокую доступность. Это тот сервис, который предоставляет вам общее место, одно место, которое может быть доступно из нескольких EC2-инстанцев. Размер жестких дисков, оно увеличивается и уменьшается, вы, соответственно, оплачиваете за тот объем на текущий момент, который вы используете. Есть поддержка NFC, то есть Network File System версии 4.0 и 4.1. А также следует отметить, что EFS поддерживает все операционные системы, базирующиеся на Linux. Здесь вы можете видеть пример архитектуры с использованием сервиса Amazon EFS. У нас есть VPC, у нас есть ресурсы в трех availability зонах, есть EC2-инстанцы в наших private либо public сабнетах, и, соответственно, у наших EC2-инстанцев есть Network Interface. Мы этот Elastic File System подключаем, монтируем к Network Interface, и, соответственно, у EC2-инстанцев появляется доступ на всех в трех availability зонах к одной файловой системе, общей для всех этих инстанцев в рамках всего VPC. На этом мы подошли к концу третьей секции нашей лекции, подробнее рассмотрели сервис Amazon EFS. Давайте остановимся на самых основных моментах. Amazon EFS – это тот сервис, который предоставляет вам файловую систему, которая может быть расшарена на несколько EC2-инстанцев. То есть это общее место, и в зависимости от вашей бизнес-одачи вам может потребуется подобные IT-ресурсы. Amazon EFS, с Amazon EFS вы оплачиваете только за тот объем информации, который вы храните в вашем EFS-жестком диске. То есть по модели Pay as you go. EFS является полностью managed-сервисом, таким образом вам нет необходимости поддерживать все то, что происходит под капотом, а лишь вы получаете готовый сервис, который можете использовать и достаточно быстро, буквально за пару кликов настраивать и интегрировать вашу IT-инфраструктуру. Мы с вами добрались до самой последней секции в рамках нашей лекции и подробнее поговорим про сервис Amazon S3 Glacier. Про него мы поговорили во второй части, здесь рассмотрим некоторые нюансы. Давайте остановимся с вами на основных фичах сервиса Amazon S3 Glacier. Это тот сервис, который используется для архивирования ваших данных. Оно также как и другие классы хранения сервиса S3, предоставляет высокую надежность, то есть 11 девяток. Glacier это опция хранения данных самым дешевым тарифом. Когда мы говорим Glacier, то мы должны быть готовы, что данные извлекаются не сразу. То есть есть три опции, это стандартные, bulk и expedited. Когда мы говорим expedited, это ускоренный вариант, данные могут быть извлечены в течение одной-пяти минуты. Это та опция, которая самая дорогая. Дальше идет стандартная опция, когда мы данные извлекаем в течение трех-пяти часов и стоит соответственно среднее. И самая дешевая опция, это когда мы используем опцию bulk, когда данные извлекаются от пяти до двенадцати часов. Если говорить про безопасность, то Glacier поддерживает SSL, TLS. Также что следует отметить, это vault lock feature. Для того, чтобы ее объяснить, давайте введем некоторые термины. Есть понятие archive, то есть архив. Это любой объект, это может быть медиафайл, текстовый файл. Тот объект, который вы хотите архивировать. Vault это набор архивов, которые вы храните вместе. Представьте, что vault это некий аналог zip архива на локальном нашем компьютере. И также есть такое понятие, как vault access policy. Это как раз таки vault lock feature. Идея в том, что вы можете привязать к вашему vault и access policy, который определяет, кто по каким условиям может или не может обратиться к объектам, которые хранятся внутри вашего vault. Vault дословно переводится как погреб либо подвал. Давайте подробнее остановимся о самых основных use case сервиса Amazon S3 Glacier. Первый это media asset archiving. Это когда мы храним некоторые данные, как видео, некоторые тексты информации, то есть какие-то новости, надежно и в большом объеме. Далее это healthcare information archiving. То есть это хранение больших объемов информации, которые из сферы медицины. То есть это информация о проведенных исследованиях, это информация о медицинской истории пациентов и так далее. Также здесь сюда могут относиться медицинские анализы, различные снимки и так далее, которые тоже оцифрованные и должны где-то храниться. Другой вариант это regulatory and compliance archiving. Это то, что мы ранее говорили. То есть в зависимости от сферы есть определенные требования по закону, такие как финансы, здравоохранение, государственный сектор, который обязан охранить данные в течение определенного периода. Эти данные должны храниться, так как они могут быть востребованы клиентами, пациентами и компания ведут некоторых законов положений, должна обязана предоставить эти данные. Соответственно она их удалить не может, но ему достаточно хранить определенный период, обычно несколько лет, от трех лет до десяти лет, после чего данные могут быть удалены. Еще один пример это хранение научных данных. То есть во время проведения некоторых наукоемких расчетов генерируется большой объем искусственно либо собирается большой объем данных для дальнейшего анализа. И для того, чтобы выгодно хранить эти данные, так чтобы они были и доступны, и при этом недорого хранились, то можно воспользоваться сервисом Estrig Glacier. Другой момент это то, что по старинке данные архивы, они хранятся на магнитных носителях, то есть в HDD дисках, и как только вы загружаете сюда данные, жесткие диски отключаются от системы и хранятся где-то там на полочке. Это не очень надежно, потому что жесткие диски они в виду конструкции своей могут размагнитиваться и соответственно данные теряются. Да, можно хранить данные в рейт-массивах, либо как-то попроще, реплицировать, хранить несколько копий, но сам процесс хранения, понимания, где какие данные лежат, он достаточно может быть трудоемким, если это большие объемы данных, и Estrig Glacier выступает как выгодный аналог хранения данных в облаке, при этом вот эта опция архивирования ваших данных предоставляется как готовый сервис. Давайте теперь подробнее поговорим, что же такое Lifecycle Policies, на нее мы ранее ссылались на предыдущих слайдах. Это та опция, которая позволяет вам настроить жизненный цикл ваших данных внутри Estrig. Также мы используем наш Lifecycle Policies, если по тем или иным причинам Intelligent Tiering для нас не подходит. Итак, представим, что у нас есть некоторый сайт, на этом сайте мы публикуем видео-контент, и мы знаем, что в течение месяца после публикации видеоматериала, в течение месяца она активно просматривается. Таким образом, наиболее оптимальный вариант класс хранения файлов первые 30 дней жизни это стандартный класс хранения. Далее, мы собираем некоторую статистику, анализируем, и мы знаем, что через 30 дней наш видеоматериал, так как уже был просмотрен большей части нашей аудитории, оно редко просматривается. Таким образом, мы можем сэкономить расходы на хранение нашей видео-файлы и перенести через 30 дней на класс хранения Infrequent Access. Далее, мы с вами знаем, что через 60 дней мы не храним наш контент на нашем сайте, а через 60 дней его удаляем по некоторым причинам, и нам нужно удалить эти файлы. Но мы можем эти данные под запросу выдать. В этом случае, нам через 60 дней, мы можем настроить перенос наших mp4-файлов с Infrequent Access класса хранения на S3 Glacier, когда мы данные сразу отдать не можем, но достаточно дешево можем хранить. Эти данные видео-контент хранится в течение года, и если кто-то запрашивает, то мы можем этот контент выдать. Далее мы говорим, что через год мы можем смело удалять наш видео-контент, ввиду того, что он становится неактуальным. Никто его смотреть не будет, и, соответственно, нет смысла платить за его хранение и обслуживание. И мы можем настроить Lifecycle Policy таким образом, что через год она автоматически удаляется. Таким образом, мы видим, что мы можем настроить Lifecycle Policy, то есть некоторый шаблон, что происходит с объектом после определенного количества дней с момента загрузки, и она автоматически применяется ко всем объектам на уровне этого объекта. То есть объект мы загрузили сегодня, и через 30 дней она переходит там In Frequent Access. Дальше, если мы говорим, что мы через 3 дня загружаем новый объект, то для него отчет начинается с момента его загрузки. И опять же через 30 дней происходит переход на другой класс хранения. Давайте с вами разберем сравнительную таблицу между стандартными классами S3, а также классами хранения S3 Glacier. Чем же они отличаются? Основные отличия это average latency, то есть как быстро вы получаете файл. Если мы говорим про стандартные классы S3, то это миллисекунды, то есть мы получаем файл сразу. Если мы говорим про классы хранения Glacier, это Glacier Archive, то здесь это минуты и часы. То есть мы файлы не сможем получить сразу, это не в онлайне, поэтому нужно планировать у себя дополнительно, что файлы вы получите через какое-то время. Если мы говорим про максимальный размер файла, который можем хранить, то есть объекта для стандартных классов хранения S3 это 5 ТБ максимум, а для Glacier мы уже можем сохранить объект до 40 ТБ. Если мы говорим про оплату на хранение за каждый гигабайт ежемесячно, то стандартные классы хранения относительно дорого стоят, а Glacier намного дешевле. И обратный случай, когда мы говорим про retrieval pricing, то есть цена извлечения данных, то для стандартных классов S3 где-то мы не оплачиваем даже за retrieval, где-то мы оплачиваем небольшие суммы, небольшой тариф, в случае когда мы говорим про извлечение из Glacier, то это стоит дороже. Поэтому нужно знать подробно информацию о своих данных для того, чтобы расположить в правильном классе хранения. На этом мы добрались до самого конца четвертой секции, и давайте пройдемся по самым основным моментам, связанных с сервисом Amazon S3 Glacier. Это тот сервис, который позволяет нам архивировать и хранить дешево наши данные в облаке. Этот сервис, так же как и Amazon S3, предоставляет достаточно высокую надежность хранения, то есть это 9, 11 девяток, то есть это 99,99% того, что данные не потеряются. Это гарантия. Так же важно отметить, что цена за хранение Glacier намного меньше и выгоднее по сравнению со стандартными классами хранения S3. Но при этом чем же кардинально отличается, это то, что при стандартных классах S3 мы извлекаем данные сразу онлайн, а когда мы говорим про классы хранения Glacier, это Glacier и Glacier Archive, то данные извлекаются в течение минут или нескольких часов, то есть до 12 часов может занимать время извлечения ваших данных с валтов. Поэтому этот момент нужно учитывать. На этом мы добрались до самого конца нашей лекции, рассмотрели все четыре сервиса, связанных с хранением. Буквально пару основных моментов. Это то, что S3 это объектное хранилище, у нас есть EBS для блочного хранения данных, обычно мы используем связки с EC2-инстанциями, далее есть EFS, если нам необходимо для нескольких EC2-инстанций предоставить общую файловую систему и есть у нас S3 Glacier, который мы дополнительно отдельно рассмотрели, это два отдельных класса хранения Glacier и Glacier Archive, которые позволяют нам выгодно хранить наши архивные данные. На этом сайде вы видите возможные полезные ссылки для вас, для дополнительного изучения. На этом мы заканчиваем нашу лекцию, я надеюсь вы получили более полное представление о основных сервисах хранения, если есть вопросы обязательно задавайте и увидимся с вами на следующих наших активностях.
