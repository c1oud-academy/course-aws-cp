 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередные сессии разбора лабораторной работы. Тема лабораторной работы – это сервис Amazon EBS. Окей, давайте начнем. Итак, мы будем продолжать с основной страницы лабораторной работы. Ожидается, что вы уже инициализировали ваш временный WS-аккаунт. И сейчас достаточно нажать на кнопку AWS, чтобы перейти в AWS Management Console. В верхней правой части AWS Management Console вы видите, что был создан временный аккаунт с соответствующим пользователем. Давайте начнем выполнять задание лабораторной работы. Первым делом нам необходимо перейти в сервис EC2. Для этого в строке поиска сервисов начнем вводить EC2 и в выборке самая первая ссылка будет ссылка на сервис EC2. Как только мы перейдем на сервис EC2, в левом навигационном меню необходимо выбрать пункт меню Instances для того, чтобы отобразить список существующих инстенсов на нашем AWS-аккаунте. Если этот список пустой, обратите внимание, в каком регионе вы сейчас находитесь. Регион можно увидеть в верхней правой части страницы AWS Management Console. Необходимо, чтобы регион был в Норс-Вирджинии. В списке инстенсов вы помимо прочих видите инстенс с названием LAP. Нам необходимо запомнить, что этот инстенс находится в availability-зоне US-East1A. Мы с вами двигаемся дальше. Теперь нам необходимо в левом навигационном меню выбрать пункт volumes. В этом случае отобразится список всех существующих AWS volumes на нашем аккаунте. Давайте создадим новый volume. В настройках нам необходимо выбрать тип volume, как GP2, это General Purpose SSD. Далее размер, давайте выберем 1 ГБ, для учебных целей этого более чем достаточно. Как availability-зону нам необходимо выбрать ту availability-зону, где находится наш инстенс с названием LAP. В нашем случае это US-East1A. Если мы прокрутим страницу чуть ниже, мы также можем ввести теги. Давайте создадим тег с ключом name и значением my volume. Нажмем на кнопку Create Volume. Вы увидите, что в списке volumes отобразится новый с названием my volume, соответствующим размером. Если мы проскроллим этот список чуть направо, мы увидим volume state, то есть состояние нашего volume. В самом начале во время создания он будет в состоянии creating, то есть создается и пока не доступно для работы. Давайте подождем пару минут, после чего нажмем на кнопку refresh, чтобы обновить список наших volumes. Через некоторое время мы увидим, что значение статуса поменялось с creating на available. Available это значит наш volume доступен для привязки к EC2-инстанцу и в данный момент не привязан. Если вы видите статус in use, это говорит о том, что данный volume привязан к EC2-инстанцу. Как только мы убедились, что наш новый созданный volume доступен для привязки к EC2-инстанцу, давайте попробуем это сделать. Для начала необходимо выбрать наш volume, далее вверху вправо нажать на кнопку actions и в выпадающем списке выбрать опцию attach volume. Вы перейдете на соответствующую страницу, где будет указан volume ID, это тот volume, который мы привязываем. Далее нам необходимо выбрать instance, в выпадающем меню будет отображен список наших инстанцев, также рядом будет название нашего инстанца. Нам нужно выбрать тот, который называется lab. Нам необходимо также сделать пометку и записать device name это slash dev slash sdf, то есть это системное название нашего инстанца, используя ее мы будем подключать наш жесткий диск к Linux EC2-инстанцу. Давайте проскроллим вниз и нажмем на кнопку attach volume. Как только вы на нее нажмете, вас перенаправит на страницу со списком жестких дисков и вы увидите, что в нашем жестком диске поменялось состояние с available на in use. Теперь нам необходимо попробовать подключиться к нашему EC2-инстанцу для того, чтобы завершить все необходимые настройки и сделать наш жесткий диск доступным для работы в этом инстанце. Для этого нам необходимо перейти на страницу с лабораторной работы в AWS Academy, в меню лабораторной работы нажать на кнопку details и далее в выпадающем окошке нажать на кнопку show. Вы увидите всплывающее окно с некоторыми деталями полезными касательно нашего нового созданного временного AWS аккаунта. В рамках этого AWS аккаунта для нас также был создан SSH ключ. Мы можем его скачать в двух различных вариантах. Это PEM ключ либо PPK. В зависимости от того, какая операционная система установлена на вашем компьютере, вы выбираете соответствующий вид private ключа. В случае, если у вас Windows операционная система, вам необходимо скачать PPK. В случае, если у вас Mac OS либо Linux, необходимо скачать PEM-формат private ключа. Также на странице с заданием лабораторной работы вы увидите ссылку на программу. Называется она Putty и эта программа является самой популярной программой для подключения по SSH к удаленному серверу. В нашем случае это EC2 Instance. Здесь есть ссылка, вам необходимо по ней перейти и скачать эту программу. Как только вы скачали программу Putty, вам нет необходимости ее устанавливать. После запуска программы вы увидите окно и можно с ней уже работать. Так выглядит основное окно программы. В левой части окна навигационное меню и в правой части соответственно значение настроек, которые можно вводить. Давайте перейдем в левое навигационное меню, в пункт Connection откроются соответствующие настройки и для параметра Seconds Between Keep Lives ввести значение 30. После чего необходимо вернуться обратно в первый пункт меню Session. Вы попадаете на самую основную страницу, вкладку. Здесь необходимо ввести хостней либо IP адрес для того, чтобы узнать наш IP адрес. Нам необходимо перейти в AWS Management консоли, на сервис EC2. Дальше в сервисе EC2 в левом навигационном меню перейти на Instances. Вы увидите список ваших инстанцев. Нас интересует инстанс с именем Lab. Необходимо его выбрать. После чего в нижней части экрана отобразятся данные по нашему инстанцу. Давайте нажмем на вкладку Details и вы увидите секцию, где прописан Public IPv4 адрес. Нам необходимо ее скопировать и вставить в соответствующее поле в программе Путти. После чего в левом навигационном меню нам необходимо раскрыть вкладку Connection и далее раскрыть SSH и открыть под вкладку ALF, то есть авторизация. После того, как мы туда перейдем, вы увидите в настройках поле, где можно указать путь к файлу с нашим private-ключом. Давайте нажмем на Browse. В компьютере найдем соответствующий файл, его выберем и нажмем на кнопку Open. Как только вы на нее нажмете, откроется страница с командной строкой и выйдет сообщение о том, что действительно ли вы доверяете этому удаленному серверу. В нашем случае, да, это наш EC2-инстанц. Нажимаем на кнопку Да и командная строка становится доступной. Также он запросит у нас логин пользователя, необходимо ввести EC2-юзер. Как только вы ее введете, вы увидите о том, что мы успешно авторизовались в нашем EC2-инстанце и можем запускать необходимые нам команды. Подключение к EC2-инстанцу в macOS и Linux клиентах, оно немного отличается, оно намного проще, вам нет необходимости устанавливать сторонние программы, а уже встроено в терминале, достаточно запустить набор команд, которые указаны в задании лабораторной работы. Мы с вами успешно авторизовались внутри EC2-инстанца и сейчас нам необходимо закончить настройку и сделать наш жесткий диск доступным для работы. Первым делом, давайте введем команду df-h. Здесь мы можем увидеть все доступные файловые системы. Root файловая система, это выделенная на экране slash def, slash xvda1 размером 8 гигабайтов. Это тот жесткий диск, на котором установлена операционная система. Мы двигаемся дальше, нам сейчас необходимо жесткий диск, который доступен для этого EC2-инстанца подключить к нашему инстанцу. Для этого необходимо ввести команду sudo mkfs-txt3 и ввести значение id девайса, который мы сохранили ранее. После того, как вы ее запустите, вы увидите соответствующее сообщение о том, что оно успешно было добавлено к текущим файловым системам. Победу это отметить, что после этой команды файловая система, а именно жесткий диск, он все еще не доступен для работы. Нам необходимо создать папку, которая является точкой монтирования этого жесткого диска в нашей операционной системе. Поэтому мы создаем папку в папке mount и назовем его datastore. Все папки и файлы в нашем жестком диске, они будут находиться по вот этому пути. Как только мы создали папку, теперь нам нужно этот путь, эту папку привязать к нашей файловой системе, к нашему жесткому диску. Для этого запускаем вторую команду, которую вы видите на экране. Как только вы ее запустите, она привяжется. Теперь важный момент, когда мы перезагрузим наш EC2-инстанс, то все дополнительные жесткие диски, связь с ними, она пропадает. Поэтому, чтобы эта связь не пропадала, нам необходимо в автозагрузку добавить соответствующую команду. И когда компьютер будет, instance будет перезагружаться, то связь, она будет автоматически устанавливаться. И жесткий диск будет всегда готов к работе. Для этого мы ведем соответствующую команду. Эта команда сохранится в fstab, то есть это список команд, которые запускаются при запуске. Если мы посмотрим на ее содержимое, мы увидим нашу команду. Давайте теперь, после того, как мы произвели все необходимые настройки, попробуем еще раз ввести команду df-h, для того чтобы отобразить все существующие файловые системы на нашем EC2-инстанции. Вы увидите, что у нас появился еще один пункт, дополнительная линия файловая система slash def slash xvdf. Она может отличаться у вас, в моем случае это так. Вы видите, что размер 1 гигабайт, и вы также видите, что она примонтирована по пути, которые мы указывали ранее, а именно рутовая папка mount и внутри под папка datastore. Теперь попробуем в нашем новом жестком диске создать новый файл. Для этого запустим следующую команду, и для перепроверки посмотрим содержимое нашего файла, файл.txt. Как только мы запустим вторую команду, мы увидим текст, который мы ранее вводили при создании нашего файла. Это говорит о том, что файл успешно создан, жесткий диск успешно правильно настроен, и мы можем переходить к следующему заданию в рамках нашей лабораторной работы. Мы с вами переходим к заключительному заданию в рамках нашей лабораторной работы, а именно создадим снапшот и попробуем восстановить этот снапшот. Для этого в AWS Management консоли в сервисе EC2 в левый навигационное меню нам необходимо выбрать пункт volumes, отобразить со список всех существующих volumes нам необходимо выбрать наш созданный, называется my volume, выбрать его, в верхней правой части нажать на кнопку actions и в выпадающем меню выбрать опцию create snapshot. Вас направят на новую страницу, где необходимо ввести данные, информацию о вашем новом снапшоте. Давайте заполним теги. Для тега name введем значение my snapshot и нажмем на кнопку create snapshot. Вы вернетесь обратно в список с вашими снапшотами и увидите статус pending. Вам необходимо дождаться, что статус поменяется на completed. Для этого вы можете нажимать на кнопку refresh в верхней части экрана, либо обновлять всю страницу. Пока у нас будет создаваться снапшот, мы можем сделать следующим образом. Необходимо перейти к нашему EC2 инстанции на наше ssh подключение и попробуем удалить наш созданный файл, файл.txt. Как только мы ее удалим, давайте проверим, что действительно в папке data store нет ни одного файла или папки. Если мы вернемся после этого обратно к AWS Management Console, мы увидим, что статус нашего снапшота уже поменялся на completed и он готов к работе. Что значит готов к работе? Это значит то, что мы можем создать новый жесткий диск на базе этого снапшота. Что мы с вами и сейчас проделаем? Давайте выберем наш снапшот. В верхней правой части нажмем на actions и в выпадающем меню нажмем create volume from snapshot. Сброется новая страница для ввода входящих данных. Здесь нам необходимо выбрать availability зону. Это та зона availability зона, где находится наш EC2 instance. В моем случае это US East 1A. Здесь необходимо также заполнить теги. Давайте как name введем restored volume для того, чтобы легче было различать наши EBS volume. Прокрутим чуть ниже и нажмем на кнопку create volume. Вы увидите, что в списке отобразится наш новый volume. Подождем пока он перейдет в состояние available и после этого выберем наш restored volume в actions выпадающем меню. Нажмем на опцию attach volume для того, чтобы привязать ее к нашему instance. Здесь также откроется новая страница. Вы увидите volume ID с названием restored volume. Нам необходимо выбрать instance с названием lab и также вы увидите, что для этого жесткого диска дано системное имя, путь, по которому он будет находиться slash def slash sdg. Нам необходимо запомнить это значение, оно нам еще понадобится и нажать на кнопку attach volume. Теперь нам необходимо произвести все те же настройки, но единственное отличие, точка монтирования, а именно путь у нас будет отличаться и будет в рутовой папке mount под папка datastore2. Как только мы настроим новый жесткий диск, мы можем посмотреть содержание этого жесткого диска и вы увидите там нашу ранее созданную, ранее созданный файл и называется она файл точка txt. Таким образом мы смогли восстановить наш снапшот, наш файл доступен. На этом мы завершаем нашу лаборторную работу. Нам необходимо со всех систем корректно разлагиниться. Для этого в AWS Management консоли в верхней правой части нажмем на название пользователя, в выпадающем меню нажмем на кнопку sign out. Далее на странице AWS Academy с нашей лаборторной работой нам необходимо нажать на кнопку end lab в верхней правой части, подтвердить, что мы завершаем лаборторную работу и в всплывающем окошке дождаться, что появится сообщение you may close this message box now, lab resources are terminating, что говорит о том, что команда завершения лаборторной работы успешно принята системой и процесс удаления всех ресурсов он начался. После чего мы можем закрывать это всплывающее окно и также выходить с AWS Academy. На этом мы завершаем сессию разбора лаборторной работы. Мы подробнее поговорили про сервис Amazon EBS. Я очень надеюсь, что вы получили более полное представление об этом сервисе. Спасибо за внимание. Увидимся с вами на следующих наших активностях.
