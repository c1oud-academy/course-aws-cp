Добрый день, уважаемые студенты! Я рад вас видеть на очередной сессии разбора лабораторной работы. Тема лабораторной работы – это сервис Amazon EBS. Окей, давайте начнем. Итак, мы будем продолжать с основной страницы лабораторной работы. Ожидается, что вы уже инициализировали ваш временный AWS аккаунт. И сейчас достаточно нажать на кнопку AWS, чтобы перейти в AWS Management Console. В верхней правой части AWS Management Console вы видите, что был создан временный аккаунт с соответствующим пользователем. Давайте начнем выполнять задание лабораторной работы. Первым делом нам необходимо перейти в сервис EC2. Для этого в строке поиска сервисов начнем вводить EC2 и в выборке первая ссылка будет ссылка на сервис EC2. Как только мы перейдем на сервис EC2, в левом навигационном меню необходимо выбрать пункт меню Instances для того, чтобы отобразить список существующих инстансов на нашем AWS аккаунте. Если этот список пустой, обратите внимание, в каком регионе вы сейчас находитесь. Регион можно увидеть в верхней правой части страницы AWS Management Console. Необходимо, чтобы регион был North Virginia. В списке инстансов вы помимо прочих видите инстанс с названием Lab. Нам необходимо запомнить, что этот инстанс находится в availability зоне us-east-1a. Мы с вами двигаемся дальше. Теперь нам необходимо в левом навигационном меню выбрать пункт Volumes. В этом случае отобразится список всех существующих EBS volumes на нашем аккаунте. Давайте создадим новый volume. В настройках нам необходимо выбрать тип volume, как gp2, это General Purpose SSD. Далее размер, давайте выберем 1 ГБ, для учебных целей этого более чем достаточно. Как availability зону нам необходимо выбрать ту зону, где находится наш инстанс с названием Lab. В нашем случае это us-east-1a. Если мы прокрутим страницу чуть ниже, мы также можем ввести теги. Давайте создадим тег с ключом name и значением My Volume. Нажмем на кнопку Create Volume. Вы увидите, что в списке Volumes отобразится новый с названием My Volume, с соответствующим размером. Если мы проскроллим этот список чуть направо, мы увидим Volume state, то есть состояние нашего volume. В самом начале, во время создания он будет в состоянии Creating, т.е. создается и пока не доступно для работы. Давайте подождем пару минут, после чего нажмем на кнопку Refresh, чтобы обновить список наших volumes. Через некоторое время мы увидим, что значение статуса поменялось с Creating на Available. Available это значит наш volume доступен для привязки к EC2 инстансу и в данный момент не привязан. Если вы видите статус In-use, это говорит о том, что данный volume привязан к EC2 инстансу. Как только мы убедились, что наш новый созданный volume доступен для привязки к EC2 инстансу, давайте попробуем это сделать. Для начала необходимо выбрать наш volume, далее вверху вправо нажать на кнопку Actions и в выпадающем списке выбрать опцию Attach volume. Вы перейдете на соответствующую страницу, где будет указан Volume ID, это тот volume, который мы привязываем. Далее нам необходимо выбрать instance, в выпадающем меню будет отображен список наших инстансов, также рядом будет название нашего инстанса. Нам нужно выбрать тот, который называется Lab. Нам необходимо также сделать пометку и записать Device name это /dev/sdf, то есть это системное название нашего инстанса, используя ее мы будем подключать наш жесткий диск к Linux EC2 инстансу. Давайте проскроллим вниз и нажмем на кнопку Attach volume. Как только вы на нее нажмете, вас перенаправит на страницу со списком жестких дисков и вы увидите, что в нашем жестком диске поменялось состояние с Available на In-use. Теперь нам необходимо попробовать подключиться к нашему EC2 инстансу для того, чтобы завершить все необходимые настройки и сделать наш жесткий диск доступным для работы в этом инстансе. Для этого нам необходимо перейти на страницу с лабораторной работой в AWS Academy, в меню лабораторной работы нажать на кнопку Details и далее в выпадающем окошке нажать на кнопку Show. Вы увидите всплывающее окно с некоторыми полезными деталями касательно нашего нового созданного временного AWS аккаунта. В рамках этого AWS аккаунта для нас также был создан SSH ключ. Мы можем его скачать в двух различных вариантах. Это PEM ключ либо PPK. В зависимости от того, какая операционная система установлена на вашем компьютере, вы выбираете соответствующий вид private ключа. В случае, если у вас Windows операционная система, вам необходимо скачать PPK. В случае, если у вас Mac OS либо Linux, необходимо скачать PEM формат private ключа. Также на странице с заданием лабораторной работы вы увидите ссылку на программу. Называется она PuTTY и эта программа является самой популярной программой для подключения по SSH к удаленному серверу. В нашем случае это EC2 Instance. Здесь есть ссылка, вам необходимо по ней перейти и скачать эту программу. Как только вы скачали программу PuTTY, вам нет необходимости ее устанавливать. После запуска программы вы увидите окно и можно с ней уже работать. Так выглядит основное окно программы. В левой части окна навигационное меню и в правой части, соответственно, значение настроек, которые можно вводить. Давайте перейдем в левом навигационном меню в пункт Connection откроются соответствующие настройки и для параметра Seconds between keepalives ввести значение 30. После чего необходимо вернуться обратно в первый пункт меню Session. Вы попадаете на самую основную страницу, вкладку. Здесь необходимо ввести Host name либо IP адрес. Для того, чтобы узнать наш IP адрес, нам необходимо перейти в AWS Management Console на сервис EC2. Дальше в сервисе EC2 в левом навигационном меню перейти на Instances. Вы увидите список ваших инстансов. Нас интересует инстанс с именем Lab. Необходимо его выбрать. После чего в нижней части экрана отобразятся данные по нашему инстансу. Давайте нажмем на вкладку Details и вы увидите секцию, где прописан Public IPv4 адрес. Нам необходимо ее скопировать и вставить в соответствующее поле в программе PuTTY. После чего в левом навигационном меню нам необходимо раскрыть вкладку Connection и далее раскрыть SSH и открыть под вкладку Auth, то есть авторизация. После того, как мы туда перейдем, вы увидите в настройках поле, где можно указать путь к файлу с нашим private ключом. Давайте нажмем на Browse. В компьютере найдем соответствующий файл, его выберем и нажмем на кнопку Open. Как только вы на нее нажмете, откроется страница с командной строкой и выйдет сообщение о том, что действительно ли вы доверяете этому удаленному серверу. В нашем случае, да, это наш EC2 инстанс. Нажимаем на кнопку Да и командная строка становится доступной. Также он запросит у нас логин пользователя, необходимо ввести ec2-user. Как только вы его введете, вы увидите сообщение о том, что мы успешно авторизовались в нашем EC2 инстансе и можем запускать необходимые нам команды. Подключение к EC2 инстансу в MacOS и Linux клиентах немного отличается, оно намного проще, вам нет необходимости устанавливать сторонние программы, а уже встроено в терминале, достаточно запустить набор команд, которые указаны в задании лабораторной работы. Мы с вами успешно авторизовались внутри EC2 инстанса и сейчас нам необходимо закончить настройку и сделать наш жесткий диск доступным для работы. Первым делом, давайте введем команду df -h. Здесь мы можем увидеть все доступные файловые системы. Root файловая система, это выделенная на экране /dev/xvda1 размером 8 гигабайтов. Это тот жесткий диск, на котором установлена операционная система. Мы двигаемся дальше, нам сейчас необходимо жесткий диск, который доступен для этого EC2 инстанса подключить к нашему инстансу. Для этого необходимо ввести команду sudo mkfs -t ext3 и ввести значение ID девайса, который мы сохранили ранее. После того, как вы ее запустите, вы увидите соответствующее сообщение о том, что оно успешно было добавлено к текущим файловым системам. Следует отметить, что после этой команды файловая система, а именно жесткий диск, все еще не доступен для работы. Нам необходимо создать папку, которая является точкой монтирования этого жесткого диска в нашей операционной системе. Поэтому мы создаем папку в папке mount и назовем его data-store. Все папки и файлы в нашем жестком диске будут находиться по вот этому пути. Как только мы создали папку, теперь нам нужно этот путь, эту папку привязать к нашей файловой системе, к нашему жесткому диску. Для этого запускаем вторую команду, которую вы видите на экране. Как только вы ее запустите, она привяжется. Теперь важный момент, когда мы перезагрузим наш EC2 инстанс, то связь со всеми дополнительными жесткими дисками пропадает. Поэтому, чтобы эта связь не пропадала, нам необходимо в автозагрузку добавить соответствующую команду. И когда инстанс будет перезагружаться, то связь будет автоматически устанавливаться и жесткий диск будет всегда готов к работе. Для этого мы ведем соответствующую команду. Эта команда сохранится в fstab, то есть это список команд, которые запускаются при запуске. Если мы посмотрим на ее содержимое, мы увидим нашу команду. Давайте теперь, после того, как мы произвели все необходимые настройки, попробуем еще раз ввести команду df -h, для того чтобы отобразить все существующие файловые системы на нашем EC2 инстансе. Вы увидите, что у нас появился еще один пункт, дополнительная линия файловая система /dev/xvdf. Она может отличаться у вас, в моем случае это так. Вы видите, что размер 1 гигабайт, и вы также видите, что она примонтирована по пути, который мы указывали ранее, а именно рутовая папка mnt и внутри под папка data-store. Теперь попробуем в нашем новом жестком диске создать новый файл. Для этого запустим следующую команду, и для перепроверки посмотрим содержимое нашего файла, file.txt. Как только мы запустим вторую команду, мы увидим текст, который мы ранее вводили при создании нашего файла. Это говорит о том, что файл успешно создан, жесткий диск правильно настроен, и мы можем переходить к следующему заданию в рамках нашей лабораторной работы. Мы с вами переходим к заключительному заданию в рамках нашей лабораторной работы, а именно создадим снапшот и попробуем восстановить этот снапшот. Для этого в AWS Management Console в сервисе EC2 в левом навигационном меню нам необходимо выбрать пункт Volumes, отобразится список всех существующих volumes, нам необходимо выбрать наш созданный, называется My Volume, выбрать его. В верхней правой части нажать на кнопку Actions и в выпадающем меню выбрать опцию Create snapshot. Вас направят на новую страницу, где необходимо ввести данные, информацию о вашем новом снапшоте. Давайте заполним теги. Для тега name введем значение My Snapshot и нажмем на кнопку Create snapshot. Вы вернетесь обратно в список с вашими снапшотами и увидите статус Pending. Вам необходимо дождаться, что статус поменяется на Completed. Для этого вы можете нажимать на кнопку Refresh в верхней части экрана, либо обновлять всю страницу. Пока у нас будет создаваться снапшот, мы можем сделать следующим образом. Необходимо перейти к нашему EC2 инстансу на наше SSH подключение и попробуем удалить наш созданный файл, file.txt. Как только мы ее удалим, давайте проверим, что действительно в папке data-store нет ни одного файла или папки. Если мы вернемся после этого обратно к AWS Management Console, мы увидим, что статус нашего снапшота уже поменялся на Completed и он готов к работе. Что значит готов к работе? Это значит то, что мы можем создать новый жесткий диск на базе этого снапшота, что мы с вами и сейчас проделаем. Давайте выберем наш снапшот. В верхней правой части нажмем на Actions и в выпадающем меню нажмем Create volume from snapshot. Откроется новая страница для ввода входящих данных. Здесь нам необходимо выбрать availability зону. Это та зона availability зона, где находится наш EC2 инстанс. В моем случае это us-east-1a. Здесь необходимо также заполнить теги. Давайте как name введем Restored volume для того, чтобы легче было различать наши EBS volume. Прокрутим чуть ниже и нажмем на кнопку Create volume. Вы увидите, что в списке отобразится наш новый volume. Подождем пока он перейдет в состояние Available и после этого выберем наш Restored volume и в Actions выпадающем меню нажмем на опцию Attach volume для того, чтобы привязать ее к нашему инстансу. Здесь также откроется новая страница. Вы увидите Volume ID с названием Restored volume. Нам необходимо выбрать инстанс с названием Lab и также вы увидите, что для этого жесткого диска дано системное имя, путь, по которому он будет находиться /dev/sdg. Нам необходимо запомнить это значение, оно нам еще понадобится и нажать на кнопку Attach volume. Теперь нам необходимо произвести все те же настройки, но единственное отличие, точка монтирования, а именно путь у нас будет отличаться и будет в рутовой папке mnt под папка data-store2. Как только мы настроим новый жесткий диск, мы можем посмотреть содержание этого жесткого диска и вы увидите там наш ранее созданный файл и называется она file.txt. Таким образом мы смогли восстановить наш снапшот, наш файл доступен. На этом мы завершаем нашу лаборторную работу. Нам необходимо со всех систем корректно разлогиниться. Для этого в AWS Management Console в верхней правой части нажмем на название пользователя, в выпадающем меню нажмем на кнопку Sign out. Далее на странице AWS Academy с нашей лаборторной работой нам необходимо нажать на кнопку End lab в верхней правой части, подтвердить, что мы завершаем лаборторную работу и в всплывающем окошке дождаться, что появится сообщение You may close this message box now. Lab resources are terminating..., что говорит о том, что команда завершения лаборторной работы успешно принята системой и процесс удаления всех ресурсов начался. После чего мы можем закрывать это всплывающее окно и также выходить с AWS Academy. На этом мы завершаем сессию разбора лаборторной работы. Мы подробнее поговорили про сервис Amazon EBS. Я очень надеюсь, что вы получили более полное представление об этом сервисе. Спасибо за внимание. Увидимся с вами на следующих наших активностях.