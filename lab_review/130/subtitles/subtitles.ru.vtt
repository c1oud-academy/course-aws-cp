WEBVTT

00:00:00.000 --> 00:00:07.000
Добрый день, уважаемые студенты! Я рад вас всех 
видеть на очередной сессии разбора лабораторной

00:00:07.000 --> 00:00:13.000
работы. Тема сегодняшней лабораторной работы — 
это Scale & Load Balance your Architecture. Мы 

00:00:13.000 --> 00:00:23.000
подробнее познакомимся с сервисами ELB - Elastic 
Load Balancer и Auto Scaling. Итак, давайте начнем.

00:00:23.000 --> 00:00:33.000
Ожидается, что вы уже находитесь на странице 
лабораторной работы и инициировали создание

00:00:33.000 --> 00:00:39.000
временного AWS аккаунта. Сейчас нам необходимо 
нажать на кнопку AWS для того, чтобы перейти в

00:00:39.000 --> 00:00:43.000
AWS Management Console. В console первое 
задание - нам необходимо создать AMI.

00:00:43.000 --> 00:00:50.000
Для этого нам необходимо в строке поиска 
ввести EC2 и в выдаче вы видите нужную ссылку.

00:00:50.000 --> 00:00:54.000
Давайте на нее нажмем и 
перейдем на сервис Amazon EC2.

00:00:54.000 --> 00:00:59.000
Далее в левом навигационном меню 
необходимо выбрать пункт Instances.

00:00:59.000 --> 00:01:05.000
В отобразившемся списке инстансов 
необходимо выбрать Web Server 1.

00:01:05.000 --> 00:01:13.000
Далее нажать на кнопку Actions и в выпадающем 
меню выбрать пункт Image and templates

00:01:13.000 --> 00:01:16.000
и нажать на кнопку Create 
image. Как только вы на

00:01:16.000 --> 00:01:22.000
нее нажмете, вас перенаправят на новую страницу,
в которой необходимо ввести некоторые данные. 

00:01:22.000 --> 00:01:26.000
Первое — это Image name, 
нужно ввести WebServerAMI.

00:01:26.000 --> 00:01:31.000
Далее Image description, давайте 
введем Lab AMI for Web Server.

00:01:31.000 --> 00:01:38.000
Прокрутим чуть ниже, все остальные настройки 
оставляем по умолчанию и нажимаем Create image.

00:01:38.000 --> 00:01:44.000
Как только вы на нее нажмете, вас 
перенаправят на предыдущую страницу

00:01:44.000 --> 00:01:51.000
и вы увидите сообщение о том, что 
AMI с таким ID был успешно создан.

00:01:51.000 --> 00:01:56.000
Давайте скопируем AMI, он возможно 
нам понадобится в следующих заданиях.

00:01:56.000 --> 00:01:59.000
Теперь нам необходимо создать 
Target group. Target group мы

00:01:59.000 --> 00:02:07.000
создаем предварительно и эту target group будем 
использовать при создании Elastic Load Balancer.

00:02:07.000 --> 00:02:12.000
Итак, нам необходимо в левом навигационном 
меню выбрать пункт Target Groups.

00:02:12.000 --> 00:02:18.000
Как только вы на нее нажмете, отобразится 
список всех существующих Target Group в нашем 

00:02:18.000 --> 00:02:23.000
временном AWS аккаунте. Нам необходимо 
нажать на кнопку Create target group.

00:02:23.000 --> 00:02:29.000
Откроется соответствующая страница 
для ввода некоторых данных.

00:02:29.000 --> 00:02:35.000
В самом начале как Type необходимо выбрать 
Instances, т.е. мы работаем с сервисом Amazon EC2.

00:02:35.000 --> 00:02:42.000
Далее необходимо будет прокрутить чуть ниже 
и как Target group name нужно ввести LabGroup.

00:02:42.000 --> 00:02:48.000
Как VPC выбираем Lab VPC, все 
остальные настройки остаются такими же.

00:02:48.000 --> 00:02:54.000
В самой нижней части страницы 
необходимо нажать на кнопку Next.

00:02:54.000 --> 00:03:01.000
Вас направят на второй шаг создания Target 
group и здесь необходимо выбрать наши targets.

00:03:01.000 --> 00:03:08.000
Так как наши targets будут управляться Auto 
Scaling group, то здесь нам не нужно выбирать

00:03:08.000 --> 00:03:14.000
инстансы. Достаточно прокрутить чуть ниже 
страницу и нажать на кнопку Create target group

00:03:14.000 --> 00:03:21.000
без привязанных таргетов. Следующий шаг – 
нам необходимо создать сам Load Balancer.

00:03:21.000 --> 00:03:26.000
Для этого в левом навигационном меню 
необходимо выбрать опцию Load Balancers

00:03:26.000 --> 00:03:31.000
и в открывшейся странице нажать 
на кнопку Create Load Balancer.

00:03:31.000 --> 00:03:36.000
Мы с вами знаем, что у нас 
есть три вида Load Balancers.

00:03:36.000 --> 00:03:40.000
В нашем случае интересует первый, 
это Application Load Balancer.

00:03:40.000 --> 00:03:43.000
Давайте нажмем на кнопку 
Create под этой опцией.

00:03:43.000 --> 00:03:49.000
Как только вы на нее нажмете, вас перенаправят 
на страницу для ввода входных данных.

00:03:49.000 --> 00:03:57.000
Давайте как Load balancer name укажем LabELB. 
Далее необходимо указать VPC — это Lab VPC.

00:03:57.000 --> 00:04:04.000
В секции Mappings нам необходимо отметить 
ту availability zone, в которой ELB будет

00:04:04.000 --> 00:04:11.000
распределять трафик, а также для каждой 
availability zone необходимо выбрать subnet.

00:04:11.000 --> 00:04:17.000
В выпадающем меню для us-east-1a 
необходимо выбрать Public Subnet 1,

00:04:17.000 --> 00:04:22.000
для us-east-1b необходимо 
выбрать Public Subnet 2.

00:04:22.000 --> 00:04:29.000
Если мы прокрутим чуть ниже, в секции Security 
groups, в выпадающем меню нам необходимо

00:04:29.000 --> 00:04:37.000
выбрать Web Security Group. В следующей секции 
Listeners and routing необходимо удостовериться,

00:04:37.000 --> 00:04:47.000
что протокол стоит HTTP, а порт 80. Как Default 
action давайте выберем Forward to Lab Group из

00:04:47.000 --> 00:04:53.000
выпадающего списка. Теперь нам необходимо 
прокрутить в самый конец страницы и нажать на

00:04:53.000 --> 00:05:01.000
кнопку Create load balancer. Как только вы 
нажмете на Create load balancer, вас направит на

00:05:01.000 --> 00:05:07.000
страницу с еще одной кнопкой, и по нажатию которой
вы можете перейти на непосредственно ваш

00:05:07.000 --> 00:05:14.000
Load Balancer. Вы можете перейти по ней и 
посмотреть все детали создания этого ресурса,

00:05:14.000 --> 00:05:19.000
а мы с вами переходим к следующему заданию, 
теперь мы будем создавать Auto Scaling group.

00:05:19.000 --> 00:05:24.000
Для того, чтобы создать Auto Scaling group, 
первым делом создается Launch config.

00:05:24.000 --> 00:05:29.000
Для этого в левом навигационном меню 
необходимо выбрать опцию Launch Configurations,

00:05:29.000 --> 00:05:34.000
и в открывшейся странице нажать 
на кнопку Create launch configuration.

00:05:34.000 --> 00:05:40.000
Вас перенаправит на страницу ввода входных 
данных, как Name необходимо указать LabConfig,

00:05:40.000 --> 00:05:44.000
как AMI выбрать WebServerAMI, 
который мы создавали ранее,

00:05:44.000 --> 00:05:50.000
как Instance type необходимо выбрать 
t3.micro, если этот вариант недоступен,

00:05:50.000 --> 00:05:54.000
здесь вы можете выбрать 
t2.micro, либо любой другой.

00:05:54.000 --> 00:05:58.000
В рамках лабораторной 
работы разницы никакой нет.

00:05:58.000 --> 00:06:05.000
Прокручиваем чуть ниже, в секции Additional 
configuration и в подсекции Monitoring,

00:06:05.000 --> 00:06:11.000
нам необходимо поставить галочку для того, 
чтобы активировать detailed monitoring.

00:06:11.000 --> 00:06:17.000
Это когда в CloudWatch отправляются
метрики чаще, чем обычно.

00:06:19.000 --> 00:06:24.000
В секции Security groups необходимо выбрать 
опцию Select an existing security group,

00:06:24.000 --> 00:06:28.000
т.е. мы выбираем среди существующих 
security group, новую создавать не нужно.

00:06:28.000 --> 00:06:34.000
Для нас есть уже предварительно созданная 
security group, она называется Web Security Group.

00:06:34.000 --> 00:06:38.000
Необходимо ее выбрать и мы 
двигаемся к следующей секции.

00:06:38.000 --> 00:06:44.000
Самая последняя секция - это Key pair, 
т.е. мы здесь указываем ключ,

00:06:44.000 --> 00:06:49.000
по которому можно подключиться к 
нашим Amazon EC2 инстансам через SSH.

00:06:49.000 --> 00:06:53.000
В рамках лабораторной работы 
мы по SSH подключаться не будем,

00:06:53.000 --> 00:06:58.000
но как best practice мы 
укажем этот ключ.

00:06:58.000 --> 00:07:03.000
Необходимо в Key pair options выбрать 
опцию Choose an existing key pair

00:07:03.000 --> 00:07:11.000
и далее выбрать существующий ключ - vockey. 
Также необходимо поставить галочку о том, что мы

00:07:11.000 --> 00:07:16.000
подтверждаем, что мы будем подключаться к Amazon 
EC2 инстансам с использованием этого ключа.

00:07:17.000 --> 00:07:23.000
Это была последняя секция, теперь 
необходимо нажать в нижней части 

00:07:23.000 --> 00:07:26.000
страницы на кнопку 
Create launch configuration.

00:07:26.000 --> 00:07:32.000
Как только она создастся, мы можем 
переходить к созданию Auto Scaling group.

00:07:32.000 --> 00:07:39.000
Для этого в списке Launch configurations 
необходимо выбрать ранее созданный LabConfig,

00:07:39.000 --> 00:07:45.000
далее нажать на кнопку Actions и в выпадающем 
меню выбрать опцию Create Auto Scaling group.

00:07:45.000 --> 00:07:51.000
Вас перенаправит на страницу 
ввода входных данных.

00:07:51.000 --> 00:07:59.000
Давайте для поля Auto Scaling group name введем 
Lab Auto Scaling Group и нажмем на кнопку Next.

00:07:59.000 --> 00:08:03.000
На следующей странице необходимо 
ввести параметры Network,

00:08:03.000 --> 00:08:07.000
т.е. сети. Самым первым делом 
необходимо указать VPC,

00:08:07.000 --> 00:08:12.000
в нашем случае это Lab VPC, мы можем 
его найти в выпадающем списке.

00:08:12.000 --> 00:08:15.000
Далее нам необходимо указать 
Availability zones and subnets.

00:08:15.000 --> 00:08:22.000
Здесь необходимо выбрать из выпадающего 
списка Private Subnet 1 и Private Subnet 2.

00:08:22.000 --> 00:08:28.000
Почему мы выбираем именно Private 
Subnets я объяснял в предыдущем видео,

00:08:28.000 --> 00:08:31.000
когда мы делали обзор 
лабораторной работы.

00:08:31.000 --> 00:08:36.000
Как только мы выбираем необходимые 
subnets, мы переходим к следующей части,

00:08:36.000 --> 00:08:41.000
к следующей странице настройки, 
нажимаем на кнопку Next.

00:08:41.000 --> 00:08:45.000
На следующей странице 
есть секция Load balancing,

00:08:45.000 --> 00:08:50.000
здесь необходимо выбрать опцию 
Attach to an existing load balancer.

00:08:50.000 --> 00:08:58.000
В следующей секции необходимо выбрать 
Choose from your load balancer target groups

00:08:58.000 --> 00:09:04.000
и выбрать Load Balancer LabGroup 
из выпадающего списка.

00:09:04.000 --> 00:09:10.000
Необходимо прокрутить чуть ниже и 
в секции Additional settings для мониторинга

00:09:10.000 --> 00:09:14.000
также отметить Enable group metrics 
collection within CloudWatch.

00:09:14.000 --> 00:09:21.000
Это говорит о том, что мы все метрики 
будем агрегировать в сервисе CloudWatch.

00:09:21.000 --> 00:09:27.000
На этой странице мы вывели все 
необходимые входные данные,

00:09:27.000 --> 00:09:30.000
теперь необходимо   
нажать на кнопку Next.

00:09:30.000 --> 00:09:38.000
Мы попадаем на страницу конфигурирования 
размеров группы и scaling policy.

00:09:38.000 --> 00:09:46.000
Первым делом мы заполняем capacity, есть три 
опции — это Desired capacity, Minimum capacity и

00:09:46.000 --> 00:09:56.000
Maximum capacity. Чем отличаются они друг от 
друга, мы также разбирали в предыдущей активности

00:09:56.000 --> 00:10:03.000
обзора лабораторной работы. Здесь нам необходимо
ввести значение 2, 2 и 6 и мы двигаемся дальше.

00:10:03.000 --> 00:10:09.000
Следующая секция — это Scaling policies, здесь 
необходимо выбрать Target tracking scaling policy.

00:10:09.000 --> 00:10:16.000
Это говорит о том, что Auto Scaling group 
будет смотреть на некоторую метрику

00:10:16.000 --> 00:10:22.000
и в зависимости от этой метрики будет 
увеличиваться либо уменьшаться в своих размерах.

00:10:22.000 --> 00:10:31.000
Как Scaling policy name давайте введем 
LabScalingPolicy и как Metric type введем Average

00:10:31.000 --> 00:10:37.000
CPU utilization, т.е. мы смотрим на нагрузку 
на наши процессоры в Amazon EC2 инстансах

00:10:37.000 --> 00:10:48.000
и как Target value укажем 60. На этом мы ввели 
все необходимые настройки на этой странице.

00:10:48.000 --> 00:10:52.000
Давайте прокрутим вниз и 
нажмем на кнопку Next.

00:10:52.000 --> 00:10:57.000
На следующей странице предлагается 
ввести различные уведомления.

00:10:57.000 --> 00:11:03.000
Здесь мы в рамках лабораторной работы 
это настраивать не будем, двигаемся дальше.

00:11:05.000 --> 00:11:12.000
Следующий и последний шаг, где мы вводим 
некоторые входные данные — это шаг с тегами.

00:11:12.000 --> 00:11:21.000
Давайте добавим Tag Name со значением Lab Instance
и оставим галочку в поле Tag new instances.

00:11:21.000 --> 00:11:25.000
Это говорит о том, что для всех инстансов, 
которые создаются под Auto Scaling group,

00:11:25.000 --> 00:11:31.000
будут передаваться теги такие же, 
которые есть у Auto Scaling group.

00:11:34.000 --> 00:11:39.000
Мы закончили на этой странице, давайте нажмем 
на кнопку Next для того, чтобы перейти на самую

00:11:39.000 --> 00:11:45.000
последнюю страницу. Здесь нет необходимости 
вводить какие-либо данные, а отображаются все 

00:11:45.000 --> 00:11:53.000
входные данные, которые мы ввели ранее. Если же 
некоторые данные неточные или вы хотите их

00:11:53.000 --> 00:11:58.000
изменить, то возле каждой секции есть кнопка 
Edit для того, чтобы быстро перейти на

00:11:58.000 --> 00:12:03.000
необходимую страницу. Если же все хорошо, вы 
можете прокрутить в самый низ страницы и нажать

00:12:03.000 --> 00:12:10.000
на кнопку Create Auto Scaling group. Вас 
перенаправит на страницу со всеми Auto Scaling

00:12:10.000 --> 00:12:17.000
groups, вы увидите статус Updating capacity и 
количество Instances на текущий момент 0.

00:12:17.000 --> 00:12:22.000
Если мы подождем некоторое время и обновим 
страницу еще раз, то количество инстансов 

00:12:22.000 --> 00:12:27.000
приравняется к количеству Desired capacity, 
т.е. два новых инстанса создастся и статус 

00:12:27.000 --> 00:12:33.000
станет Ready. Вы можете это проделать 
самостоятельно, а сейчас мы двигаемся дальше,

00:12:33.000 --> 00:12:40.000
мы хотим проверить, что действительно инстансы 
создаются. Для этого в левом навигационном меню

00:12:40.000 --> 00:12:49.000
нам необходимо нажать на пункт Instances и вы 
увидите список инстансов в этом AWS аккаунте.

00:12:49.000 --> 00:12:58.000
Появилось два новых инстанса, оба называются Lab 
Instance и вы видите статус Initializing, т.е. они

00:12:58.000 --> 00:13:04.000
только начали создаваться. Через некоторое 
время они также полностью поднимутся,

00:13:04.000 --> 00:13:14.000
настроятся и пройдут все проверки статуса и примут
такое же значение как существующие инстансы.

00:13:14.000 --> 00:13:26.000
Давайте теперь в левом навигационном меню в нижней
части перейдем к вкладке Target Groups для того,

00:13:26.000 --> 00:13:35.000
чтобы посмотреть какие таргеты у нас есть в 
созданной нами в Target group. У нас единственная

00:13:35.000 --> 00:13:42.000
Target group, давайте ее выберем, отобразятся в 
нижней части экрана дополнительные вкладки с более

00:13:42.000 --> 00:13:48.000
подробной информацией. Нам необходимо перейти 
на вкладку Targets и вы увидите, что сейчас у нас 

00:13:48.000 --> 00:13:55.000
как Registered targets значатся два инстанса. 
Это те два инстанса, которые были созданы

00:13:55.000 --> 00:14:01.000
Auto Scaling group и вы видите статус healthy, 
что говорит о том, что Elastic Load Balancer уже

00:14:01.000 --> 00:14:12.000
готов направлять трафик, а эти инстансы готовы 
этот трафик принимать. Для того чтобы проверить,

00:14:12.000 --> 00:14:22.000
действительно ли связка Elastic Load Balancing, 
Auto Scaling и Amazon EC2 инстансы работает,

00:14:22.000 --> 00:14:32.000
мы можем перейти в наше приложение. Для этого 
необходимо в левом навигационном меню выбрать

00:14:32.000 --> 00:14:39.000
вкладку Load Balancers и когда мы выберем 
единственный Load Balancer, который мы создали

00:14:39.000 --> 00:14:45.000
ранее, в нижней части экрана отобразятся 
дополнительные вкладки. В первой вкладке 

00:14:45.000 --> 00:14:55.000
Description мы можем скопировать DNS name и ввести
это значение в новой вкладке в веб-браузере.

00:14:55.000 --> 00:15:01.000
Вы увидите, что отобразилась некоторая страница, 
это говорит о том, что ваш запрос был принят 

00:15:01.000 --> 00:15:12.000
Load Balancer. Load Balancer ваш запрос направил 
на веб-сервер, веб-сервер его обработал и

00:15:12.000 --> 00:15:16.000
вернул некоторый ответ. Этот ответ 
вам отображен в виде веб-страницы.

00:15:16.000 --> 00:15:25.000
Более того, вы видите информацию о том, какой 
инстанс обработал ваш запрос. Это тот инстанс,

00:15:25.000 --> 00:15:30.000
который находится на второй 
availability zone, а именно us-east-1b.

00:15:31.000 --> 00:15:36.000
Отлично, теперь нам необходимо проверить, 
что Auto Scaling group работает корректно,

00:15:36.000 --> 00:15:40.000
что она скейлится, увеличивается 
и уменьшается в размерах.

00:15:40.000 --> 00:15:47.000
Для того, чтобы это проверить, первым делом 
необходимо перейти на сервис CloudWatch.

00:15:47.000 --> 00:15:53.000
Давайте начнем вводить CloudWatch, 
либо начнем вводить Watch в строке

00:15:53.000 --> 00:15:58.000
поиска сервисов и мы 
увидим нужную нам ссылку.

00:15:58.000 --> 00:16:02.000
Как только мы переходим к 
сервису CloudWatch, в левом

00:16:02.000 --> 00:16:05.000
навигационном меню необходимо 
выбрать опцию All alarms.

00:16:05.000 --> 00:16:12.000
Отобразится список всех alarms, 
существующих на этом AWS аккаунте.

00:16:12.000 --> 00:16:15.000
В нашем случае будет два 
alarms. Первый в названии

00:16:15.000 --> 00:16:18.000
содержит AlarmHigh, второй 
содержит название AlarmLow. 

00:16:18.000 --> 00:16:27.000
Это противоположные alarms. Идея в том, что 
AlarmHigh принимает значение in alarm в том случае,

00:16:27.000 --> 00:16:38.000
если CPU utilization превышает 60% для каждой 
минуты в течении 3 минут, т.е. это 3 datapoints.

00:16:38.000 --> 00:16:44.000
Если мы говорим про AlarmLow, в этом 
случае он принимает значение in alarm,

00:16:45.000 --> 00:16:55.000
если CPU utilization меньше 54% в течении 
15 минут, т.е. он 15 минут мониторит,

00:16:55.000 --> 00:17:02.000
если в течении 15 минут значение уменьшилось, 
то он переходит в состояние alarm.

00:17:02.000 --> 00:17:11.000
Оба alarms триггерят Auto Scaling group в 
противоположных направлениях. В случае

00:17:11.000 --> 00:17:17.000
когда у нас срабатывает AlarmHigh, то 
Auto Scaling group добавляет новый инстанс.

00:17:18.000 --> 00:17:25.000
В случае когда срабатывает AlarmLow, то 
Auto Scaling group удаляет лишний инстанс.

00:17:25.000 --> 00:17:31.000
Если же эти alarms у вас не отображаются, 
то необходимо проделать следующее действие.

00:17:31.000 --> 00:17:35.000
Нам необходимо перейти в сервис Amazon 
EC2, далее в левом навигационном меню

00:17:35.000 --> 00:17:42.000
выбрать опцию Auto Scaling Groups, 
в списке выбрать Lab Auto Scaling.

00:17:42.000 --> 00:17:49.000
И во вкладках с информацией об этой Auto 
Scaling group необходимо выбрать вкладку

00:17:49.000 --> 00:17:56.000
Automatic scaling. Здесь будут 
отображаться все scaling policy.

00:17:56.000 --> 00:18:02.000
У нас одна единственная scaling policy, 
необходимо ее выбрать, далее нажать на кнопку 

00:18:02.000 --> 00:18:07.000
Actions и в выпадающем меню нажать на 
кнопку Edit для того, чтобы ее отредактировать.

00:18:07.000 --> 00:18:13.000
Здесь для того, чтобы инициировать пересоздание 
alarms, вам достаточно поменять значение,

00:18:13.000 --> 00:18:17.000
рекомендуется поставить значение 
50 и нажать на кнопку Update.

00:18:17.000 --> 00:18:20.000
Как только вы это сделаете, вы 
можете возвращаться обратно 

00:18:20.000 --> 00:18:34.000
в сервис CloudWatch и вы должны увидеть 
создающийся alarm. Давайте выберем AlarmHigh.

00:18:34.000 --> 00:18:41.000
Мы перейдем на следующую страницу, 
где по середине будет список

00:18:41.000 --> 00:18:45.000
всех существующих alarms 
и в правой части экрана

00:18:45.000 --> 00:18:50.000
отображается более подробная 
информация выбранного alarm.

00:18:50.000 --> 00:18:55.000
В нашем случае это AlarmHigh, вы видите 
красную линию, т.е. это threshold 50%

00:18:55.000 --> 00:19:03.000
и видите текущее значение нагрузки на CPU. 
Это абсолютно минимальная нагрузка сейчас на

00:19:03.000 --> 00:19:09.000
наши инстансы. Это очевидно, потому что 
нагрузка сейчас не идет на наши инстансы.

00:19:09.000 --> 00:19:14.000
Теперь, что мы сделаем? Мы возвращаемся 
обратно в наше приложение и в верхней части

00:19:14.000 --> 00:19:18.000
вы видите, что есть кнопка Load Test. 
Давайте на нее нажмем. Как только мы

00:19:18.000 --> 00:19:25.000
на нее нажмем, у нас начнется генерация 
нагрузки на наши Amazon EC2 инстансы.

00:19:25.000 --> 00:19:32.000
Страница обновляется каждые 5 минут и отображает 
текущую нагрузку на процессоры на наших

00:19:32.000 --> 00:19:38.000
Amazon EC2 инстансах. Эту страницу закрывать 
нельзя, если вы ее закроете, то скрипты

00:19:38.000 --> 00:19:43.000
перестанут работать и нагрузка упадет. 
Нужно держать эту вкладку открытой.

00:19:43.000 --> 00:19:53.000
Сейчас нам необходимо вернуться обратно 
и вы видите, что через некоторое время

00:19:53.000 --> 00:19:56.000
в течении 5 минут вы можете 
наблюдать как меняются графики

00:19:56.000 --> 00:20:02.000
и вы увидите, что AlarmHigh 
перешел в состояние In alarm.

00:20:02.000 --> 00:20:10.000
Почему? Потому что нагрузка на наши Amazon EC2 
инстансы превысила 50 или 60% в зависимости

00:20:10.000 --> 00:20:15.000
от того, что мы выбрали. А если мы говорим 
AlarmLow, который ранее принимал значение In 

00:20:15.000 --> 00:20:25.000
Sufficient Data либо In alarm, сейчас он принял 
значение OK, т.е. противоположное состояние.

00:20:25.000 --> 00:20:35.000
Теперь нам необходимо перейти в 
EC2 для того, чтобы удостовериться

00:20:35.000 --> 00:20:39.000
создала ли дополнительные 
инстансы наша Auto Scaling group.

00:20:39.000 --> 00:20:45.000
Для этого необходимо в левом навигационном 
меню перейти на вкладку Instances

00:20:45.000 --> 00:20:55.000
и вы увидите 3 либо 4 инстанса, 2 из 
которых будет в состоянии Initializing.

00:20:55.000 --> 00:21:03.000
Через какое-то время все 4 
инстанса будут принимать трафик

00:21:03.000 --> 00:21:07.000
и обрабатывать все запросы, 
которые пришли от Load Balancer.

00:21:07.000 --> 00:21:14.000
На этом мы завершили 
все основные задания. 

00:21:14.000 --> 00:21:21.000
Как дополнительный эксперимент я бы хотел 
вам посоветовать сделать следующее.

00:21:21.000 --> 00:21:29.000
Вы можете остановить нагрузку на ваши Amazon 
EC2 инстансы. Как только нагрузка спадет,

00:21:29.000 --> 00:21:34.000
через какое-то время в течении 
15 минут Auto Scaling group начнет

00:21:34.000 --> 00:21:42.000
терминейтить, т.е. отключать 
инстансы в Auto Scaling group

00:21:42.000 --> 00:21:49.000
и придет в исходное состояние, у нас будет 2 Lab 
Instance. Теперь, что мы можем сделать? Мы

00:21:49.000 --> 00:21:58.000
можем оба либо один из Lab Instance терминейтнуть 
вручную и посмотреть, что произойдет.

00:21:58.000 --> 00:22:09.000
А произойдет следующее. Как только вы удалите 
один из инстансов, то общее количество таргетов,

00:22:09.000 --> 00:22:14.000
т.е. инстансы под Auto Scaling group 
станет меньше чем минимальное значение.

00:22:14.000 --> 00:22:20.000
Как мы помним минимальное значение было 
2. В этом случае Auto Scaling триггерится,

00:22:20.000 --> 00:22:24.000
видит, что количество инстансов 
по тем или иным причинам стало

00:22:24.000 --> 00:22:28.000
меньше чем минимальное и 
инициирует создание новых инстансов.

00:22:28.000 --> 00:22:35.000
И через какое-то время она создает необходимое 
количество новых инстансов, чтобы количество

00:22:35.000 --> 00:22:42.000
инстансов было равно минимальному количеству 
инстансов в настройках Auto Scaling groups.

00:22:42.000 --> 00:22:56.000
Мы добрались до самого последнего задания. 
Оно достаточно простое, идея ее следующая.

00:22:56.000 --> 00:23:02.000
Мы ранее создавали AMI от инстанса 
Web Server 1, который принимал нагрузку,

00:23:02.000 --> 00:23:08.000
принимал запросы и обслуживал наше 
приложение. Теперь оно нам не нужно,

00:23:08.000 --> 00:23:13.000
мы можем ее достаточно 
безопасно уничтожить, удалить.

00:23:13.000 --> 00:23:18.000
Для этого необходимо из списка выбрать 
Web Server 1, убедитесь, что не выбраны

00:23:18.000 --> 00:23:23.000
другие инстансы. Далее в верхней части 
необходимо нажать на кнопку Instance state

00:23:23.000 --> 00:23:28.000
и в выпадающем списке выбрать 
опцию Terminate instance.

00:23:28.000 --> 00:23:36.000
Выйдет сообщение о том, что действительно ли вы 
хотите отключить ваш инстанс, необходимо нажать

00:23:36.000 --> 00:23:42.000
Terminate и подтвердить, что вы отключаете 
инстанс. После того как инстанс будет уничтожен,

00:23:42.000 --> 00:23:50.000
вы можете перепроверить действительно ли все 
работает и открыть страницу вашего приложения.

00:23:50.000 --> 00:23:56.000
Там стоит ссылка на Elastic Load Balancer и 
приложение будет также продолжать работать.

00:23:56.000 --> 00:24:06.000
На этом мы завершаем нашу лабораторную работу. 
Сейчас нам необходимо успешно разлогиниться

00:24:06.000 --> 00:24:11.000
со всех систем. Первое — это AWS Management 
Console, необходимо в верхней правой части

00:24:11.000 --> 00:24:17.000
нажать на название пользователя, в выпадающем 
списке нажать на кнопку Sign out. Далее необходимо

00:24:17.000 --> 00:24:24.000
корректно завершить лабораторную работу в AWS 
Academy, для этого необходимо нажать на кнопку

00:24:24.000 --> 00:24:31.000
End Lab. Нас попросят подтвердить, что мы 
действительно хотим завершить лабораторную работу,

00:24:31.000 --> 00:24:40.000
мы нажимаем "Yes" и в всплывающем окне мы 
должны дождаться сообщения, что мы можем

00:24:40.000 --> 00:24:47.000
закрывать это сообщение, удаление всех созданных 
ресурсов было инициировано. Вы можете закрывать

00:24:47.000 --> 00:24:53.000
это всплывающее окно, а также закрывать 
вкладку со страницей AWS Academy.

00:24:53.000 --> 00:25:00.000
На этом мы подошли к концу нашей лабораторной 
работы, мы ее разобрали и очень надеюсь, что вы

00:25:00.000 --> 00:25:07.000
получили более полное представление о сервисах 
Elastic Load Balancing и Auto Scaling. Это те

00:25:07.000 --> 00:25:15.000
базовые сервисы, которые позволяют сделать нашу 
инфраструктуру неким абстрактным организмом,

00:25:15.000 --> 00:25:21.000
который в зависимости от нагрузки, от внешних 
факторов может изменяться в размерах, 

00:25:21.000 --> 00:25:26.000
увеличиваться так и уменьшаться. Это дает большие
возможности компании, в первую очередь,

00:25:26.000 --> 00:25:32.000
это обработать все запросы ваших пользователей, 
пользователей ваших приложений и другой момент

00:25:32.000 --> 00:25:36.000
это то, что при уменьшении нагрузки 
на ваше приложение ее размеры

00:25:36.000 --> 00:25:41.000
автоматически уменьшаются для того, чтобы 
сократить ваши расходы на IT-инфраструктуру.

00:25:41.000 --> 00:25:47.000
Я надеюсь, что разбор лабораторной 
работы был полезен для вас.

00:25:47.000 --> 00:25:52.000
Спасибо за внимание, и увидимся с вами 
на следующих наших активностях.