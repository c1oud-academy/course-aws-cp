Қайырлы күн, құрметті студенттер! Мен сіздердің барлығыңызды зертханалық жұмыстың кезекті талдауында көруге қуаныштымын. Бүгін біз EBS сервисімен жақынырақ танысатын боламыз. Жарайды, бастайық.
Тиісті зертханалық жұмысқа жету үшін біз AWS Academy-ді, басты парақшаны және Academy Cloud Foundations курсын ашуымыз керек. Содан кейін сол жақ навигация мәзіріндегі Modules-ті басыңыз. Модульдер тізімінде 7-ші Storage модуліне түсіп, Lab 4 - Working with EBS белсенділігін ашыңыз. Сілтемені басқаннан кейін зертханалық жұмыстың негізгі парақшасы ашылады. Сіз мұны парақшаның жоғарғы жағынан көре аласыз. Сондай-ақ, “Start lab” батырмасын басу арқылы аккаунтты инициализациялауды бастауға болады. Сонымен қатар, зертханалық жұмыстың тапсырмаларын оқу ыңғайлы болу үшін Terminal терезесін жасырып, сәйкесінше README терезесін қалдырайық.
Бұл зертханалық жұмыста біз Amazon EBS сервисі туралы көбірек білетін боламыз. Зертханалық жұмыстың аясында осы сервиспен жұмыс істеу кезіндегі ең негізгі әрекеттерді орындайтын боламыз, атап айтқанда, EBS volume-ді қалай құру керек, содан кейін бұл volume-ді  EC2 instance-қа қалай бекітуге болатынын үйренеміз, содан соң снапшоттардың біздің volume-нан қалай жасалатынын және снапшот арқылы қалпына келу процесі қалай жұмыс істейтінін көреміз, атап айтқанда, снапшот арқылы жаңа volume құру және осы volume-ді EC2 instance-қа бекіту. Осы зертханалық жұмысты сәтті аяқтау үшін сізден Amazon EC2 сервисінің қалай жұмыс істейтіні туралы базалық түсіну талап етіледі. Amazon EC2 сервисімен алдыңғы зертханаларда және дәрістерде танысқандықтан, бізге осы зертханалық жұмысты орындау қиын болмайды. Осы зертханалық жұмысқа жалпы 30 минут бөлу ұсынылады. Есіңізде болсын, егер сізге көбірек уақыт қажет болса, сіз әрқашан есептеуішіңізді жаңартып, қосымша 30 минут ала аласыз. Сондай-ақ, біз сессия үшін арнайы құрылған AWS құм жәшігінде жұмыс істейтінімізді еске салғым келеді. Бұл дегеніміз, ол шектеулі және барлық сервистер құм жәшігінде қол жетімді емес дегенді білдіреді. Зертханалық жұмыстың аясында пайдалануға болатын сервистер мен осы сервистер ішіндегі мүмкіндіктерге ғана қол жеткізе аласыз.
Зертханалық тапсырмаға өтпес бұрын Amazon Elastic Block Store-дің не екенін есімізге түсірейік. Оны басқаша Amazon EBS деп жиі атайды. Бұл сізге EC2 инстансына бекіту үшін қатқыл дискілерді ұсынатын сервис. Олар Root volume ретінде әрекет етеді, яғни бұл операциялық жүйені орнатуға болатын қатқыл дискілер. EBS сонымен қатар Data volume  ретінде, яғни жеке, нақты Root volume-ге тәуелсіз қатқыл диск ретінде әрекет ете алады, онда сіз өзіңіздің қосымшаңыздың деректерін сақтай аласыз. EBS бізге кіріктірілген сенімділік береді. Идея мынада, біздің қатқыл дискіміз жасалған availability аймағында деректер қайталанады. Осылайша, аппараттық құрал деңгейдегі мәселелер бізді айналып өтіп, AWS жағында ашық түрде ауыстырылады. Сондай-ақ, біз қатқыл дискілер күйінің көшірмелері болып табылатын снапшоттарды жасай аламыз және оларды Amazon S3 сервисінде сақтай аламыз. Біздің есімізде болар, Amazon S3 сервисі өте сенімді және жоғары қол жетімді сервис болып табылады. Неге? Өйткені Amazon S3 жағында бірнеше availability zone-да көшірілу орын алады. Осылайша сіз деректеріңізді қатқыл дискілерде қауіпсіз және қол жетімді сақтауыңызға болады. Тағы бір мүмкіндік – қатқыл дискілердегі снапшоттардың бірдей көшірмелерінен сіз жаңа қатқыл дискіні оңай қалпына келтіріп, жасай аласыз, содан кейін оны жаңа EC2 инстансына бекіте аласыз. Қатқыл дискілер өлшемі 1 ГБ-тан 16 терабайтқа дейін болуы мүмкін. EBS volume – қатқыл дискілермен жұмыс істеу үшін өте ыңғайлы сервис. Сіз құрасыз, EC2 инстансына бекітесіз, бэкап жасайсыз, қалпына келтіресіз, жоясыз және қажет болған жағдайда олардың өлшемін өзгертуіңізге болады.
Біріншіден, біз  AWS Management Console-ге жетуіміз керек. Одан соң “Start Lab” батырмасын басуымыз қажет. «Lab Status: Ready» хабарламасын көргеннен кейін, сіз қалқымалы терезені жауып, AWS батырмасын басуыңызға болады. Оны басқаннан кейін сіз уақытша жасалған AWS Account-қа қайта бағытталып, AWS Management Console-дің басты парақшасына түсесіз. Бірінші тапсырма – бізге жаңа EBS volume құру керек. Ол үшін сервисті іздеу жолағына EC2 деп енгізе бастайық. Әрі қарай, біз тиісті сервиске сілтеме көреміз, сол жаққа өтеміз. AWS Account-та инстанстардың тізімін көру үшін сол жақ навигация мәзірінде Instances қойындысына басамыз. Аймақ NorthVirginia болуы керек екенін ескеріңіз және сіз Lab деп аталатын кем дегенде бір EC2 инстансын көресіз. Осы EC2 инстансының метадеректерін қарастырайық және осы инстанстың availability аймағы us-east-1a екеніне көз жеткізейік. Availability аймағының сіз үшін айырмашылығы болуы мүмкін, сіз осы Availability аймағын есте сақтауыңыз керек, себебі жаңа EBS volume құру кезінде біз оны осы Availability аймағында жасаймыз. Біз мұны жасағаннан кейін, сол жақ навигация мәзірінен Volumes-ті таңдауымыз керек. Ашылған тізімде біз барлық қол жетімді қатқыл дискілерді біздің AWS Account-та және тиісті аймақта көреміз. Lab атты инстансына бекітілген 8 ГБ-тық volume бар екенін көресіз.
Енді біз 1 ГБ-тық өлшемі бар жаңа EBS volume жасаймыз. Ол үшін біз Create volume батырмасын басуымыз керек. Әрі қарай, Volume Type ретінде біз General Purpose SSD немесе gp2-ді таңдау керекпіз. Өлшем ретінде 1 ГБ таңдау қажет және Availability аймағы ретінде біздің EC2 орналасқан Availability аймағын таңдау керек. Сондай-ақ  тегтерді қосайық, Key ретінде Name-ді және Volume ретінде My volume-ді қосайық.Create volume батырмасын басыңыз. Осы батырманы басқаннан кейін сіз EBS volume тізімі бар парақшаға  бағытталасыз, сіз тағы бір жаңа жол пайда болғанын және күй Creating болғанын көресіз. Біраз уақыт күтіп, Refresh батырмасын басайық. Біраз уақыттан кейін күй Available болып өзгереді, яғни біздің EBS volume пайдалануға дайын және оны EC2 инстансына бекітуге болады дегенді білдіреді. Енді жаңадан құрылған EBS volume-ді біздің EC2 инстансымызға бекітейік. Мұны істеу үшін  EBS volume тізімінде “My volume” атты volume-ді таңдауымыз керек. Содан кейін Actions ашылмалы мәзіріндегі Attach volume пәрменін таңдаңыз. Қосымша терезе ашылады және сіз Instance өрісінде біздің Lab атты инстансты таңдауыңыз керек. Device өрісінде /dev/sdf мәні тұрғанын ескеріңіз. Бұл біздің келесі тапсырмаларымызда қажет болатын volume-імізді орнатудың жүйелік жолы. Енді EC2 инстансымызға бекіту үшін Attach volume батырмасын басайық. Оны басқаннан кейін, volume-нің күйі In-use екенін көресіз, яғни EC2 инстанстарының біріне бекітілген.
Жақсы, біз зертханалық жұмысымыздың үшінші бөлігіне жеттік. Бұл жерде бізге EC2 инстансына қосылу керек. Егер сізде Windows операциялық жүйесі орнатылған болса, сіз қазір жасалатын нұсқауларды орындауыңыз керек. Төменде біз Mac OS немесе Linux операциялық жүйелері бар пайдаланушыларға арналған нұсқауларды қарастырамыз. Ең алдымен, біз зертханалық жұмысымыздың мәзірінде Details батырмасын басуымыз керек. Қалқымалы мәзір ашылғаннан кейін ондағы “Show” батырмасын басыңыз. Бұл жерде біз үшін уақытша жасалған AWS аккаунтына қосылуға қажетті барлық credentials-тер мен қажетті деректер көрсетіледі. Енді қазір Download PPK батырмасын басып, Labuser.ppk файлын компьютерде сақтауымыз керек. Labuser.ppk файлы – бұл SSH арқылы біздің EC2 инстансымызға қауіпсіз қосылуға мүмкіндік беретін арнайы файл. AWS жағында, Lab атты инстансты жасаған кезде, SSH кілті ретінде labuser.ppk көрсетілген, нақты бұл файл емес, осы private-кеу-ге бекітілген жалпыға ортақ кілт. Осылайша сіз осы labuser.ppk бар инстансқа тікелей қосылғанда, ол бізге қол жетімділік береді және бізді жүйеге қосады.
SSH арқылы қосылу үшін бізге тиісті бағдарлама қажет. Ең танымал бағдарлама – PuTTY. Егер сізде ол орнатылмаған болса, мен сізге сілтеме арқылы өтіп, осы бағдарламаны орнатып алуды ұсынамын. Бағдарламаны орнатқаннан кейін, оны іске қосып, тиісті деректерді енгізуді бастауыңыз керек, нақтырақ айтқанда, Connection қойындысында сіз Seconds between keepalives өрісінде 30 деп көрсетуіңіз керек. Бұл біздің сессиямызды ұзақ ашық ұстауға мүмкіндік береді.
Әрі қарай, Session қойындысында Host Name немесе IP-address өрісінде біз EC2 инстансымыздың жалпыға ортақ IPv4 адресін енгізуіміз керек. Әрі қарай, қойындылар тізімінде SSH өрісін кеңейту керек, сол жерде Auth қойындысын таңдаңыз, яғни Authorization, және ашылған терезеде біздің кілтті таңдау үшін Browse батырмасын басу қажет. Сіз оны басасыз, файлдарды іздеу ашылады және сіз өзіңіздің файлыңызды сақтаған тиісті жолмен өтіп, labuser.ppk файлын таңдаңыз. Сіз оны таңдағаннан кейін, Open батырмасын басып, таңдауыңызды сақтап, бағдарлама жолының негізгі терезесінде Open батырмасын қайтадан басыңыз. Ол біздің EC2 инстансымызға қосылуды инициализациялайды, мұның алдында біз осы хостқа шынымен қосылғымыз келетінін білу үшін арнайы терезе пайда болады. Ия, біз Yes батырмасын басамыз.
Сіз оны басқаннан кейін командалық жол ашылады, бірінші кезекте сізден сіз қосылатын пайдаланушының логині сұралады. AWS ішінде жасалған линукстық EC2 инстанстары үшін, әдепкі пайдаланушы аты болып табылатын ec2-user-ді енгізу керек.
Енді сіздің жергілікті компьютерде немесе ноутбукта Mac OS немесе Linux операциялық жүйелері орнатылған жағдайдағы нұсқауларды қарастырайық. Бірінші қадам – Details ашылмалы мәзірін ашып, содан кейін Show батырмасын басып, кілтімізді жүктеу керек. Біздің жағдайда labsuser.pem файлын жүктейміз.
Әрі қарай, терминалды ашып, біздің pem файлымыз сақталған жолмен өтіңіз. Ол әдетте Downloads папкасында сақталады, сондықтан cd деп, яғни change directory, және Downloads папкасына жолды терсеңіз жеткілікті. Әрі қарай, біз жаңа файлға тиісті файлдық жүйенің құқықтарын беруіміз керек, атап айтқанда chmod 400 labsuser.pem. Енді біз AWS Management Console-ге, біздің EC2 инстансқа өтіп, оның жалпыға ортақ IPv4 адресі қандай екенін көруіміз қажет.
Біз оны қарағаннан кейін, бұл мәнді 28-ші қадамда көрсетілген командаға енгіземіз, яғни ssh-i labsuser.pem – бұл біздің кілтіміз бар файл. Әрі қарай, орын (пробел) қалдырып ec2-user@ және біздің IP-адресімізді жазамыз. Мұнда біз алдын-ала ec2-user пайдаланушысы ретінде қосылатынымызды айтамыз. Осы жолды дайындағаннан кейін Enter басамыз, сол кезде біз осы серверге шынымен сенетініміз және қосылғымыз келетіні туралы хабарлама аламыз. «Yes» батырмасын басыңыз, содан кейін бізді осы серверге жібереді, сонда тиісті командалық жолы ашылады.
Келесі тапсырма – EC2 инстансындағы жаңа қатқыл дискінің конфигурациясын аяқтау керек. Ол үшін біз EC2 инстансына қосылғаннан кейін, df -h командасын іске қосуымыз керек. Мұнда біз барлық қол жетімді файлдық жүйелерді көре аламыз. Сондай-ақ, бізде /dev/xvda1 атында 8 ГБ-тық түбірлік қатқыл диск бар екенін көрумізге болады. Естеріңізде болар, біз 1 ГБ қатқыл дискіні құрған болатынбыз және ол дәл қазір бұл тізімде жоқ. Біз не істеуіміз керек? Бұл қатқыл дискіні қол жетімді ету үшін бірнеше командалардың  жиынтығын іске қосу керек. Сізде неліктен қатқыл дискіні AWS Management Console жағында бекіткеннен кейін ол EC2 инстанс жағында пайда болмады деген сұрақ туындауы мүмкін. Ия, бұл жақсы сұрақ. Мұны түсіндіріп берейін. Қатқыл дискіні AWS Management Console жағында бекіткеннен кейін, оны сұранысты жіберу ретінде қабылдауыңызға болады және осыдан кейін қатқыл диск EC2 инстансына қосылуға қол жетімді болады. Қосылып, оны сәйкес күйге келтіргеннен кейін, сіз бұл сұранысты қабылдаған сияқты боласыз, яғни сіз қолжетімді қатқыл дискіні өзіңіздің файлдық жүйеңізге бекітесіз және ол жұмыс жасауға қолжетімді болады. Ең бірінші, біз қатқыл дискінің  алдыңғы парақшада сақтаған мәндерін, бұл/dev/sdf , оны 31-ші қадамдағы командалық жолға қойыңыз. Бұл жерде біз жаңа файлдық жүйемізді көрінетін етіп жасаймыз және бар файлдық жүйелерге қосыламыз.
Әрі қарай, біз қатқыл диск орнатылатын папканы жасауымыз керек. Мұны істеу үшін 32-қадамда папканы құрамыз және 33-қадамда операциялық жүйемен қабылданған қолжетімді қатқыл дискіні орнатқымыз келетін папкаға бекіту керекпіз. Ол үшін 33-қадамдағы бірінші команданы іске қосамыз. Әрі қарай, егер біз Linux EC2 Instance бағдарламасын қайта жүктесек, барлық қосымша қатқыл дискілер бастапқы қалпына келтіріледі. Егер біз инстансты іске қосқан кезде қосымша қатқыл дискілерді автоматты түрде бекіткіміз келсе, 33-қадамдағы екінші команданы іске қосуымыз қажет. Бұл команданың идеясы – осы команданы біз бекіту үшін енгіземіз және бұл команданы автожүктеу файлында сақтаймыз. Бұл /etc/fstab. Бұл қайта жүктеу кезінде және жүйе басталған кезде іске қосылатын барлық командаларды сақтайтын файл.
Бұл файлдың мазмұнын 34-ші қадамдағы командамен көруге болады, яғни cat /etc/fstab. Біз не істеуіміз керек? Егер біз df –h деп енгізсек, жаңа жазбаны көреміз және файлдық жүйе тізімінде жаңа 1 Гб-тық қатқыл дискіні көреміз. Ол/dev/xvdf деп аталатын болады.
Енді тәжірибе жасап, жаңа қосымша қатқыл дискімізде файл жасайық. Ол үшін 36-шы қадамдағы команданы іске қосыңыз және қосымша осы жаңадан жасалған файлдың мазмұнын 37- шы қадамдағы командамен шығаруға тырысайық. Оны іске қосқаннан кейін сіз 36-шы қадамда көрсеткен мазмұнды көресіз. Егер бәрі дұрыс жұмыс істесе, біз бәрін дұрыс жасадық деген сөз және біздің жаңа Data volume біздің EC2 инстансқа сәтті бекітілген және толығымен конфигурацияланған дегенді білдіреді.
Біз снапшоттар жасайтын келесі тапсырмаға көшеміз. Ол үшін біз AWS Management Console-да EC2 сервисіне көшуіміз керек. Бұл сервисте сол жақ навигация мәзірінен Volumes қойындысын таңдаңыз. Сіз біздің уақытша AWS аккаунтындағы барлық қатқыл дискілер тізімін көресіз. Бізге My volume деп аталатын  алдында жасаған EBS volume-ді таңдау керек. Бұл қатқыл дискіде тек бір файл бар екені есімізде. Осы volume-ді таңдағаннан кейін Actions батырмасын басып, ашылмалы мәзірдегі Create snapshot батырмасын басу керек.
Біздің снапшотымыздың деректерін енгізетін қосымша терезе ашылады. My Snapshot  мәніндегі Tag name қосып, Create snapshot батырмасын басыңыз. Сіз EBS volumes тізімі бар алдыңғы парақшаға қайта өтесіз. Енді сізге сол жақ навигация мәзіріндегі Snapshots қойындысын басу керек. Сол кезде осы AWS аккаунтындағы снапшоттар тізімі көрсетіледі. Біздің снапшот мәртебесі Pending деп тұрғанын көресіз. Бұл біздің снапшотымыз жасалып жатқанын көрсетеді. Егер біраз уақыттан кейін парақшаны жаңартатын болсақ, онда күй Completed деп өзгергенін көреміз. Бұл біздің снапшотымыз сәтті жасалғанын және сіз осы снапшоттан қалпыңызға келе аласыз дегенді білдіреді.
Енді келесідей жасайық. Біздің EC2 инстансымызға ашылған SSH сессиясында құрылған txt файлын жоямыз. Әрі қарай, біз тексеру жасаймыз. /mnt/data-store/ жолының мазмұнын көрейік. Мұнда біз қатқыл дискідегі барлық файлдар мен папкалардың тізімін көреміз. Сіз бос тізімді көруіңіз керек, яғни бұл EC2 инстанста, яғни біз жасаған volume-де ешқандай файлдар жоқ дегенді білдіреді. Біз жасаған файлды біз біздің снапшотта сақтадық. Енді біз келесі тапсырмада снапшотымызды қалпына келтіріп көреміз және снапшоттағы бұл файлдың жаңадан жасалған қатқыл дискіде көрінетініне көз жеткіземіз.
Біз зертханалық жұмыс аясындағы соңғы тапсырмаға келдік. Бұл жерде біз жаңадан жасалған снапшотты қалпына келтіреміз. Мұны істеу үшін AWS Management Console-де EC2 сервисіне өтуіміз керек. EC2 сервисінде сол жақ навигация мәзірінде Snapshots қойындысына өтіңіз. Снапшоттар тізімінен My Snapshot-ты таңдаңыз.
Содан кейін, Actions ашылмалы мәзірде Create Volume From Snapshot батырмасын таңдаңыз. Тиісті терезе ашылады. Сіз дұрыс availability zone енгізіп, Tag Name көрсетуіңіз керек. Сондай-ақ біз volume-дерді өзара ажырата алу үшін Value мәні Restored volume болады. Снапшоттан жаңа қатқыл дискіні жасаған кезде оның параметрлерін өзгертуіңізге болады. Атап айтқанда, сіз қатқыл дискінің типін, оның өлшемін өзгерте аласыз, сондай-ақ оны жаңа, сіздің аймағыңыздың аясында басқа availability zone-да жасай аласыз.
Жаңа volume жасағаннан кейін, сол жақ навигация мәзіріндегі Volumes тармағына өтейік. Сол кезде Restored Volume деп аталатын жаңа volume жасағанымызды көреміз. Енді біз оны таңдауымыз керек, содан кейін Actions ашылмалы мәзірін басыңыз, содан кейін Attach volume опциясын таңдаңыз. Яғни, біз қалпына келтірілген қатқыл дискіні Lab деп аталатын инстансқа бекітеміз. Назар аударыңыз, бекіту кезінде біздің қатқыл дискінің жүйелік жолы, яғни/dev/sdg көрсетіледі. Attach volume батырмасын басыңыз. Әрі қарай, біздің volume-із available  күйінен In-use күйіне өткенін күтуіміз керек, яғни ол EC2 инстансына бекітіледі. Енді біз қатқыл дискімен басында жасаған барлық қадамдарды жасап, жаңа қатқыл дискіні /mnt/data-store2/path жолына орнатуымыз керек. Барлық әрекеттерді орындағаннан кейін, осы папканың мазмұнын көрсетейік. Сіз бұл команданы 55-ші қадамда көресіз. Бұл ls /mnt/data-store2/. Осы команданы іске қосқаннан кейін файлдар мен папкалардың тізімін көресіз. Біздің жағдайда file.txt деп аталатын жалғыз файлды көруіміз керек. Егер барлығы осылай болса, біз тапсырманы сәтті орындадық, қалпына келтірілген қатқыл дискімізді EC2 инстансына бекіттік және сол қатқыл дискінің мазмұнын көрсете алдық.
Осымен зертханалық жұмысымыздың соңына жеттік. Біз Amazon EBS сервисіне байланысты барлық белгілі іс-әрекеттерді жасадық. Енді біз зертханалық жұмысымызды AWS Academy жағында дұрыс аяқтауымыз керек, ол үшін End Lab батырмасын басып, зертханалық жұмысымызды аяқтағанымызды растайтын «DELETE has been initiated… You may close this message box now» хабарламасын көреміз. Бұл сіз үшін жасалған AWS аккаунтын жою процесі басталғанын білдіреді және сіз осы терезені жауып, AWS Academy-ден шыға аласыз. Біз солай жасаймыз. Сіз қалқымалы терезені жауып, AWS Academy парақшасын жаба аласыз.
Осымен біз Amazon EBS сервисін толығырақ қарастырдық. Сізде бұл сервис туралы жақсы түсінік қалыптасты деп үміттенемін. Назарларыңызға рахмет! Келесі белсенділіктерімізде кездескенше!

