 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередной сессии обзора лабораторной работы. Сегодня мы с вами чуть ближе познакомимся с сервисом EBS. Окей, давайте начнем. Для того, чтобы добраться до соответствующей лабораторной работы, нам необходимо открыть AWS Academy, главную страницу и курс Academy Cloud Foundations. Далее в левом навигационном меню нажимаем modules. В списке модулей необходимо прокрутить до 7-го модуля storage и открыть активность lab4 working with EBS. Как только вы переходите по ссылке, открывается основная страница лабораторной работы. Вы это можете увидеть в самом верху страницы. Вы можете также запустить инициализирование аккаунта для вас, нажав кнопку start lab. А также для того, чтобы удобнее читать задания лабораторной работы, давайте скроем окно терминал и, соответственно, оставим окно с readme. В этой лабораторной работе мы подробнее познакомимся с сервисом Amazon EBS. В рамках лабораторной работы проделаем вместе с вами самые основные действия при работе с этим сервисом, а именно научимся создавать EBS volume, далее научимся привязывать этот volume к EC2 instance. Далее посмотрим, как создается снапшоты от наших volume и рассмотрим, как происходит процесс восстановления из снапшота, а именно создание нового volume из снапшота и привязка этого volume к EC2 instance. Для того, чтобы успешно завершить эту лабораторную работу, ожидается от вас базовое понимание работы сервиса Amazon EC2. Так как с сервисом EC2 мы познакомились с вами на предыдущих лабораторных работах и лекциях, то прийти к этой лабораторной работе вам не составит труда. Всего на эту лабораторную работу рекомендуется выделить 30 минут. Вы помните, что если вам нужно больше времени, вы всегда можете обновить счетчик и получить дополнительные 30 минут. Также напоминаю, что мы работаем в песочнице AWS, который специально для нашей сессии временно была создана. Это говорит о том, что оно ограничено и не все сервисы доступны в рамках этой песочницы. Вы можете обратиться только к тем сервисам и к тому функционалу внутри этих сервисов, которые ожидается использовать в рамках лабораторной работы. Перед тем как мы перейдем к заданию лабораторной работы, давайте освежим в памяти, что же такое сервис Amazon Elastic Block Store. По-другому и чаще ее называют Amazon EBS. Это тот сервис, который предоставляет вам жесткие диски для последующей привязки к EC2-инстансам. Выступают в роли root volume, то есть это те жесткие диски, на которых вы можете установить операционную систему. Также EBS может выступать как Data volume, то есть отдельно настоящий, независящий от root volume жесткий диск, на котором вы можете хранить данные ваших приложений. EBS предоставляет нам встроенную надежность. Идея в том, что в рамках той availability зоны, где наш жесткий диск был создан, данные реплицируются. Таким образом, проблемы на уровне железа, они обходят нас стороной и прозрачно для нас заменяются на стороне AWS. Мы можем также создавать снапшоты, то есть копии состояния наших жестких дисков и сохранять сервисы Amazon S3. Как мы с вами помним, S3 еще более надежный и высоко доступный сервис. Почему? Потому что на стороне S3 происходит репликация на несколько availability zone. Таким образом, вы можете надежно и доступно хранить ваши данные в жестких дисках. Другой функционал – это с тех же копии снапшотов в жестких дисках вы достаточно легко можете восстановить и создать новый жесткий диск и дальше ее привязать к новому EC2 инстенсу. Размеры жестких дисков могут быть от 1 ГБ до 16 ГБ. EBS volume – это достаточно удобный сервис для работы с жесткими дисками. Вы создаете, привязываете к EC2 инстенсам, делаете бэкапы, восстанавливаете, удаляете. Также можете изменять ее размеры по необходимости. Самым первым делом нам необходимо добраться до AWS Management консоли. Нам необходимо нажать на кнопку Start Lab. После того, как вы увидите сообщение Lab Status Ready, вы можете закрыть всплывающее окно и нажать на кнопку AWS. Как только вы на нее нажимаете, вас перенаправляет на временно созданный AWS Account и вы попадаете на главную страницу AWS Management консоли. Первое задание нам необходимо создать новый EBS volume. Для этого в строке поиска сервисов давайте начнем вводить EC2. Далее мы увидим ссылку на соответствующий сервис и перейдем туда. В левом навигационном меню нажмем на Instances, чтобы отобразить список существующих инстанцев на нашем временном AWS Account. Обратите внимание, что регион должен быть нож свержения и там вы увидите как минимум 1 EC2 instance, который называется Lab. Давайте посмотрим на метаданные этого EC2 instance и убедимся, что availability зона этого instance она US East 1A. Availability зона она для вас может отличаться, что важно вам необходимо запомнить эту availability зону, чтобы при создании новой EBS volume мы создали в той же availability зоне. Как только мы это сделаем, нам необходимо в левом навигационном меню выбрать volumes. В открывшемся списке мы увидим все доступные жесткие диски на нашем AWS Account и соответствующем регионе. Вы увидите, что есть volume размера 8 ГБ, который привязан к instance с названием Lab. Мы сейчас будем создавать новый EBS volume с размером 1 ГБ. Для этого нам необходимо нажать на кнопку Create volume. Далее как volume type нам необходимо выбрать General Purpose SSD или GP2. Как размер необходимо выбрать 1 ГБ и как availability зона выбрать ту availability зону, где находится наш EC2 instance. Давайте добавим также теги, как t добавим name и как volume добавим my volume. Нажмем на кнопку Create volume. После того, как вы нажмете на эту кнопку, вас перенаправят на страницу со списком EBS volume, вы увидите, что появится еще одна новая строчка и статус будет creating. Давайте подождем некоторое время и нажмем на кнопку refresh. Через некоторое время статус сменится на available, что говорит о том, что наш EBS volume готов к работе и может быть привязан к EC2 instance. Теперь давайте привяжем новый созданный EBS volume к нашему EC2 instance. Для этого в списке EBS volume нам необходимо выбрать volume с названием my volume. Далее в выпадающем меню actions необходимо нажать на пункт attach volume. Откроется дополнительное окно и в нем необходимо в поле instance выбрать наш instance с названием lab. Обратите внимание, что в поле device стоит значение slash def slash sdf. Это системный путь монтирования нашего volume, который нам понадобится в следующих наших задачах. Теперь давайте нажмем на кнопку attach volume для того, чтобы привязать к нашему EC2 instance. Как только вы ее нажмете, вы увидите статус у этого volume как in use. То есть привязан к одному из EC2 instance. Отлично, мы с вами добрались до третьей части нашей лаборторной работы. Здесь нам необходимо подключиться к нашему EC2 instance. Если у вас установлена операционная система Windows, то вам необходимо следовать инструкциям, которые мы пройдем сейчас. Чуть ниже мы также рассмотрим инструкции, предназначенные для пользователей с операционной системой Mac OS или Linux. Самым первым делом нам необходимо в меню нашей лаборторной работы нажать на кнопку details. Раскроется выпадающее меню и там необходимо нажать на кнопку show. Здесь отобразятся все credentials и необходимые данные для подключения к временно созданному для нас AWS аккаунту. Нам необходимо сейчас нажать на кнопку download PPK и сохранить labuser.ppk file где-нибудь на компьютере. Labuser.ppk file это специальный файл, который позволяет нам безопасно подключаться по SSH к нашему EC2 instance. В стороне AWS при создании инстанца с названием lab указывался как SSH ключ именно labuser.ppk, а именно не этот файл, а публичный ключ привязанный к этому private ключу. Таким образом, когда вы подключаетесь напрямую к этому инстанцу с labuser.ppk, он дает доступ и запускает нас в систему. Для того, чтобы подключаться по SSH, нам необходима соответствующая программа. Самая популярная программа это PUTTI. Если она у вас не установлена, то рекомендую вам перейти по ссылке и установить эту программу. Как только вы установили программу, необходимо ее запустить и начать вводить соответствующие данные, а именно во вкладке connection необходимо в поле seconds between keepalives указать как 30. Это позволит держать нашу сессию открытой дольше. Далее нам необходимо во вкладке session в поле hostname или IP-адрес ввести публичный IPv4 адрес нашего EC2 инстанца. Далее нам необходимо в списке вкладок раскрыть SSH, далее там выбрать под вкладку auth, то есть authorization, и в открывшемся окне необходимо нажать на кнопку browse для того, чтобы выбрать наш ключ. Вы ее нажимаете, открывается поиск файлов, и вы по соответствующему пути, куда вы сохранили ваш файл, добираетесь и выбираете labuser.ppk file. Как только вы ее выбрали, необходимо нажать на кнопку open и сохранить ваш выбор, и далее нажать на кнопку open еще раз уже на основном окне программы пути. Оно инициализирует подключение к нашему EC2 инстанцу, и перед этим выйдет соответствующее окно, действительно ли мы хотим подключиться к этому хосту. Да, мы нажимаем на кнопку yes. Как только вы на нее нажимаете, открывается командная строка, и первым делом запросят у вас логин пользователя, к которому вы подключаетесь. Необходимо ввести EC2-User, это название пользователя по умолчанию в линуксовых EC2 инстанциях, созданных внутри AWS. Давайте теперь рассмотрим инструкции в случае, если на вашем локальном компьютере либо ноутбуке установлена операционная система macOS либо Linux. Первым делом необходимо раскрыть выпадающее меню details, далее нажать на кнопку show и скачать наш ключ. В нашем случае необходимо скачать labuser.pem файл. Далее открыть терминал и перейти по тому пути, где сохранен наш pem файл. Обычно сохраняется в папке downloads, поэтому достаточно ввести CD, то есть change директория и путь до папки downloads. Далее нам необходимо выдать соответствующие права файловой системе нашему новому файлу, а именно chmod 400 labuser.pem. Теперь нам необходимо перейти в AWS Management консоль, а именно на наш EC2 инстанс и посмотреть, какой же у него публичный IPv4 адрес. Как только мы ее посмотрели, нам необходимо это значение вставить в команду, указанную на 28-м шаге, а именно ssh-i labuser.pem, то есть это файл, который содержит наш ключ. Далее через пробел EC2 user собачка и наш IP адрес. EC2 user, здесь мы сразу заранее говорим, что мы подключаемся под пользователем EC2-user. Как только вы подготовили эту строчку, нажимаем на Enter, выйдет также сообщение о том, действительно ли мы хотим подключиться и доверяем этому серверу. Нажимаем на кнопку Да, после чего нас перебрасывает на этот сервер и открывается соответствующая командная строка. Следующее задание, нам необходимо завершить конфигурацию нового жесткого диска на стороне EC2-инстанса. Для этого, после того, как мы подключаемся к нашему EC2-инстанцу, необходимо запустить команду df-h. Здесь мы видим все доступные файловые системы. Также вы можете видеть, что у нас под //dev//xvda1 находится корневой жесткий диск размером 8 ГБ. Как вы помните, мы создавали жесткий диск размером 1 ГБ и он сейчас не присутствует в этом списке. Что нам необходимо сделать? Нам необходимо запустить набор из нескольких команд для того, чтобы сделать этот жесткий диск доступным. У вас, возможно, возникнет вопрос, почему после привязки жесткого диска на стороне AWS Management Console этот жесткий диск не появился на стороне EC2-инстанца? Да, это хороший вопрос. Давайте поясню. Как только вы делаете привязку жесткого диска на стороне AWS Management Console, вы можете представить это как отправка запроса, после чего этот жесткий диск становится доступным для подключения к EC2-инстанцу. После того, как вы подключаетесь и проводите соответствующую настройку, вы как бы принимаете этот запрос, а именно доступный жесткий диск привязываете к вашей файловой системе и оно становится доступным для работы. Самым первым делом нам необходимо взять значения, которые мы запомнили на странице с жестким диском, это slash def slash sdf и вставить в команду в шаге 31. Здесь мы делаем видимым и подключаем к существующим файловым системам нашу новую файловую систему. Далее нам необходимо создать папку, к которой будет монтироваться наш жесткий диск. Для этого создаем папку в шаге 32 и в шаге 33 нам необходимо наш доступный жесткий диск принятой системой, операционной системой привязать к той папке, куда мы хотим ее смонтировать. Для этого запускаем команду, первую команду в шаге 33. Далее, если мы перезагружаем наш Linux EC2-Instance, то все дополнительные жесткие диски они сбрасываются. Если мы хотим при автозапуске, при запуске инстанца автоматически привязывать дополнительные жесткие диски, нам необходимо запустить вторую команду в шаге 33. Идея этой команды в том, что мы вводим команду для привязки и сохраняем эту команду в файле с автозагрузкой. Это slash etc, slash fstab. Это тот файл, в котором хранятся все команды, которые запускаются при перезагрузке и когда система стартует. Вы можете посмотреть содержимое этого файла с командой в шаге 34, то есть cat, slash etc, slash fstab. Что нам необходимо сделать? Теперь, если мы введем df-h, мы увидим новую запись и увидим новый жесткий диск размером 1 гигабайт в списке файловых систем. Называться он будет slash def, slash xvdf. Теперь давайте поэкспериментируем и создадим файл в нашем новом дополнительном жестком диске. Для этого запустим команду в шаге 36 и дополнительно попробуем вывести содержание этого нового созданного файла с командой в шаге 37. Как только вы ее запустите, вы увидите тоже содержание, что вы указали в шаге 36. Если все сработало правильно, значит мы все действия произвели корректно и наш новый data volume успешно был привязан и полностью настроен с нашими sudo-instances. Мы с вами переходим к следующему заданию, а именно создание снапшота. Для этого нам необходимо в AWS Management Console перейти на сервис EC2. В этом сервисе в левом навигационном меню выбрать меню volumes. Вы увидите список всех жестких дисков на нашем временном AWS аккаунте. Нам необходимо выбрать нами ранее созданный EBS volume, который называется my volume. Мы с вами помним, что в этом жестком диске есть только один единственный файл. Как только вы выбрали этот volume, необходимо нажать на actions и в выпадающем меню нажать на кнопку create snapshot. Откроется дополнительное окно, где необходимо ввести данные нашего снапшота. Давайте добавим tag name со значением my snapshot и нажмем на кнопку create snapshot. Вы перейдете обратно на предыдущую страницу со списком EBS volumes. Теперь вам необходимо в левом навигационном меню нажать на пункт меню snapshots. И отобразится список снапшотов в этом AWS аккаунте. Вы увидите, что статус нашего снапшота указан как pending. Это говорит о том, что наш снапшот создается. Если через некоторое время мы обновим страницу, мы увидим, что статус поменялся на completed. Это говорит о том, что наш снапшот успешно создан и вы можете восстанавливаться с этого снапшота. Теперь давайте поступим следующим образом. В открытой SSH-сессии к нашему EC2-инстанцу удалим наш созданный файл, файл txt. Далее сделаем проверку. Посмотрим содержание пути slash mount slash datastore slash. Здесь мы отобразим список всех файлов и папок, которые есть в нашем жестком диске. Вы должны увидеть пустой список, что говорит о том, что на этом EC2-инстанце, на конкретно нашем созданном volume, нет никаких файлов. Тот файл, который мы создали, мы сохранили в нашем снапшоте. И теперь мы попробуем в следующем задании восстановить наш снапшот и убедиться, что этот файл в снапшоте отобразится в новом созданном жестком диске. Мы с вами переходим к последнему заданию в рамках лабораторной работы. И здесь мы будем восстанавливать наш новый созданный снапшот. Для этого в AWS Management Console необходимо перейти в сервис EC2. В сервисе EC2, в левом навигационном меню необходимо перейти на пункт меню Snapshots. В списке снапшотов выбрать My Snapshot. И далее в пункте меню Actions, выпадающем меню, выбрать кнопку Create Volume From Snapshot. Отобразится соответствующее окно. Необходимо ввести правильную availability зону и указать tag name. При этом значение будет restored volume, чтобы мы могли различать наши volume между собой. Обратите внимание, что при создании нового жесткого диска из снапшота вы можете менять его настройки. А именно, вы можете поменять тип жесткого диска, можете изменить его размер, а также создать его в новой, другой availability зоне в рамках вашего региона. Как только мы создали наш новый volume, давайте перейдем в левом навигационном меню, в пункт volumes, и мы увидим, что у нас создался новый volume с названием restored volume. Теперь нам необходимо его выбрать и далее нажать на кнопку, выпадающую меню Actions, далее выбрать опцию Attach volume. То есть мы привяжем наш восстановленный жесткий диск к нашему инстанцу с названием Lab. Обратите внимание, что во время привязки указывается системный путь нашего жесткого диска, а именно slash def, slash SDG. Нажимаем на кнопку Attach volume. Далее необходимо дождаться, что наш volume из состояния available перешел в состояние in use, то есть он привязан к истинцу. Теперь нам необходимо проделать все те действия, которые мы проделали в начале с нашим жестким диском, и примонтировать новый жесткий диск к пути slash mount, slash datastore2. Как только мы проделаем все действия, давайте отобразим содержание этой папки. Вы увидите эту команду в шаге 55. Это ls, пробел, slash mount, slash datastore2. Как только вы запустите эту команду, вы увидите список файлов и папок. В нашем случае мы должны увидеть один единственный файл с названием file.txt. Если это так, то мы успешно сконфигурировали, привязали наш восстановленный жесткий диск к нашему истинцу, и смогли отобразить содержание этого жесткого диска. На этом мы подошли к концу нашей лабораторной работы. Мы проделали все самые популярные действия, связанные с сервисом Amazon EBS. Теперь нам необходимо корректно завершить лабораторную работу на стороне AWS Academy, а именно нажать на кнопку end lab, подтвердить, что мы завершаем нашу лабораторную работу, и дождаться, что мы увидим сообщение, delete has been initiated, you may close this message box now. Это говорит о том, что процесс очистки созданного для вас AWS аккаунта начался, и вы можете закрывать это окно и выходить с AWS Academy. Так и сделаем. Вы можете закрыть всплывающее окно и закрывать страницу с AWS Academy. На этом мы подробнее познакомились с сервисом Amazon EBS. Я очень надеюсь, что вы получили более полное представление об этом сервисе. Спасибо за внимание. Увидимся с вами на следующих наших активностях.
