Қайырлы күн, құрметті студенттер! Мен сіздердің барлығыңызды зертханалық жұмысқа шолудың кезекті сессиясында көргеніме қуаныштымын. Бүгінгі зертханалық жұмыстың тақырыбы – Amazon RDS сервисімен танысу. Сонымен, бастайық.
Бастау үшін бізге AWS Academy-ге кіріп, Cloud foundations курсын, кейін модульдер тізімін ашуымыз керек. Модульдер тізімінде Module 8-ді кеңейту керек, сонда сіз Lab 5 - Build a Database Server белсенділігін көресіз. Сілтемені басқаннан кейін сіз негізгі зертханалық жұмыстың басты парақшасына өтесіз. Сіз мұны парақшаның жоғарғы жағында көре аласыз және тексере аласыз. Қаласаңыз, зертханалық құмсалғышты бастауға болады, сонымен қатар Terminal терезесін жасыруды ұсынамын, өйткені ол бізге қажет болмайды және зертханалық жұмыстың тапсырмасын көретін README ғана қалдыруды ұсынамын.
Бүгінгі зертханалық жұмыста біз Amazon Relational Database Service сервисімен жұмыс жасаймыз және тереңірек зерттеуге тырысамыз, сіз оны Amazon RDS ретінде жиі кездестіретін боласыз. Сонымен, Amazon RDS дегеніміз не? Ол бізге не үшін қажет? Қысқаша есте сақтау қабілетімізді сергітейік. Бұл бізге AWS ішіндегі Managed Relational Database ұсынатын сервис. Идеясы – бізге дерекқордың әкімшілік бөлігімен айналысудың қажеті жоқ. Біз тек кейбір кіріс деректерін көрсетеміз және AWS бізге 99% жағдайда сәйкес келетін дайын дерекқорды ұсынады. Бұл Managed Service болғандықтан, біз қолданғанымыз үшін ғана төлейміз, яғни біз дерекқорды баптадық, онымен үш күн жұмыс істедік және оны өшірдік. Бір айдан кейін пайдаланған уақыт ескеріле отырып, тек үш күн үшін ғана төлем шоты келеді. Amazon RDS ең танымал дерекқор қозғалтқыштарын қолдайды. Бұл Oracle, Microsoft SQL Server, PostgreSQL, MySQL және MariaDB. Amazon Aurora қолдауы да бар. Бұл сервис туралы дәрістерімізде бөлек сөйлесеміз.
Бүгінгі зертханалық жұмысымыздың мақсаты – жоғары қол жетімді дерекқорды іске қосу. Әрі қарай, біз веб-серверден біздің дерекқорға қол жеткізуді қамтамасыз етуіміз керек, содан кейін дайын қосымшамен жұмыс істеп, веб-серверден дерекқорға байланыс дұрыс орнатылғанына көз жеткіземіз. Зертханалық жұмысқа шамамен 30 минут жұмсау ұсынылады. Егер сізге көбірек уақыт қажет болса, сіз әрқашан қосымша минут сұрай аласыз. Сізде есептегіш жаңартылады және осылайша сіз зертханалық жұмысты аяқтап үлгересіз.
Келесі слайдта сіз біздің барлық зертханалық жұмысымызда дамып келе жатқан архитектураны көре аласыз және бүгін біз осы архитектураға қосымша IT ресурстарды қосамыз, атап айтқанда Amazon RDS инстанстарын. Ең алдымен, біз AWS Management Console-ге жетуіміз керек. Ол үшін Start Lab батырмасын басамыз. Біздің зертханалық жұмыстарымызға қажетті ресурстарды құру басталады. Барлығы дайын болғаннан кейін сіз "Lab Status: ready" хабарламасын көресіз. Содан кейін қалқымалы терезені жауып, AWS батырмасын басуға болады. Осы батырманы басқаннан кейін сіз AWS Management Console-ге кіресіз және зертханалық жұмыс тапсырмаларын бастауыңызға болады. Біріншіден, біз DB Instance үшін Security Group құруымыз керек. Біз DB Instance құру кезінде Security Group көрсетуіміз керек болғандықтан, біз алдымен Security Group және басқа қажетті ресурстарды құрамыз, содан кейін біз RDS DB Instance құрамыз. Security Group құру үшін AWS Management Console-да сервистерді іздеу жолағында VPC деп теруді бастау керек және тиісті сервиске өту керек. Сол жақ навигация мәзірінде сіз Security Groups мәзір пунктін көресіз. Оны басайық, біздің AWS аккаунтымыздағы барлық Security Groups бар парақша ашылады. Біз жаңа Security Group жасауымыз керек, тиісті батырманы басып, келесі мәндерді, біздің Security Group параметрлерін енгіземіз. Security Group name ретінде біз DB Security Group-ты, Description ретінде Permit access from Web Security Group-ты көрсетеміз, яғни бұл Web Security Group-тан кіруді қамтамасыз ететін Security Group. VPC ретінде зертханалық жұмыс үшін арнайы жасалған Lab VPC-ді көрсетеміз. Төмен жылжытайық, rules параметрлері болады, Outbound және Inbound rules бар, біз Inbound rules қосуымыз керек, ол үшін Add rule батырмасын басып, пайда болған жазба үшін тиісті деректерді енгіземіз. Type ретінде біз MySQL/Aurora (3306) көрсетеміз, бұл дерекқормен жұмыс жасайтын порт. Ал CIDR, IP, Security Group or Prefix List өрісінде біз ресурсты көрсетуіміз керек, біздің жағдайда бұл sg, яғни Security Group, және сіз sg деп тере бастағанда, Security Group тізімі көрсетіледі, сізге Web Security Group таңдау қажет. Біз не істедік? Бізде Amazon EC2 инстанстары орналасқан Web Security Group бар және біз Inbound Rule рұқсаты бар дерекқор үшін Security Group орнатқаннан кейін, яғни Web Security group үшін 3306 портындағы кіріс трафигі, бұл Web Security Group-тың кез келген Amazon EC2 инстансы дерекқормен жұмыс істей алады дегенді білдіреді. Керемет, біз оны жасағаннан кейін жаңадан құрылған ресурсты сақтап, келесі тапсырмаға өтуіміз керек.
Мұнда да біз кейбір алдын-ала параметрлерді жасауымыз керек, атап айтқанда біздің дерекқорымыз үшін Subnet Group құру керек. Subnet Group – бұл бірнеше Subnet-терді біріктіретін Amazon RDS сервисі шеңберіндегі ресурс. Ол үшін біз AWS Management Console-ге өтіп, Amazon RDS сервисін іздеуді бастауымыз керек. Біз Amazon RDS сервисіне көштік, сол жақ навигациялық мәзірде сіз Subnet Groups пунктін көресіз. Қолданыстағы Subnet group тізімін көру үшін оны басайық. Ашылған парақшада, жоғарғы оң жақта, жаңа Subnet Group құруға арналған батырма болады. Оны басып, жаңа парақшада келесі деректерді енгізейік. Name ретінде біз сызықша арқылы DB-Subnet-Group деп, Description ретінде DB Subnet Group және VPC ретінде зертханалық жұмысымыз үшін жасалған – Lab VPC көрсетеміз. Әрі қарай, төменге жылжытамыз және Subnet параметрлеріне арналған бөлімді көреміз. Біз Subnets-терді қосуымыз керек. Ол үшін алдымен біз availability zone таңдаймыз, біздің жағдайда екеуін таңдау керек, бұл us-east-1a және us-east-1b. Біз оны таңдағаннан кейін, таңдау үшін Subnets тізімін кеңейте аламыз. Біз сәйкесінше 16-қадамда көрсетілген CIDR блоктарын таңдауымыз керек. Таңдағаннан кейін, бұл Subnets таңдалған Subnets тізімінде пайда болады. Осы параметрлердің барлығын жасағаннан кейін Create батырмасын басу керек, содан кейін біз DB Instance құру кезінде қолданатын тиісті DB Subnet Group құрамыз.
Біз зертханалық жұмыстың негізгі бөлігіне жеттік және мұнда біз Instance дерекқорларын жасаймыз. Біз Instance дерекқорымызды қолжетімді және сенімді ету үшін Multi-AZ функционалын, яғни Multiple Availability Zones пайдаланамыз. Идея – біз өз Instance-ті екі Availability Zones орналастырамыз. Бірінші Availability Zones негізгі, екіншісі қосымша болып саналады. Негізгі Availability Zone істен шықса, екінші Availability Zone-дағы Instance рөлін өзгертеді және негізгі болып  ауысады. Осылайша, дерекқор қол жетімді болып қалады және дерекқор қосымша пайдаланушыларына ашық түрде тасымалданады. Негізгі Availability Zone дерекқоры қайтадан қол жетімді болғаннан кейін, қайта ауысу орын алады. Мұның бәрін іске асыру үшін біз AWS Management Console-інде Amazon RDS сервисін ашуымыз керек, сол жақ навигациялық мәзірінен Databases таңдап, ашылатын парақшада Create Database батырмасын басу керек. Switch to the new database creation flow мәтіні бар инстанс құруға арналған жаңа парақшасына ауысу ұсынылса, осы нұсқаны таңдауыңыз керек. Егер біз аздап төмен айналдырсақ, бізге бірінші болып дерекқордың қозғалтқышын таңдау ұсынылады. MySQL-ді таңдайық. Келесі бөлім – Settings бөлімі. Біз 4 өрісті толтыруымыз керек. Біріншісі – DB Instance Identifier – lab-db деп жазайық,  Master username-ге main деп жазайық және пароль мен парольді растау үшін lab-password деп жазайық. Келесі бөлім – DB Instance class. Біз инстанс түрін таңдауымыз керек. Burstable classes тобын таңдайық, яғни бұл t классы және нақты бір түрі ретінде біз db.t3.micro таңдаймыз. Бұл зертханалық мақсатта жеткілікті болатын инстанстардың ең кішкентай түрлерінің бірі. Егер сізге инстанстардың қандай топтары бар екенін толығырақ қарау қажет болса, онда сіз бұл туралы біздің дәріс сабағымыздан біле аласыз, сонымен қатар ресми AWS құжаттамасынан көре аласыз. Келесі бөлім – Storage. Біз жадтың қатқыл дискісінің түрін таңдауымыз керек. Біздің жағдайда, бұл SSD және біз 20 деп бөлінген жад ретінде таңдаймыз, яғни біздің дерекқордағы деректер үшін 20 гигабайт бөлінеді. Келесі бөлім – Connectivity. Мұнда біз VPC, атап айтқанда Lab VPC таңдауымыз керек. Әрі қарай жүрейік. Енді біз Security Groups таңдауымыз керек. Мұнда өрісті басқан кезде ашылмалы тізім мәзірі пайда болады және DB Security Group таңдау керек. Әдепкі Security Group таңдалады және оны алып тастау қажет. Келесі параметр – Additional configuration, осы бөлімді кеңейтіп, бірнеше өзгерістер енгізу керек. Initial database name-де Lab деп жазу керек және келесі үш Enable automatic backups, Enable encryption және Enable Enhanced monitoring өрістері үшін құсбелгіні алып тастау керек болады. Сақтық көшірме жасау, шифрлау және бақылау сияқты маңызды мүмкіндіктерді алып тастау идеясы – бұл өзгерістер бізге дерекқорды тезірек құруға мүмкіндік береді. Бұл біздің зертханалық жұмысымыздың аясында қалыпты жағдай. Болашақта, Production ортада дерекқор құрған кезде, сіз осы үш опцияның барлығын қосуыңыз әбден мүмкін. Сондықтан, бұл сәтті атап өту керек. Осы мәндердің барлығын енгізгеннен кейін, ең төменгі жағына түсіп, Create database батырмасын басыңыз. Сіз дерекқор тізімі бар парақшаға жіберілесіз. Біздің дерекқор инстансының парақшасына түсу үшін тізімнен lab-db таңдайық. Дерекқор құру ұзақ уақыт алады. Мүмкіндігінше, біз дерекқор инстансын жасау үшін ұзақ уақыт кететін функционалдылықты алып тастадық. Алайда, дерекқор қол жетімді болғанша 4-5 минут күтуге тура келеді. Деректер қорының күйі біраз уақыттан кейін Modifying күйінен Available күйіне өзгеретінін көресіз. Осы сәтте дерекқор қол жетімді және пайдалануға дайын. Біз сәл төмен жылжып, Connectivity & security бөлімінде Endpoint өрісінің мәнін көшіруіміз керек. Ол 30 қадамда көрсетілгендей келесідей көрінеді. Біз бұл Endpoint-ті жергілікті жерге көшіруіміз керек, өйткені біз оны зертханалық жұмысымыздың келесі бөлігінде қолданамыз.
Біз зертханалық жұмысымыздың ең соңғы бөлігіне жеттік және мұнда дерекқорымызбен өзара әрекеттесуге тырысамыз. Зертханалық жұмысымыздың аясында біз үшін дерекқормен жұмыс істеуге мүмкіндік беретін арнайы қарапайым қосымша жасалды. Осы веб-қосымшаға жету үшін біз EC2 Instance WebServer-ді тауып, оның жалпыға ортақ IP-адресін көшіру керек. Біз оны көшіргеннен кейін, осы қосымшаны ашу үшін осы адрес бойынша өтейік. Бұл қосымша ашылғаннан кейін сізден веб-сервердің IP-адресін енгізу сұралады. Бұрын көшірілген мәндерді қойып, Enter батырмасын басайық. Оны басқаннан кейін, қосымша біздің Amazon EC2 инстансы туралы кейбір ақпаратты көрсетеді. Егер сіз Amazon EC2 инстансы туралы ақпаратты көрсеңіз, бұл қосымша дұрыс жұмыс істеп тұрғанын және біз келесі бөлімге ауыса алатынымызды білдіреді. Келесі бөлімде қосымшаның жоғарғы жағындағы RDS сілтемесін басу керек. Жаңа парақша ашылғаннан кейін сізден дерекқорыңыз туралы деректерді енгізу сұралады, атап айтқанда бұл Endpoint, бұл сіздің дерекқорыңыздың инстансын табудың көшірілген URL-адресі. Сіз бұл мәнді енгізуіңіз керек. Әрі қарай, Database ретінде біз lab, Username ретінде main, Password ретінде lab-password енгіземіз, бұл біз бұрын енгізген құпия сөз, содан кейін Submit батырмасын басамыз. Біз мұны жасағаннан кейін қосымша дерекқор туралы ақпарат алады және келесі парақша ашылады — Address Book, яғни мекенжай кітабы. Бұл жерде сіз мекенжай туралы ақпарат жасау арқылы дерекқормен өзара әрекеттесе аласыз. Мен мұнда қарапайым қосымшаларда UI-интерфейсі арқылы дерекқор ақпаратын тасымалдау тәжірибесі дұрыс емес екенін атап өткім келеді, бұл жерде ол жеңілдетіліп, көбірек интерактив қосылды. Нақты өмірде біз дерекқор туралы ақпаратты Amazon EC2 инстанстары үшін айнымалы орталар арқылы тасымалдаймыз, онда олар осы деректерді қосымшаның кодынан шығарып, дерекқормен тікелей жұмыс істей алады. Мекенжайлар тізімі бар келесі парақша ашылғаннан кейін, бастапқыда бұл тізім бос болады, бірақ сіз батырмаларды басып, осы қарапайым қосымшамен өзара әрекеттесіп, қажетті мекенжайлар санын жасай аласыз, жоя аласыз, өзгерте аласыз және т.б. Осылайша, қосымша дерекқормен жұмыс істейтінін көреміз, дерекқор бұл деректерді сақтайды және EC2 және RDS байланысы дұрыс жұмыс істейді.
Осымен біз зертханалық жұмысымыздың соңына жеттік. Естеріңізге сала кетейін, сіз барлық жүйелерді дұрыс өшіруіңіз керек, атап айтқанда, AWS Management Console-дан шығу керек. Сондай-ақ, AWS Academy зертханалық жұмыс парақшасында End Lab батырмасын басып, "DELETE has been initiated... You may close this message box now." хабарламасын күту керек. Осы хабарламаны көргеннен кейін сіз барлық ашық қойындыларды және парақшаларды жаба аласыз және болашақта келесі зертханалық жұмысты бастауда қиындықтар болмайды. 
Осылайша біз бүгінгі сессияның соңына жеттік. Amazon RDS сервисімен толығырақ таныстық. Сіз бұл сервис туралы толығырақ түсінік алдыңыз деп үміттенемін. Назарларыңызға рахмет. Келесі белсенділіктерімізде кездескенше.
