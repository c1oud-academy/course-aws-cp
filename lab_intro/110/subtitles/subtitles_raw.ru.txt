 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередной сессии обзора лабораторной работы. Тема сегодняшней лабораторной работы – это знакомство с сервисом RDS. Итак, давайте начнем. Для начала нам необходимо войти в AWS Academy, открыть курс Cloud Foundations и открыть список модулей. В списке модулей нам необходимо развернуть восьмой модуль и вы там увидите активность Lab – 5 Build Database Server. Как только вы перейдете по ссылке, вы окажетесь на главной странице лабораторной работы. Это вы можете увидеть и убедиться в этом в верхней части страницы. По желанию вы можете стартовать лабораторную песочницу и также рекомендую вам скрыть окно терминала, так как она нам не понадобится и оставить только Readme, в котором мы видим задание лабораторной работы. В сегодняшней лабораторной работе мы поработаем и ближе познакомимся с сервисом Amazon Relational Database Service или чаще вы ее можете встретить как Amazon RDS. Что же такое Amazon RDS? Для чего он нам нужен? Давайте вкратце освежим в памяти. Это сервис, который предоставляет нам Managed Relational Database внутри AWS. Идея в том, что нам нет необходимости заниматься административной частью базы данных. Мы лишь указываем некоторые входные данные и для нас AWS предоставляет готовую базу данных, которая подходит в 99% случаев. Так как это Managed Service, мы оплачиваем только за то, что мы используем. То есть мы подняли базу данных, поработали с ней три дня и отключили. Через месяц придет счет на оплату с учетом того времени, что мы использовали только три дня. RDS поддерживает самые популярные движки баз данных. Это Oracle, Microsoft SQL Server, PostgreSQL, MySQL и MariaDB. Также есть поддержка Amazon Aurora. Об этом сервисе мы отдельно поговорим на наших лекционных занятиях. Цель нашей сегодняшней лабораторной работы это запустить базу данных с высокой доступностью. Далее нам необходимо настроить доступ от нашего веб-сервера к нашей базе данных и далее поработать с готовым приложением и убедиться в том, что связь от веб-сервера к базе данных она настроена корректно. Рекомендуется потратить на лабораторную работу порядка 30 минут. Если же вам требуется больше времени, вы всегда можете запросить больше минут. У вас обновится счетчик и таким образом вы успеете закончить вашу лабораторную работу. На следующем слайде вы видите архитектуру, которая по ходу всех наших лабораторных работ развивалась и сегодня мы добавим в эту архитектуру еще дополнительные IT ресурсы, а именно инстанции RDS. Самым первым нам необходимо добраться до AWS Management консоли. Для этого необходимо нажать на кнопку Start Lab. Иницируется создание необходимых ресурсов для нашей лабораторной работы. Как только все будет готово, вы увидите сообщение Lab Status Ready. После этого вы можете закрывать всплывшее окно и нажать на кнопку AWS. После нажатия на эту кнопку вы попадете в AWS Management консоли и можете начинать работать над заданиями лабораторной работы. Самое первое, нам необходимо создать Security группу для нашего DbInstance. Так как во время создания DbInstance нам уже нужно указать Security группу, по этой причине мы сперва создаем Security группу и другие необходимые ресурсы, а после чего уже создадим RDS DbInstance. Для создания Security группы необходимо в AWS Management консоли начать вводить поиски сервисов VPC и перейти на соответствующий сервис. После этого вы увидите пункт в меню Security Groups. Давайте на него нажмем, откроется страница со всеми Security группами на нашем AWS аккаунте. Нам необходимо создать новую Security группу, нажмем соответствующую кнопку и введем следующие значения, свойства нашей Security группы. Как Security Group Name укажем DbSecurityGroup, как Description укажем Permit Access from Web Security Group, то есть это та Security группа, которая предоставляет доступ из Web Security группы. Как VPC укажем наш Lab VPC создан специально для лабораторной работы. Прокрутим чуть ниже, будут настройки рулов, есть Outbound и Inbound рулы, нам необходимо добавить Inbound рулы, для этого нажмем на кнопку Add Rule и введем соответствующие данные для появившейся записи. Как тип укажем MySQL Aurora 3306, это порт по которому происходит работа с базой данных. И в поле Cedar IP Security Group Prefix List мы должны указать ресурс, в нашем случае это SG, то есть Security группа и как только вы начнете вводить SG отобразится список Security групп, вам необходимо выбрать Web Security групп. Что мы проделали? У нас есть Web Security группа, в которой находятся наши EC2 Инстенсы и как только мы настраиваем Security группу для базы данных, у которой есть разрешение Inbound Rule, то есть входящий трафик по порту 3306 для Web Security группы, это значит любой EC2 Инстенс из Web Security группы может работать с базой данных. Отлично, как только мы создали, нам необходимо запомнить новый созданный ресурс и перейти к следующему заданию. Здесь также нам необходимо сделать некоторые предварительные настройки, а именно создать Subnet группу для нашей базы данных. Subnet группа это некий ресурс в рамках сервиса RDS, который объединяет несколько Subnet. Для этого нам необходимо перейти в AWS Management Console и начать поиск сервиса RDS. Мы перешли в сервис RDS, в левом навигационном меню вы увидите пункт Subnet Groups. Давайте на него нажмем, чтобы посмотреть список существующих Subnet групп. В открывшейся странице, вверху справа предположительно будет кнопка, предназначенная для создания новой Subnet группы. Давайте ее нажмем и на новой странице введем следующие данные. Как имя укажем DB Subnet Group через тире, как description укажем DB Subnet Group и как VPC укажем VPC созданную для нашей лабораторной работы LabVPC. Далее проскролли чуть ниже и мы увидим секцию для настройки Subnet. Нам необходимо добавить Subnets. Для этого вначале мы выбираем availability зоны, в нашем случае нужно выбрать два это US East 1A и US East 1B. Как только мы ее выбрали, у нас появится возможность развернуть список Subnets для выбора. Нам необходимо выбрать соответственно CIDR блоки, указанные на 16 шаге. После того как вы выберете, эти Subnets отобразятся в выбранных списке выбранных Subnets. Как только мы произвели все эти настройки, необходимо нажать на кнопку Create, после чего создаться соответствующие DB Subnet Group, которые мы будем использовать при создании DB Instance. Мы с вами добрались до основной части лабораторной работы и здесь будем создавать Instance базы данных. Мы будем использовать функционал Multi-IZ, то есть Multiple Availability Zones для того, чтобы сделать наш Instance базы данных более доступным и надежным. Идея в том, что мы деплоим наш Instance на двух Availability зонах. Одна Availability зона будет считаться основной, вторая – второстепенной. Как только происходит какая-то поломка в основной Availability зоне, то Instance во второй Availability зоне меняет свою роль и становится основным. Таким образом, база данных остается доступной и прозрачно для пользователей для приложений происходит переброска базы данных. Как только база данных на основной Availability зоне становится снова доступной, то происходит обратное переключение. Для того, чтобы это все проделать, нам необходимо открыть сервис Amazon RDS VWS Management консоли, в левом навигационном меню выбрать Databases и в открывшейся странице нажать Create Database. Если вам будет предложено перейти на новый вид страницы создания Instance с текстом Switch to the new database creation flow, вам нужно выбрать этот вариант. Если мы прокрутим чуть ниже, самым первым нам предлагается выбрать движок База Данных. Давайте выберем мою skill. Следующая секция – это секция Settings. Нам необходимо заполнить 4 поля. Первый – это DB Instance Identifier. Давайте напишем Lab-DB, как master username напишем main и для пароля и подтверждения пароля напишем Lab-Password. Следующая секция DB Instance Class. Нам необходимо выбрать тип нашего инстанца. Давайте выберем группу Burstable Classes, то есть это T-классы и как конкретный тип выберем DB-T3-MICRO. Это один из самых маленьких типов инстанцев, который достаточно для цели лабораторной работы. Если вам нужно более подробно посмотреть, какие семейства инстанцев бывают, то вы можете об этом узнать на нашем лекционном занятии, а также посмотреть в официальной AWS документации. Следующая секция – это Storage. Нам необходимо выбрать тип жёсткого диска памяти. В нашем случае это SSD и как выделенная память выбираем 20, то есть 20 гигабайтов будет выделено для данных в нашей базе данных. Следующая секция – это Connectivity. Здесь нам необходимо выбрать VPC, а именно Lab VPC. Двигаемся дальше. Нам необходимо теперь выбрать Security группы. Здесь при нажатии на поле появится выпадающее меню список и необходимо выбрать DB Security Group. И дефолтовую Security группу нужно, она будет выбрана, вам нужно её исключить. В следующей настройке это Additional Configuration. Нам необходимо эту секцию развернуть и ввести несколько изменений. Initial Database Name, необходимо написать Lab и для следующих трёх полей Enable Automatic Backups, Enable Encryption и Enable Enhanced Monitoring нужно будет убрать галочку. Идея того, что мы убираем такие важные, важный функционал как создание бэкапов, шифрование и мониторинг, это в том, что эти изменения позволят нам создать базу данных намного быстрее. Это нормально в рамках нашей лабораторной работы. В будущем, когда вы будете создавать базу данных в Production среде, скорее всего вы будете включать все три эти опции. Поэтому, необходимо в этот момент для меня обязательно отметить. Как только мы ввели все эти значения, прокрутим самый низ и нажмём на кнопку Create Database. Вас направят на страницу со списком баз данных. Давайте выберем LabDB из списка, чтобы провалиться на страницу нашего инстенса баз данных. Создание баз данных занимает достаточно длительное время. Мы уже максимально, как могли, исключили функционал, который долго создает инстанс баз данных. Но тем не менее, нам придется в течение 4-5 минут подождать, пока база данных станет доступной. Вы увидите, что статус баз данных из состояния Modifying перейдет через некоторое время в состояние Available. В этот момент база доступна и готова к работе. Нам необходимо прокрутить чуть ниже и в секции Connectivity и Security скопировать значение поля Endpoint. Оно будет выглядеть примерно следующим образом, как указано на 30-ом шаге. Необходимо этот Endpoint скопировать куда-нибудь локально, так как оно нам пригодится в следующей части нашей лабораторной работы. Мы с вами добрались до самой последней части нашей лабораторной работы и здесь мы попробуем поодвоемодействовать с нашей базой данных. Для нас в рамках лабораторной работы было создано специальное простое приложение, которое позволяет работать с базами данных. Для того, чтобы добраться до этого веб-приложения, нам необходимо найти EC2InstanceWebServer и скопировать его публичный IPv4-адрес. Как только мы ее скопировали, давайте перейдем по этому адресу, чтобы это приложение открыть. Как только откроется это приложение, вам будет предложено ввести IP-адрес веб-сервера. Давайте вставим тоже значения, которые мы ранее скопировали и нажмем на кнопку Enter. Как только вы ее нажмете, приложение отобразит некоторую информацию о нашем EC2Instance. Если вы видите некоторую информацию о EC2Instance, это говорит о том, что приложение корректно работает и мы можем двигаться к следующей части. В следующей части необходимо в верхней части приложения нажать на ссылку RDS. Как только откроется новая страница, вам будет предложено ввести данные по вашей базе данных, а именно это endpoint, это скопированный URL-адрес нахождения вашего instance баз данных. Необходимо ставить это значение. Далее как database введем lab, как username введем main, как password введем lab-password, это тот пароль, который мы вводили ранее, и после чего нажмем на Submit. Как только мы это сделаем, приложение получит информацию о базе данных и откроется следующая страница, адрес book, то есть адресная книга. Здесь вы можете взаимодействовать с базой данных, создавая информацию о адресах. Я бы хотел здесь отметить, что в обычных приложениях практика передачи информации о базе данных через UI-интерфейс, но не совсем является верным, здесь это было упрощено и добавлено больше интерактива. В реальной же жизни мы передаем информацию о нашей базе данных через переменные среды для наших EC2-инстанцев, где они могут эти данные из кода приложения извлечь и уже работать с этой базой данных напрямую. Как только откроется следующая страница со списком адресов, первоначально этот список будет пустым, но вы можете, нажимая на кнопки и взаимодействуя с этим простым приложением, создать необходимое количество адресов, удалять, изменять и так далее. Таким образом мы видим, что приложение работает с базой данных, база данных сохраняет эти данные и связка EC2 и RDS она корректно работает. На этом мы подошли к концу нашей лабораторной работы. Я напоминаю, что необходимо корректно завершить все системы, а именно разлагиниться с AWS Management Console. Также на странице с лабораторной работы в AWS Academy необходимо нажать на кнопку End Lab и дождаться сообщения Delete has been initiated. You may close this message box now. После того, как вы увидите это сообщение, вы можете закрывать все открытые вкладки и страницы и у вас в будущем не возникнет проблем при старте следующей лабораторной работы. На этом мы подошли к концу нашей сегодняшней сессии. Более подробно познакомились с сервисом Amazon RDS. Я очень надеюсь, что вы получили более полное представление об этом сервисе. Спасибо вам за внимание. Увидимся с вами на следующих наших активностях.
