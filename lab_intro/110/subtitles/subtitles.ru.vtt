WEBVTT

00:00:00.000 --> 00:00:07.800
Добрый день, уважаемые студенты! Я рад
вас всех видеть на очередной сессии обзора

00:00:07.800 --> 00:00:12.920
лабораторной работы. Тема сегодняшней
лабораторной работы – это знакомство

00:00:12.920 --> 00:00:15.880
с сервисом Amazon RDS.
Итак, давайте начнем.

00:00:15.880 --> 00:00:24.400
Для начала нам необходимо
войти в AWS Academy, открыть

00:00:24.400 --> 00:00:28.240
курс Cloud Foundations и
открыть список модулей.

00:00:28.240 --> 00:00:32.640
В списке модулей нам
необходимо развернуть Module 8

00:00:32.640 --> 00:00:38.960
и вы там увидите активность
Lab 5 - Build a Database Server.

00:00:38.960 --> 00:00:41.240
Как только вы перейдете
по ссылке, вы окажетесь

00:00:41.240 --> 00:00:43.680
на главной странице
лабораторной работы.

00:00:43.680 --> 00:00:50.640
Это вы можете увидеть и убедиться
в этом в верхней части страницы.

00:00:50.640 --> 00:00:56.160
По желанию вы можете
стартовать лабораторную песочницу

00:00:56.160 --> 00:00:59.500
и также рекомендую вам скрыть
окно Terminal, так как оно

00:00:59.500 --> 00:01:02.880
нам не понадобится и
оставить только README,

00:01:02.880 --> 00:01:07.400
в котором мы видим
задание лабораторной работы.

00:01:07.400 --> 00:01:14.120
В сегодняшней лабораторной
работе мы поработаем и ближе

00:01:14.120 --> 00:01:18.280
познакомимся с сервисом Amazon
Relational Database Service или

00:01:18.280 --> 00:01:22.400
чаще вы его можете
встретить как Amazon RDS.

00:01:22.400 --> 00:01:26.720
Что же такое Amazon RDS?
Для чего он нам нужен?

00:01:26.720 --> 00:01:28.960
Давайте вкратце
освежим в памяти.

00:01:28.960 --> 00:01:37.000
Это сервис, который предоставляет нам
Managed Relational Database внутри AWS.

00:01:37.000 --> 00:01:43.760
Идея в том, что нам нет необходимости
заниматься административной частью базы данных.

00:01:43.760 --> 00:01:47.640
Мы лишь указываем некоторые
входные данные и для нас

00:01:47.640 --> 00:01:56.740
AWS предоставляет готовую базу данных,
которая подходит в 99% случаев.

00:01:56.740 --> 00:01:59.280
Так как это Managed Service,
мы оплачиваем только за то,

00:01:59.280 --> 00:02:03.760
что мы используем, т.е. мы подняли
базу данных, поработали с ней

00:02:03.760 --> 00:02:08.300
три дня и отключили. Через месяц
придет счет на оплату с учетом того

00:02:08.300 --> 00:02:10.600
времени, что мы использовали
только три дня. Amazon RDS

00:02:10.600 --> 00:02:15.440
поддерживает самые популярные
движки баз данных.

00:02:15.440 --> 00:02:24.160
Это Oracle, Microsoft SQL Server,
PostgreSQL, MySQL и MariaDB.

00:02:24.160 --> 00:02:26.640
Также есть поддержка
Amazon Aurora.

00:02:26.640 --> 00:02:31.480
Об этом сервисе мы отдельно
поговорим на наших лекционных занятиях.

00:02:31.480 --> 00:02:39.120
Цель нашей сегодняшней
лабораторной работы — это

00:02:39.120 --> 00:02:44.320
запустить базу данных
с высокой доступностью.

00:02:44.320 --> 00:02:50.400
Далее нам необходимо настроить
доступ от нашего веб-сервера

00:02:50.400 --> 00:02:56.840
к нашей базе данных и далее
поработать с готовым приложением

00:02:56.840 --> 00:03:02.320
и убедиться в том, что связь от веб-сервера
к базе данных настроена корректно.

00:03:02.320 --> 00:03:09.620
Рекомендуется потратить на
лабораторную работу порядка 30 минут.

00:03:09.620 --> 00:03:14.240
Если же вам требуется больше
времени, вы всегда можете

00:03:14.240 --> 00:03:21.640
запросить больше минут. У вас обновится
счетчик и таким образом вы успеете

00:03:21.640 --> 00:03:35.120
закончить вашу лабораторную работу. На
следующем слайде вы видите архитектуру, которая

00:03:35.120 --> 00:03:40.000
по ходу всех наших лабораторных
работ развивалась и сегодня

00:03:40.000 --> 00:03:50.840
мы добавим в эту архитектуру еще дополнительные 
IT ресурсы, а именно инстансы Amazon RDS.

00:03:50.840 --> 00:03:55.840
Самым первым нам необходимо добраться
до AWS Management Console.

00:03:55.840 --> 00:04:01.400
Для этого необходимо
нажать на кнопку Start Lab.

00:04:01.400 --> 00:04:06.280
Иницируется создание необходимых
ресурсов для нашей лабораторной работы.

00:04:06.280 --> 00:04:11.000
Как только все будет готово, вы
увидите сообщение "Lab Status: ready".

00:04:11.000 --> 00:04:17.520
После этого вы можете закрывать
всплывшее окно и нажать на кнопку AWS.

00:04:17.520 --> 00:04:21.600
После нажатия на эту кнопку вы
попадете в AWS Management Console

00:04:21.600 --> 00:04:26.880
и можете начинать работать над
заданиями лабораторной работы.

00:04:26.880 --> 00:04:30.840
Самое первое, нам необходимо
создать Security Group для

00:04:30.840 --> 00:04:37.520
нашего DBInstance. Так как во время создания
DB Instance нам уже нужно указать

00:04:37.520 --> 00:04:42.480
Security Group, по этой причине
мы сперва создаем Security Group

00:04:42.480 --> 00:04:46.120
и другие необходимые
ресурсы, а после чего уже

00:04:46.120 --> 00:04:55.760
создадим RDS DB Instance. Для создания Security
group необходимо в AWS Management Console

00:04:55.760 --> 00:05:03.680
начать вводить в поиске сервисов VPC
и перейти на соответствующий сервис.

00:05:03.680 --> 00:05:08.400
В левом навигационном меню вы
увидите пункт меню Security Groups.

00:05:08.400 --> 00:05:15.160
Давайте на него нажмем, откроется страница со
всеми Security Groups на нашем AWS аккаунте.

00:05:15.160 --> 00:05:20.890
Нам необходимо создать новую Security
Group, нажмем соответствующую кнопку и введем

00:05:20.914 --> 00:05:26.643
следующие значения, свойства нашей Security Group.
Как Security group name укажем

00:05:26.667 --> 00:05:32.362
DB Security Group, как Description укажем
Permit access from Web Security Group,

00:05:32.386 --> 00:05:38.080
т.е. это та Security Group, которая
предоставляет доступ из Web Security группы.

00:05:38.080 --> 00:05:48.580
Как VPC укажем наш Lab VPC созданный
специально для лабораторной работы.

00:05:48.580 --> 00:05:57.076
Прокрутим чуть ниже, будут настройки rules, есть
Outbound и Inbound rules, нам необходимо добавить

00:05:57.100 --> 00:06:06.560
Inbound rules, для этого нажмем на кнопку Add rule и
введем соответствующие данные для появившейся записи.

00:06:06.560 --> 00:06:13.880
Как Type укажем MySQL/Aurora (3306), это порт,
по которому происходит работа с базой данных.

00:06:13.880 --> 00:06:22.360
И в поле CIDR, IP, Security Group
or Prefix List мы должны указать ресурс,

00:06:22.360 --> 00:06:28.000
в нашем случае это sg, т.е.
Security Group и как только

00:06:28.000 --> 00:06:32.400
вы начнете вводить sg
отобразится список Security group,

00:06:32.400 --> 00:06:36.720
вам необходимо выбрать
Web Security Group.

00:06:36.720 --> 00:06:43.680
Что мы проделали? У нас есть Web
Security Group, в которой находятся наши

00:06:43.680 --> 00:06:48.000
Amazon EC2 инстансы, и как только
мы настраиваем Security group

00:06:48.000 --> 00:06:52.440
для базы данных, у которой есть
разрешение Inbound Rule, т.е.

00:06:52.440 --> 00:06:57.780
входящий трафик по порту 3306
для Web Security group, это значит

00:06:57.780 --> 00:07:03.640
любой Amazon EC2 инстанс из Web Security
Group может работать с базой данных.

00:07:03.640 --> 00:07:10.560
Отлично, как только мы создали,
нам необходимо запомнить

00:07:10.560 --> 00:07:14.640
новый созданный ресурс и
перейти к следующему заданию.

00:07:14.640 --> 00:07:17.960
Здесь также нам необходимо
сделать некоторые предварительные

00:07:17.960 --> 00:07:23.040
настройки, а именно создать Subnet
Group для нашей базы данных.

00:07:23.040 --> 00:07:32.480
Subnet Group – это некий ресурс в рамках сервиса
Amazon RDS, который объединяет несколько Subnet.

00:07:32.480 --> 00:07:42.440
Для этого нам необходимо перейти в AWS Management 
Console и начать поиск сервиса Amazon RDS.

00:07:42.440 --> 00:07:46.480
Мы перешли в сервис Amazon RDS,
в левом навигационном меню

00:07:46.480 --> 00:07:51.760
вы увидите пункт Subnet Groups. Давайте
на него нажмем, чтобы посмотреть список

00:07:51.760 --> 00:08:01.440
существующих Subnet group. В открывшейся
странице, вверху справа предположительно,

00:08:01.440 --> 00:08:06.960
будет кнопка, предназначенная
для создания новой Subnet Group.

00:08:06.960 --> 00:08:11.500
Давайте ее нажмем и на новой
странице введем следующие данные.

00:08:11.500 --> 00:08:15.820
Как Name укажем DB-Subnet-Group
через тире, как Description укажем

00:08:15.820 --> 00:08:20.200
DB Subnet Group и как VPC укажем
VPC, созданную для нашей

00:08:20.200 --> 00:08:27.920
лабораторной работы – Lab VPC. Далее
проскроллим чуть ниже и мы увидим секцию

00:08:27.920 --> 00:08:33.040
для настройки Subnet-ов. Нам
необходимо добавить Subnets.

00:08:33.040 --> 00:08:37.240
Для этого вначале мы выбираем
availability zone, в нашем случае

00:08:37.240 --> 00:08:43.360
нужно выбрать два, это
us-east-1a и us-east-1b.

00:08:43.360 --> 00:08:49.960
Как только мы ее выбрали, у нас появится
возможность развернуть список Subnets для выбора.

00:08:49.960 --> 00:08:59.240
Нам необходимо выбрать соответственно
CIDR блоки, указанные на 16 шаге.

00:08:59.240 --> 00:09:14.800
После того как вы выберете, эти Subnets
отобразятся в списке выбранных Subnets.

00:09:14.800 --> 00:09:22.231
Как только мы произвели все эти настройки,
необходимо нажать на кнопку Create, после чего

00:09:22.255 --> 00:09:30.700
создаться соответствующие DB Subnet Group, которые
мы будем использовать при создании DB Instance.

00:09:30.700 --> 00:09:37.640
Мы с вами добрались до основной части лабораторной
работы и здесь будем создавать Instance базы данных.

00:09:37.640 --> 00:09:42.040
Мы будем использовать функционал Multi-AZ,
т.е. Multiple Availability Zones

00:09:42.040 --> 00:09:46.120
для того, чтобы сделать наш
Instance базы данных более

00:09:46.120 --> 00:09:53.680
доступным и надежным. Идея в том, что мы
деплоим наш Instance на двух Availability zone.

00:09:53.680 --> 00:10:00.080
Одна Availability zone будет считаться
основной, вторая – второстепенной.

00:10:00.080 --> 00:10:06.860
Как только происходит какая-то
поломка в основной Availability zone, то

00:10:06.884 --> 00:10:14.440
Instance во второй Availability zone
меняет свою роль и становится основным.

00:10:14.440 --> 00:10:21.320
Таким образом, база данных
остается доступной и прозрачно

00:10:21.320 --> 00:10:28.880
для пользователей приложений
происходит переброска базы данных.

00:10:28.880 --> 00:10:32.160
Как только база данных на
основной Availability zone

00:10:32.160 --> 00:10:35.680
становится снова доступной, то
происходит обратное переключение.

00:10:35.680 --> 00:10:39.800
Для того, чтобы это все проделать,
нам необходимо открыть сервис

00:10:39.800 --> 00:10:45.480
Amazon RDS в AWS Management Console,
в левом навигационном меню

00:10:45.480 --> 00:10:51.160
выбрать Databases и в открывшейся
странице нажать Create Database.

00:10:51.160 --> 00:10:56.135
Если вам будет предложено
перейти на новый вид страницы

00:10:56.159 --> 00:11:02.058
создания инстанса с текстом
Switch to the new database creation

00:11:02.082 --> 00:11:07.653
flow, вам нужно выбрать этот вариант.
Если мы прокрутим чуть

00:11:07.677 --> 00:11:13.720
ниже, самым первым нам предлагается
выбрать движок базы данных.

00:11:13.720 --> 00:11:22.720
Давайте выберем MySQL.
Следующая секция – это секция Settings.

00:11:22.720 --> 00:11:28.000
Нам необходимо заполнить 4 поля.
Первый – это DB Instance Identifier.

00:11:28.000 --> 00:11:35.280
Давайте напишем lab-db, как Master
username напишем main и для

00:11:35.280 --> 00:11:40.320
пароля и подтверждения пароля
напишем lab-password.

00:11:40.320 --> 00:11:45.120
Следующая секция DB Instance class.
Нам необходимо выбрать тип нашего инстанса.

00:11:45.120 --> 00:11:55.080
Давайте выберем группу Burstable classes, т.е. это
t классы и как конкретный тип выберем db.t3.micro.

00:11:55.080 --> 00:12:02.100
Это один из самых маленьких типов инстансов,
которого достаточно для цели лабораторной работы.

00:12:02.100 --> 00:12:07.200
Если вам нужно более подробно
посмотреть, какие семейства

00:12:07.200 --> 00:12:11.640
инстансов бывают, то вы
можете об этом узнать на

00:12:11.640 --> 00:12:16.240
нашем лекционном занятии, а
также посмотреть в официальной

00:12:16.240 --> 00:12:21.760
AWS документации.
Следующая секция – это Storage.

00:12:21.760 --> 00:12:27.640
Нам необходимо выбрать
тип жёсткого диска памяти.

00:12:27.640 --> 00:12:32.880
В нашем случае это SSD и как
выделенная память выбираем 20,

00:12:32.880 --> 00:12:41.480
т.е. 20 гигабайтов будет выделено
для данных в нашей базе данных.

00:12:41.480 --> 00:12:50.600
Следующая секция – это Connectivity. Здесь нам
необходимо выбрать VPC, а именно Lab VPC.

00:12:50.600 --> 00:12:56.720
Двигаемся дальше. Нам необходимо
теперь выбрать Security Groups.

00:12:56.720 --> 00:13:02.840
Здесь при нажатии на поле
появится выпадающее меню

00:13:02.840 --> 00:13:07.240
список и необходимо
выбрать DB Security Group.

00:13:07.240 --> 00:13:13.600
И будет выбрана дефолтовая Security
Group, нужно будет её исключить.

00:13:13.600 --> 00:13:18.120
Следующее в настройке – это
Additional configuration,

00:13:18.120 --> 00:13:22.800
необходимо эту секцию развернуть
и ввести несколько изменений.

00:13:22.800 --> 00:13:31.445
В Initial database name, необходимо написать
Lab и для следующих трёх полей Enable automatic

00:13:31.469 --> 00:13:39.448
backups, Enable encryption и Enable
Enhanced monitoring нужно будет убрать галочку.

00:13:39.472 --> 00:13:47.451
Идея того, что мы убираем такие важные
функционалы как создание бэкапов, шифрование и

00:13:47.475 --> 00:13:56.120
мониторинг, это в том, что эти изменения
позволят нам создать базу данных намного быстрее.

00:13:56.120 --> 00:14:02.304
Это нормально в рамках нашей лабораторной работы.
В будущем, когда вы будете создавать

00:14:02.328 --> 00:14:08.440
базу данных в Production среде, скорее
всего вы будете включать все эти три опции.

00:14:08.440 --> 00:14:20.070
Поэтому этот момент необходимо отметить.
Как только мы ввели все эти значения, прокрутим в

00:14:20.094 --> 00:14:32.640
самый низ и нажмём на кнопку Create Database.
Вас направят на страницу со списком базы данных.

00:14:32.640 --> 00:14:38.012
Давайте выберем lab-db из списка,
чтобы провалиться на страницу

00:14:38.036 --> 00:14:43.148
нашего инстанса базы данных.
Создание базы данных занимает

00:14:43.172 --> 00:14:48.115
достаточно длительное время.
Мы уже максимально, как могли,

00:14:48.139 --> 00:14:53.680
исключили функционал, который
долго создает инстанс базы данных.

00:14:53.680 --> 00:15:06.520
Но тем не менее, нам придется в течение 4-5
минут подождать, пока база данных станет доступной.

00:15:06.520 --> 00:15:11.477
Вы увидите, что статус базы
данных из состояния Modifying

00:15:11.501 --> 00:15:16.280
перейдет через некоторое
время в состояние Available.

00:15:16.280 --> 00:15:20.120
В этот момент база
доступна и готова к работе.

00:15:20.120 --> 00:15:24.360
Нам необходимо прокрутить
чуть ниже и в секции

00:15:24.360 --> 00:15:29.040
Connectivity & security скопировать
значение поля Endpoint.

00:15:29.040 --> 00:15:34.480
Оно будет выглядеть примерно следующим
образом, как указано на 30 шаге.

00:15:34.480 --> 00:15:41.560
Необходимо этот Endpoint скопировать
куда-нибудь локально, так как

00:15:41.560 --> 00:15:49.240
оно нам пригодится в следующей
части нашей лабораторной работы.

00:15:49.240 --> 00:15:51.640
Мы с вами добрались до
самой последней части нашей

00:15:51.640 --> 00:15:55.920
лабораторной работы и здесь мы
попробуем повзаимодействовать

00:15:55.920 --> 00:16:03.400
с нашей базой данных. Для нас в рамках
лабораторной работы было создано специальное

00:16:03.400 --> 00:16:07.520
простое приложение, которое
позволяет работать с базами данных.

00:16:07.520 --> 00:16:12.781
Для того, чтобы добраться до этого
веб-приложения, нам необходимо

00:16:12.805 --> 00:16:18.560
найти EC2 Instance Web Server и
скопировать его публичный IPv4-адрес.

00:16:18.560 --> 00:16:24.920
Как только мы его скопировали, давайте перейдем
по этому адресу, чтобы это приложение открыть.

00:16:24.920 --> 00:16:30.460
Как только откроется это приложение,
вам будет предложено ввести

00:16:30.484 --> 00:16:36.728
IP-адрес веб-сервера. Давайте вставим 
те же значения, которые мы ранее

00:16:36.752 --> 00:16:42.244
скопировали и нажмем на кнопку Enter.
Как только вы ее нажмете,

00:16:42.268 --> 00:16:48.560
приложение отобразит некоторую
информацию о нашем Amazon EC2 Instance.

00:16:48.560 --> 00:16:52.680
Если вы видите некоторую информацию
об Amazon EC2 инстансе, это говорит

00:16:52.680 --> 00:16:59.760
о том, что приложение корректно работает и
мы можем двигаться к следующей части.

00:16:59.760 --> 00:17:06.005
В следующей части необходимо в
верхней части приложения нажать на

00:17:06.029 --> 00:17:12.862
ссылку RDS. Как только откроется
новая страница, вам будет предложено

00:17:12.886 --> 00:17:19.131
ввести данные по вашей базе
данных, а именно это Endpoint, это

00:17:19.155 --> 00:17:25.400
скопированный URL-адрес нахождения
вашего инстанса базы данных.

00:17:25.400 --> 00:17:31.440
Необходимо вставить это значение. Далее, как
Database введем lab, как Username введем main, как

00:17:31.440 --> 00:17:39.040
Password введем lab-password, это тот пароль, который
мы вводили ранее, и после чего нажмем на Submit.

00:17:39.040 --> 00:17:45.388
Как только мы это сделаем, приложение
получит информацию о базе данных

00:17:45.412 --> 00:17:51.760
и откроется следующая страница – Address 
Book, т.е. адресная книга.

00:17:51.760 --> 00:18:00.516
Здесь вы можете взаимодействовать с
базой данных, создавая информацию об

00:18:00.540 --> 00:18:09.297
адресах. Я бы хотел здесь отметить,
что в обычных приложениях практика

00:18:09.321 --> 00:18:18.147
передачи информации о базе данных
через UI-интерфейс не совсем является

00:18:18.171 --> 00:18:26.240
верным, здесь это было упрощено
и добавлено больше интерактива.

00:18:26.240 --> 00:18:32.120
В реальной же жизни мы передаем
информацию о нашей базе

00:18:32.120 --> 00:18:38.160
данных через переменные среды
для наших Amazon EC2 инстансов,

00:18:38.160 --> 00:18:44.900
где они могут эти данные
извлечь из кода приложения

00:18:44.900 --> 00:18:50.240
и уже напрямую работать
с этой базой данных.

00:18:50.240 --> 00:18:54.712
Как только откроется следующая
страница со списком адресов,

00:18:54.736 --> 00:18:59.208
первоначально этот список будет
пустым, но вы можете, нажимая

00:18:59.232 --> 00:19:03.817
на кнопки и взаимодействуя с
этим простым приложением, создать

00:19:03.841 --> 00:19:08.200
необходимое количество
адресов, удалять, изменять и т. д.

00:19:08.200 --> 00:19:18.443
Таким образом, мы видим, что
приложение работает с базой данных, база

00:19:18.467 --> 00:19:28.560
данных сохраняет эти данные и
связка EC2 и RDS корректно работает.

00:19:28.560 --> 00:19:32.960
На этом мы подошли к концу
нашей лабораторной работы.

00:19:32.960 --> 00:19:38.680
Я напоминаю, что необходимо
корректно завершить все

00:19:38.680 --> 00:19:44.080
системы, а именно разлогиниться
с AWS Management Console.

00:19:44.080 --> 00:19:51.308
Также на странице с лабораторной работы в
AWS Academy необходимо нажать на кнопку End Lab

00:19:51.332 --> 00:19:58.560
и дождаться сообщения "DELETE has been 
initiated... You may close this message box now."

00:19:58.560 --> 00:20:05.821
После того, как вы увидите это сообщение,
вы можете закрывать все открытые вкладки и

00:20:05.845 --> 00:20:13.720
страницы и у вас в будущем не возникнет
проблем при старте следующей лабораторной работы.

00:20:13.720 --> 00:20:17.040
На этом мы подошли к концу
нашей сегодняшней сессии.

00:20:17.040 --> 00:20:21.880
Более подробно познакомились
с сервисом Amazon RDS.

00:20:21.880 --> 00:20:30.320
Я очень надеюсь, что вы получили
более полное представление об этом сервисе.

00:20:30.640 --> 00:20:35.240
Спасибо вам за внимание. Увидимся с вами
на следующих наших активностях.